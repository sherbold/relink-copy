226835	normal	FIXED	Andreas Buchen	andreas.buchen	1208052780000	1224812700000		Support Multiple Heap Dump Formats	The Memory Analyzer can support multiple heap dump formats such as HPROF or DTFJ. Currently, however, only HPROF is supported. This Buzilla entry is used to track changes necessary in the core API to allow alternative formats. With CL 15039 this is addressed:  * Allow multiple filters in the &quot;Open Heap Dump&quot; dialog * Add alternative heap dumps to the Welcome page and history * Additional throws clauses added to IIndexBuilder and IObjectReader   Open: * Currently, the API assumes to get the content of primitive arrays as byte[]. However, the conversion from the raw bytes into the the correct primitive arrays (long[], char[], etc.) should be done by the heap dump adapter. Created <span class=""><a href="attachment.cgi?id=96433" name="attach_96433" title="Sample Adpater">attachment 96433</a> <a href="attachment.cgi?id=96433&amp;action=edit" title="Sample Adpater">[details]</a></span> Sample Adpater  This is a sample DTFJ adapter. It is not usable for analysis purposes as only arbitrarily selected data is displayed. IBM has published their DTFJ adapter on alphaworks (<a href="http://www.ibm.com/developerworks/java/jdk/tools/mat.html">http://www.ibm.com/developerworks/java/jdk/tools/mat.html</a>) This is enough proof that the API works.	
227493	major	FIXED	Andreas Buchen	markus.kohler	1208377020000	1208465280000		Closing a heap dump view does not close all index files	Hi all, When I close the view for a heap dump it seems not all index files are closed.  When I try to delete the hprof index files I got the following messages :  C:\workspace\observer1\java_pid2280_1.temp.a2s.index The process cannot access the file because it is being used by another process. C:\workspace\observer1\java_pid2280_1.temp.outbound.index The process cannot access the file because it is being used by another process.  Regards, Markus Created <span class=""><a href="attachment.cgi?id=96448" name="attach_96448" title="patch closing all index readers">attachment 96448</a> <a href="attachment.cgi?id=96448&amp;action=edit" title="patch closing all index readers">[details]</a></span> patch closing all index readers  Markus,  it looks like the problem occurs only if you just parsed the heap dump, right? (For this, I have attached a patch if you want to test)  If the heap dump is already parsed in a previous MAT run, then opened and closed in a new session, index files can be deleted without problems. Does this work for you?  Andreas. (In reply to <a href="show_bug.cgi?id=227493#c1">comment #1</a>) <span class="quote">&gt; Created an attachment (id=96448) [details] &gt; patch closing all index readers &gt;  &gt; Markus, &gt;  &gt; it looks like the problem occurs only if you just parsed the heap dump, right? &gt; (For this, I have attached a patch if you want to test) &gt;  &gt; If the heap dump is already parsed in a previous MAT run, then opened and &gt; closed in a new session, index files can be deleted without problems. Does this &gt; work for you? &gt; </span >  Yes works fine now.   Regards, Markus  <span class="quote">&gt; Andreas. &gt; </span >	
231296	critical	FIXED	Krum Tsvetkov	markus.kohler	1210297080000	1265338020000		Wrong sizes reported for instances with a single byte field	Steps To Reproduce: The size of classes with one byte field is incorrectly reported, when inheritance is used.    More information: Given :  3 Classes A,B,C, A a super class of B and B a super class of C. Each class contains one field of type byte.  The Memory Analyzer reports that this consumes 40 bytes but in reality it does only consume 24 bytes on a 32 bit Windows SUN JVM (JDK 1.6).  This can be verified for example with Yourkit doing a heap dump with the profiling API.     Regards, Markus Hi Markus,  I'll have to dig into this one. As of JDK 1.5, the VM does align any class to 8 bytes. This also occurs during inheritance. The behavior you describe is actually implemented on purpose. I will check if this changed with JDK 6. Thanks for the report.  Andreas. The HPROF parser calculates the size of an instance by summing the sizes of fields declared in each class with the calculated instance size of superclass calculated recursively and rounds them up to an 8 byte boundary.  The final instance size should be rounded up to an 8 byte boundary, but possibly not at all the intermediate stages as the VM may be able to use padding space in a superclass for some of a subclasses fields. The precise rules are going to be VM specific.  E.g. instead of this:  Class A - size 16  0: Header1  4: Header2  8: Field1 12: Pad1  Class B extends A - size 24  0: Header1  4: Header2  8: Field1 12: Pad1 16: Field2 20: Pad2  Class C extends B - size 32  0: Header1  4: Header2  8: Field1 12: Pad1 16: Field2 20: Pad2 24: Field3 28: Pad3  the sizes might be as follows:  Class A - size 16  0: Header1  4: Header2  8: Field1 12: Pad1  Class B extends A - size 16  0: Header1  4: Header2  8: Field1 12: Field2  Class C extends B - size 24  0: Header1  4: Header2  8: Field1 12: Field2 16: Field3 20: Pad2  I did some tests with Sun JDKs 6 Update 16 and the following classes:  public class ClassA {     byte field1 = 1; }  public class ClassB extends ClassA {     byte field2 = 2; }  public class ClassC extends ClassB {     byte field3 = 3; }  I ran a simple program creating one instance of each, and then compared the results from the class histogram (printed from the VM because of the option -XX:+PrintClassHistogram) and results from MAT. I did this for 32 and 64 bit VMs, and also for 64 bit VM with option for compressed oops.  Here the results from the comparison:  JDK 6_16, x32 Class Name| Histogram | MAT           ------------------------------------ ClassC    |        24 |           32  ClassB    |        16 |           24  ClassA    |        16 |           16  ------------------------------------  JDK 6_16, x64 Class Name| Histogram | MAT           ------------------------------------ ClassC    |        40 |           40                 ClassB    |        32 |           32                 ClassA    |        24 |           24                 ------------------------------------  JDK 6_16, x64, -XX:+UseCompressedOops Class Name| Histogram | MAT           ------------------------------------ ClassC    |        24 |           40                 ClassB    |        24 |           32                 ClassA    |        16 |           24                 ------------------------------------  We have to look into more details how to guess the right size. In the past we did the alignment to 8 because the sizes reported in the .hprof dump were (and probably still are) without the alignment. However as this gets very VM (and even parameter) specific we should think of a more reliable way to compute the sizes when inheritance comes into play.  Andrew, can we get some similar comparison from an list of IBM VMs? For an IBM VM:  java version &quot;1.6.0&quot; Java(TM) SE Runtime Environment (build pwi3260sr6-20090925_01(SR6)) IBM J9 VM (build 2.4, JRE 1.6.0 IBM J9 2.4 Windows XP x86-32 jvmwi3260sr6-20090923_42924 (JIT enabled, AOT enabled) J9VM - 20090923_042924 JIT  - r9_20090902_1330ifx1 GC   - 20090817_AA) JCL  - 20090924_01  Used mem calculated at run time by allocating objects and measuring total and free memory.   Class Name| Used mem  | MAT           ------------------------------------ ClassC    |        24 |           24                 ClassB    |        24 |           24                 ClassA    |        16 |           16                 ------------------------------------  The sizes come from DTFJ - so the DTFJ adapter doesn't have to calculate that. The sizes for 32-bit Sun VMs appear to be calculated by rounding superclass sizes to 4 bytes, then adding the fields, then rounding the whole calculation to 8 bytes. The header is 2*4 bytes This works well for a dump I tried.  The sizes for 64-bit Sun VMs appear to rely on rounding superclass sizes to 8 bytes, adding fields, then rounding to 8. The header is 2*8 bytes.  The sizes for 64-bit Sun VMs appear to be calculated by rounding superclass sizes to 4 bytes, then adding the fields, then rounding the whole calculation to 8 bytes. The header is 3*4 bytes.  There's not enough data to be sure about the last two.  What should ShapshotInfo.getIdentifierSize return for a 64-bit compressed pointer dump? Perhaps 64-bit would be less confusing when displayed to the user.  The Javadoc says: int org.eclipse.mat.snapshot.SnapshotInfo.getIdentifierSize() Get size of the internal identifiers in the heap dump, i.e. 32 or 64 bit.   Returns: size of the internal identifiers in the heap dump, i.e. 32 or 64 bit  but it seems this size is actually the number of bytes, 4 or 8. I played a little bit today with heap dumps from x64 Sun VM, both with and without compressed oops. I was hoping to be able to determine the difference from the HPROF file, but I failed. The reported ID size is in both cases x64, and the reported sizes in the CLASS_DUMP records are also the same. We ignore these sizes anyway, as they do not include the header size and are not aligned in any way, but I was hoping to see there some difference and use it as an indicator that the pointers are compressed. No success.  Therefore we will continue to show the sizes as for the x64 bit without compression case. At least until we find a way to distinguish between them.  About the x32 size I will try to come up with a fix in the next days. Andrew's observation were very helpful. I'm just double-checking with some colleagues. I made a fix (revision 551), following the suggestion from Andrew - for x32 Sun superclass sizes are aligned to 4 and the end result aligned to 8.  I added some tests (org.eclipse.mat.tests.snapshot.TestInstanceSizes) which compare the sizes reported in a histogram against the ones we produce in MAT.  For a jdk 6 x64 the tests are OK. For a jdk 6 x32 the tests are OK. For a jdk 5 x32 the tests were mostly OK. The example described above (ClassA, ClassB, ClassC) was tested OK, i.e. the sizes were matching the ones from the histogram. There were some exceptions however, where after looking in detail I have no idea where the difference comes from. These are classes directly extending java.lang.Object. And summing the fields I get 8 bytes less. We are guessing that there could be some internal data attached to these (probably special objects), which is not provided in the heap dump. This is the failure list (I removed then these lines from the test histogram, so that our tests are OK):  Class [java.lang.Thread] expected size 96 but got 88 Class [java.util.jar.JarFile$JarFileEntry] expected size 96 but got 88 Class [java.util.zip.Inflater] expected size 40 but got 32 Class [java.lang.ref.Reference$ReferenceHandler] expected size 96 but got 88 Class [java.lang.ref.Finalizer$FinalizerThread] expected size 96 but got 88 Class [java.io.ExpiringCache] expected size 40 but got 32 Class [java.util.Random] expected size 32 but got 24  With these modifications I'd like to close this bug. The summary:  - Sizes from 64 bit VMs are OK.  - Now we have correct sizes for java 6, and as correct as possible sizes for java 5, java 1.4 wasn't tested (I assume there it is now wrong, as initially I have used 1.4 as a sample) - For the special case of a x64 Sund VM with compressed OOPs we have no solution. There is no way to guess from the HPROF file that the pointers were compressed	
234428	normal	FIXED	Erwin Margewitsch	andreas.buchen	1211951160000	1212438840000		Missing versions in bundle dependencies	The bundle dependencies in MAT's manifests do not specify versions. If the Memory Analyzer is installed into an Eclipse 3.2.2 installation (for example from the Ubuntu 8.04 distro), the Update Manager gives no warning. Instead it leads to exceptions like:  java.lang.NoSuchMethodError: org.eclipse.core.runtime.Status.&lt;init&gt;(ILjava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V         at org.eclipse.mat.ui.util.ProgressMonitorWrapper.doSendUserMessage(ProgressMonitorWrapper.java:106)   We did not specify minimum version so far, because we mostly distributed the stand-alone version.  This bug tracks (i) that we specify version dependencies, and (ii) check whether we are (still) compatible with 3.2.2 added specific versions dependencies to MAT's manifests:  MAT requires at least eclipse 3.3 optional: Chart Runtime 2.2	
235029	normal	FIXED	Andreas Buchen	pascal	1212314160000	1212437940000		Detect ability to read dump file based on file content	In order to generate a heap dump I followed the directions from the jmap help, which gives the following example &quot;jmap -dump:format=b,file=heap.bin &lt;pid&gt;&quot;.  From this I got a file with the .bin extension which the MAT failed at opening reporting that &quot;no parser was registered&quot;.  Once I had renamed the extension into .hprof, MAT opened the file without a problem.  To avoid this kind of annoyances, it could be good to detect the applicability of the parser based on the content of the file rather than the extension. The content type mechanism of the platform may be of use here. Pascal, thanks for your input.  I will look into the extension point org.eclipse.core.contenttype.contentTypes. Right now, it looks to me like one has to provide either &quot;file-extensions&quot; or &quot;file-names&quot;. When providing neither, the content type is never picked. Therefore it looks like I have to know other possible extensions like &quot;bin&quot; or &quot;dmp&quot; anyway. Added content types.  &quot;Open File&quot; -&gt; opens heap dump for known extensions hprof, bin, dmp &quot;Open Heap Dump&quot; -&gt; any extension (purely content based) Resource Navigator -&gt; &quot;Open with...&quot; -&gt; any extension (purely content based)	
241158	normal	FIXED	Andreas Buchen	dberindei	1216201560000	1216252440000		The list of results for an OQL	Build ID: I20080617-2000  Steps To Reproduce: I'm using MAT version 0.7.0.200806131506  The OQL query results list displays 2 rows too many after executing a query with a lot of results, so they don't quite fit and I can't see the summary on the last line without scrolling.   More information: I can see the number of results displayed changes based on the size of the results list, so I believe the intention is to make the summary visible from the start. However I think the code doesn't account for the summary and filter lines so the results list ends up with a scrollbar anyway. Looks like the calculation of visible rows does not work on Vista. Need to find a Vista box to fix this. improved line height estimation on Vista with CL 19447  I mark bug as FIXED. Next upload to the download server will contain fix.	
245347	normal	FIXED	Andreas Buchen	andreas.buchen	1219780260000	1220326320000		Error running reports on Linux	(reported via Newsgroup <a href="http://www.eclipse.org/newsportal/article.php?id=51&amp;group=eclipse.technology.memory-analyzer#51">http://www.eclipse.org/newsportal/article.php?id=51&amp;group=eclipse.technology.memory-analyzer#51</a>)   I cant seem to run any of the reporting functionality on Linux.  It worked fine on Windows.   Is there something different I need to do to get it working?   Appreciate the help, thanks.  btw...  product works great.  Running RHES5.  Here's my error stack:  !SESSION 2008-08-26 18:00:37.371 ----------------------------------------------- eclipse.buildId=unknown java.version=1.5.0_11 java.vendor=Sun Microsystems Inc. BootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=en_US Command-line arguments:  -os linux -ws gtk -arch x86_64  !ENTRY org.eclipse.ui.intro 4 0 2008-08-26 18:00:41.292 !MESSAGE Failed to create the content of Intro model content provider: org.eclipse.mat.ui.rcp.actions.SnapshotHistoryIntroContentProvider !STACK 0 java.lang.NullPointerException         at org.eclipse.core.internal.runtime.Activator.getURLConverter(Activator.java:313)         at org.eclipse.core.runtime.FileLocator.toFileURL(FileLocator.java:164)         at org.eclipse.mat.ui.rcp.actions.SnapshotHistoryIntroContentProvider.createImage(SnapshotHistoryIntroContentProvider.java:167)         at org.eclipse.mat.ui.rcp.actions.SnapshotHistoryIntroContentProvider.createContent(SnapshotHistoryIntroContentProvider.java:115)         at org.eclipse.ui.internal.intro.impl.swt.PageWidgetFactory.createContentProvider(PageWidgetFactory.java:392)         at org.eclipse.ui.internal.intro.impl.swt.RootPageForm.createContentProvider(RootPageForm.java:342)         at org.eclipse.ui.internal.intro.impl.swt.RootPageForm.createGroupContent(RootPageForm.java:273)         at org.eclipse.ui.internal.intro.impl.swt.RootPageForm.createRootPageContent(RootPageForm.java:231)         at org.eclipse.ui.internal.intro.impl.swt.RootPageForm.createPartControl(RootPageForm.java:193)         at org.eclipse.ui.internal.intro.impl.presentations.FormIntroPartImplementation.createMainPageBook(FormIntroPartImplementation.java:168)         at org.eclipse.ui.internal.intro.impl.presentations.FormIntroPartImplementation.dynamicCreatePartControl(FormIntroPartImplementation.java:137)         at org.eclipse.ui.internal.intro.impl.presentations.FormIntroPartImplementation.createPartControl(FormIntroPartImplementation.java:99)         at org.eclipse.ui.internal.intro.impl.model.IntroPartPresentation.createPartControl(IntroPartPresentation.java:268)         at org.eclipse.ui.intro.config.CustomizableIntroPart.createPartControl(CustomizableIntroPart.java:194)         at org.eclipse.ui.internal.ViewIntroAdapterPart.createPartControl(ViewIntroAdapterPart.java:98)         at org.eclipse.ui.internal.ViewReference.createPartHelper(ViewReference.java:371)         at org.eclipse.ui.internal.ViewReference.createPart(ViewReference.java:230)         at org.eclipse.ui.internal.WorkbenchPartReference.getPart(WorkbenchPartReference.java:594)         at org.eclipse.ui.internal.Perspective.showView(Perspective.java:2127)         at org.eclipse.ui.internal.WorkbenchPage.busyShowView(WorkbenchPage.java:1062)         at org.eclipse.ui.internal.WorkbenchPage$19.run(WorkbenchPage.java:3773)         at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)         at org.eclipse.ui.internal.WorkbenchPage.showView(WorkbenchPage.java:3770)         at org.eclipse.ui.internal.WorkbenchPage.showView(WorkbenchPage.java:3746)         at org.eclipse.ui.internal.WorkbenchIntroManager.createIntro(WorkbenchIntroManager.java:173)         at org.eclipse.ui.internal.WorkbenchIntroManager.showIntro(WorkbenchIntroManager.java:120)         at org.eclipse.ui.internal.WorkbenchWindow$20.runWithException(WorkbenchWindow.java:2178)         at org.eclipse.ui.internal.StartupThreading$StartupRunnable.run(StartupThreading.java:31)         at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)         at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:133)         at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3378)         at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3036)         at org.eclipse.ui.application.WorkbenchAdvisor.openWindows(WorkbenchAdvisor.java:803)         at org.eclipse.ui.internal.Workbench$27.runWithException(Workbench.java:1361)         at org.eclipse.ui.internal.StartupThreading$StartupRunnable.run(StartupThreading.java:31)         at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:178)         at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:150)         at org.eclipse.swt.widgets.Display.syncExec(Display.java:4021)         at org.eclipse.ui.internal.StartupThreading.runWithoutExceptions(StartupThreading.java:94)         at org.eclipse.ui.internal.Workbench.init(Workbench.java:1356)         at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2312)         at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2198)         at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:493)         at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:288)         at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:488)         at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)         at org.eclipse.mat.ui.rcp.Application.start(Application.java:26)         at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:193)         at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)         at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)         at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:382)         at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)         at java.lang.reflect.Method.invoke(Method.java:585)         at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:549)         at org.eclipse.equinox.launcher.Main.basicRun(Main.java:504)         at org.eclipse.equinox.launcher.Main.run(Main.java:1236)         at org.eclipse.equinox.launcher.Main.main(Main.java:1212)  !ENTRY org.eclipse.ui 4 0 2008-08-26 18:01:17.953 !MESSAGE Unhandled event loop exception !STACK 0 java.lang.NoClassDefFoundError: org/mozilla/javascript/ScriptableObject         at java.lang.ClassLoader.defineClass1(Native Method)         at java.lang.ClassLoader.defineClass(ClassLoader.java:620)         at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.defineClass(DefaultClassLoader.java:165)         at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.defineClass(ClasspathManager.java:554)         at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findClassImpl(ClasspathManager.java:524)         at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClassImpl(ClasspathManager.java:455)         at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass_LockClassLoader(ClasspathManager.java:443)         at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass(ClasspathManager.java:423)         at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass(DefaultClassLoader.java:193)         at org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass(BundleLoader.java:368)         at org.eclipse.osgi.framework.internal.core.BundleLoader.findClassInternal(BundleLoader.java:444)         at org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:397)         at org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:385)         at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:87)         at java.lang.ClassLoader.loadClass(ClassLoader.java:251)         at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)         at org.eclipse.birt.chart.factory.Generator.build(Generator.java:947)         at org.eclipse.mat.ui.internal.chart.ChartCanvas.generateChartState(ChartCanvas.java:110)         at org.eclipse.mat.ui.internal.chart.ChartCanvas.drawToCachedImage(ChartCanvas.java:135)         at org.eclipse.mat.ui.internal.chart.ChartCanvas.access$1(ChartCanvas.java:120)         at org.eclipse.mat.ui.internal.chart.ChartCanvas$1.paintControl(ChartCanvas.java:72)         at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:217)         at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)         at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1158)         at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1182)         at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1167)         at org.eclipse.swt.widgets.Control.gtk_expose_event(Control.java:2703)         at org.eclipse.swt.widgets.Composite.gtk_expose_event(Composite.java:669)         at org.eclipse.swt.widgets.Canvas.gtk_expose_event(Canvas.java:170)         at org.eclipse.swt.widgets.Widget.windowProc(Widget.java:1539)         at org.eclipse.swt.widgets.Control.windowProc(Control.java:4502)         at org.eclipse.swt.widgets.Display.windowProc(Display.java:4099)         at org.eclipse.swt.internal.gtk.OS._gtk_main_do_event(Native Method)         at org.eclipse.swt.internal.gtk.OS.gtk_main_do_event(OS.java:5783)         at org.eclipse.swt.widgets.Display.eventProc(Display.java:1177)         at org.eclipse.swt.internal.gtk.OS._g_main_context_iteration(Native Method)         at org.eclipse.swt.internal.gtk.OS.g_main_context_iteration(OS.java:1541)         at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3031)         at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2382)         at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2346)         at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2198)         at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:493)         at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:288)         at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:488)         at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)         at org.eclipse.mat.ui.rcp.Application.start(Application.java:26)         at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:193)         at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)         at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)         at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:382)         at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)         at java.lang.reflect.Method.invoke(Method.java:585)         at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:549)         at org.eclipse.equinox.launcher.Main.basicRun(Main.java:504)         at org.eclipse.equinox.launcher.Main.run(Main.java:1236)         at org.eclipse.equinox.launcher.Main.main(Main.java:1212)  !ENTRY org.eclipse.ui 4 0 2008-08-26 18:01:20.973 !MESSAGE Unhandled event loop exception !STACK 0 java.lang.NoClassDefFoundError: org/mozilla/javascript/ScriptableObject         at java.lang.ClassLoader.defineClass1(Native Method)         at java.lang.ClassLoader.defineClass(ClassLoader.java:620) Looking at the log, I find 2 problems  (1) NullPointerException -&gt; due to an invalid image path, if the welcome page is rendered as SWT forms.  (2) NoClassDefFoundError: org/mozilla/javascript/ScriptableObject -&gt; from the log file, it is unclear why exactly the error is thrown. The class and the jar file is included, but maybe Linux native code prevents the proper loading of the class. Unfortunately, I was not able to reproduce the problem on my VirtualBox's Ubuntu. Even with Firefox uninstalled, everything works fine.  I submitted improved error handling with CL 120. This should let the report fail more graciously: it will add an error message instead of the pie chart. Please let me know if you would like any additional information.   I can do a strace or set classpath, thread dump, heap etc.. Running MAT on Linux without Mozilla produces the following unhandled loop exception. Need to add additional error handling.  org.eclipse.swt.SWTException: Failed to execute runnable (org.eclipse.swt.SWTError: No more handles [Unknown Mozilla path (MOZILLA_FIVE_HOME not set)]) [...snipp...] Caused by: org.eclipse.swt.SWTError: No more handles [Unknown Mozilla path (MOZILLA_FIVE_HOME not set)]     at org.eclipse.swt.SWT.error(SWT.java:3803)     at org.eclipse.swt.browser.Mozilla.create(Mozilla.java:312)     at org.eclipse.swt.browser.Browser.&lt;init&gt;(Browser.java:118)     at org.eclipse.mat.ui.internal.panes.QueryTextResultPane.createPartControl(QueryTextResultPane.java:68)     at org.eclipse.mat.ui.editor.MultiPaneEditor.addPage(MultiPaneEditor.java:562)     at org.eclipse.mat.ui.editor.MultiPaneEditor.addPage(MultiPaneEditor.java:551)     at org.eclipse.mat.ui.editor.MultiPaneEditor.addNewPage(MultiPaneEditor.java:473)     at org.eclipse.mat.ui.QueryExecution.doDisplayResult(QueryExecution.java:265)     at org.eclipse.mat.ui.QueryExecution.access$0(QueryExecution.java:217)     at org.eclipse.mat.ui.QueryExecution$1.run(QueryExecution.java:138)     at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)     at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:133)     ... 23 more If you have the link to the specific version of Mozilla that you require, I could try installing and see if that works.   When you say Mozilla, does it mean Firefox? Searching the web for this issues, it seems that SWT needs a dynamically linked Firefox browser installed (or at least this is what can be read in most postings). The Firefox should be compiled from sources (which is usually the case if it is part of a distribution) not not downloaded from Mozilla.Org (which is statically linked).  This source sounds plausible: <a href="http://www-01.ibm.com/support/docview.wss?rs=2042&amp;context=SSRTLW&amp;dc=DB520&amp;dc=DB560&amp;uid=swg21271865&amp;loc=en_US&amp;cs=UTF-8&amp;lang=en&amp;rss=ct2042rational">http://www-01.ibm.com/support/docview.wss?rs=2042&amp;context=SSRTLW&amp;dc=DB520&amp;dc=DB560&amp;uid=swg21271865&amp;loc=en_US&amp;cs=UTF-8&amp;lang=en&amp;rss=ct2042rational</a>  I uninstalled Firefox on my Ubuntu 4.08 system (running on Sun's VirtualBox), but the Memory Analyzer kept running without complaining. Let me know what happens if you are able to install Firefox. I installed the Firefox RPM which is part of the Red Hat 5 Distribution.  The &quot;debug&quot; version of Memory analyzer that you sent me now works 100%.     The publicly available version still fails with the error below.   Will you be merging your changes into the latest branch?   Is there any other debugging info you would like from me?  [root&#64;l001tlab01v .metadata]# more .log !SESSION 2008-08-29 09:24:33.966 ----------------------------------------------- eclipse.buildId=unknown java.version=1.5.0_11 java.vendor=Sun Microsystems Inc. BootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=en_US Command-line arguments:  -os linux -ws gtk -arch x86_64  !ENTRY org.eclipse.mat.ui 1 0 2008-08-29 09:24:55.874 !MESSAGE Heap /tmp/hd/demo_heap.bin contains 176,432 objects  !ENTRY org.eclipse.ui 4 0 2008-08-29 09:25:14.503 !MESSAGE Unhandled event loop exception !STACK 0 java.lang.NoClassDefFoundError: org/mozilla/javascript/ScriptableObject         at java.lang.ClassLoader.defineClass1(Native Method)         at java.lang.ClassLoader.defineClass(ClassLoader.java:620)         at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.defineClass(DefaultClassLoader.java:165)         at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.defineClass(ClasspathManager.java:554)         at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findClassImpl(ClasspathManager.java:524)         at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClassImpl(ClasspathManager.java:455)         at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass_LockClassLoader(ClasspathManager.java:443 )         at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass(ClasspathManager.java:423)         at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass(DefaultClassLoader.java:193)         at org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass(BundleLoader.java:368)         at org.eclipse.osgi.framework.internal.core.BundleLoader.findClassInternal(BundleLoader.java:444)         at org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:397)         at org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:385)         at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:87)         at java.lang.ClassLoader.loadClass(ClassLoader.java:251)         at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)         at org.eclipse.birt.chart.factory.Generator.build(Generator.java:947)         at org.eclipse.mat.ui.internal.chart.ChartCanvas.generateChartState(ChartCanvas.java:110)         at org.eclipse.mat.ui.internal.chart.ChartCanvas.drawToCachedImage(ChartCanvas.java:135)         at org.eclipse.mat.ui.internal.chart.ChartCanvas.access$1(ChartCanvas.java:120)         at org.eclipse.mat.ui.internal.chart.ChartCanvas$1.paintControl(ChartCanvas.java:72)         at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:217)         at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)         at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1158)         at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1182)         at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1167)         at org.eclipse.swt.widgets.Control.gtk_expose_event(Control.java:2703)         at org.eclipse.swt.widgets.Composite.gtk_expose_event(Composite.java:669)         at org.eclipse.swt.widgets.Canvas.gtk_expose_event(Canvas.java:170)         at org.eclipse.swt.widgets.Widget.windowProc(Widget.java:1539)         at org.eclipse.swt.widgets.Control.windowProc(Control.java:4502)         at org.eclipse.swt.widgets.Display.windowProc(Display.java:4099)         at org.eclipse.swt.internal.gtk.OS._gtk_main_do_event(Native Method)         at org.eclipse.swt.internal.gtk.OS.gtk_main_do_event(OS.java:5783)         at org.eclipse.swt.widgets.Display.eventProc(Display.java:1177)         at org.eclipse.swt.internal.gtk.OS._g_main_context_iteration(Native Method)         at org.eclipse.swt.internal.gtk.OS.g_main_context_iteration(OS.java:1541)         at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3031)         at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2382)         at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2346)         at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2198)         at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:493)         at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:288)         at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:488)         at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)         at org.eclipse.mat.ui.rcp.Application.start(Application.java:26)         at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:193)         at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)         at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)         at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:382)         at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)         at java.lang.reflect.Method.invoke(Method.java:585)         at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:549)         at org.eclipse.equinox.launcher.Main.basicRun(Main.java:504)         at org.eclipse.equinox.launcher.Main.run(Main.java:1236)         at org.eclipse.equinox.launcher.Main.main(Main.java:1212)  !ENTRY org.eclipse.ui 4 0 2008-08-29 09:25:16.265 !MESSAGE Unhandled event loop exception !STACK 0 java.lang.NoClassDefFoundError: org/mozilla/javascript/ScriptableObject <span class="quote">&gt; The &quot;debug&quot; version of Memory analyzer that you sent me now works 100%.   </span >  That is great news. Thank you very much for your patience in testing this versions.  <span class="quote">&gt; Will you be merging your changes into the latest branch?</span >  I committed the coding to the subversion repository. It will be included the next time we update the download version - probably end of this week. Thanks for the help.	
246853	normal	FIXED	Andreas Buchen	andreas.buchen	1221008340000	1231975380000		Heap Dump Files without extension cause StringIndexOutOfBoundsException	Open a heap dump without extension, and the following error occurs:  java.lang.StringIndexOutOfBoundsException: String index out of range: -1 at java.lang.String.substring(Unknown Source) at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.deleteIndexFiles(SnapshotFactoryImpl.java:234) at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:99) at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:87) at org.eclipse.mat.internal.apps.ParseSnapshotApp.parse(ParseSnapshotApp.java:74) at org.eclipse.mat.internal.apps.ParseSnapshotApp.start(ParseSnapshotApp.java:63) fixed with [165] - MAT did not expect filenames w/o extension and file names with parenthesis Created <span class=""><a href="attachment.cgi?id=122660&amp;action=diff" name="attach_122660" title="Allow for no file extension on the dump file">attachment 122660</a> <a href="attachment.cgi?id=122660&amp;action=edit" title="Allow for no file extension on the dump file">[details]</a></span> Allow for no file extension on the dump file  I think there is still a problem - I can get this exception with a file with no extension.  java.lang.NullPointerException     at org.eclipse.mat.ui.snapshot.views.SnapshotOutlinePage.updateSnapshotInput(SnapshotOutlinePage.java:335)     at org.eclipse.mat.ui.snapshot.views.SnapshotOutlinePage.createControl(SnapshotOutlinePage.java:262)     at org.eclipse.ui.views.contentoutline.ContentOutline.doCreatePage(ContentOutline.java:137)     at org.eclipse.ui.part.PageBookView.createPage(PageBookView.java:399)     at org.eclipse.ui.part.PageBookView.partActivated(PageBookView.java:741)     at org.eclipse.ui.views.contentoutline.ContentOutline.partBroughtToTop(ContentOutline.java:212)     at org.eclipse.ui.internal.PartListenerList$2.run(PartListenerList.java:87)     at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)     at org.eclipse.core.runtime.Platform.run(Platform.java:880)     at org.eclipse.ui.internal.PartListenerList.fireEvent(PartListenerList.java:57)     at org.eclipse.ui.internal.PartListenerList.firePartBroughtToTop(PartListenerList.java:85)     at org.eclipse.ui.internal.PartService.firePartBroughtToTop(PartService.java:207)     at org.eclipse.ui.internal.WorkbenchPagePartList.firePartBroughtToTop(WorkbenchPagePartList.java:75)     at org.eclipse.ui.internal.WorkbenchPagePartList.fireActiveEditorChanged(WorkbenchPagePartList.java:51)     at org.eclipse.ui.internal.PartList.setActiveEditor(PartList.java:152)     at org.eclipse.ui.internal.WorkbenchPage.makeActiveEditor(WorkbenchPage.java:1259)     at org.eclipse.ui.internal.WorkbenchPage.updateActivePart(WorkbenchPage.java:1204)     at org.eclipse.ui.internal.WorkbenchPage.partAdded(WorkbenchPage.java:1665)     at org.eclipse.ui.internal.EditorAreaHelper.addEditor(EditorAreaHelper.java:210)     at org.eclipse.ui.internal.EditorManager.createEditorTab(EditorManager.java:779)     at org.eclipse.ui.internal.EditorManager.openEditorFromDescriptor(EditorManager.java:678)     at org.eclipse.ui.internal.EditorManager.openEditor(EditorManager.java:639)     at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditorBatched(WorkbenchPage.java:2817)     at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor(WorkbenchPage.java:2729)     at org.eclipse.ui.internal.WorkbenchPage.access$11(WorkbenchPage.java:2721)     at org.eclipse.ui.internal.WorkbenchPage$10.run(WorkbenchPage.java:2673)     at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)     at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2668)     at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2652)     at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2643)     at org.eclipse.ui.ide.IDE.openEditor(IDE.java:577)     at org.eclipse.mat.ui.internal.views.SnapshotHistoryView.openFile(SnapshotHistoryView.java:538)     at org.eclipse.mat.ui.internal.views.SnapshotHistoryView.access$1(SnapshotHistoryView.java:527)     at org.eclipse.mat.ui.internal.views.SnapshotHistoryView$1.mouseDoubleClick(SnapshotHistoryView.java:205)     at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:183)     at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)     at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1003)     at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3823)     at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3422)     at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2382)     at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2346)     at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2198)     at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:493)     at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:288)     at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:488)     at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)     at org.eclipse.mat.ui.rcp.Application.start(Application.java:26)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:193)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:382)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)     at java.lang.reflect.Method.invoke(Unknown Source)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:549)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:504)     at org.eclipse.equinox.launcher.Main.run(Main.java:1236)   Also, the index files are created as follows: 09/10/2008  18:33            74,207 stopx 15/01/2009  12:15            11,813 stopxa2s.index 15/01/2009  12:15            10,971 stopxdomIn.index 15/01/2009  12:15            33,739 stopxdomOut.index 15/01/2009  12:15            44,646 stopxidx.index 15/01/2009  12:15            35,460 stopxinbound.index 15/01/2009  12:15           158,241 stopxindex 15/01/2009  12:15            10,971 stopxo2c.index 15/01/2009  12:15            39,595 stopxo2ret.index 15/01/2009  12:15            35,460 stopxoutbound.index 15/01/2009  12:16            73,318 stopx_Leak_Suspects.zip  but then the delete index files option doesn't work as it expects a &quot;.&quot; before all the index types. The solution is to add a &quot;.&quot; to the file name to get the prefix.	
247254	major	FIXED	Andreas Buchen	bart.vanhaute	1221422460000	1221503280000		while opening head dump, MAT deletes files it does not own	When opening a .hprof heap dump, MAT will apparently delete files that it has not created itself. For example, I have a heap dump called 'mytest.hprof', and a  related logging file for this heap dump called 'mytest.log'. When I open the heap dump file, MAT will delete the mytest.log file. This is very unexpected behaviour. During parsing, files named &lt;heapdump&gt;.inbound.index&lt;number&gt;.log are created. If parsing fails, those file could stay around. Therefore they are deleted. But the pattern &lt;heapdump&gt;.*\.log includes too many files.  Will fix ASAP.  I am sorry if you permanently lost the log file. Submitted fix with change list 145.  next update to the download page will include fix.	
249654	normal	FIXED	Andreas Buchen	prabhakara_janardhan	1223028420000	1224819720000		Enhancement Request : Save Value to File for Binary Types	Created <span class=""><a href="attachment.cgi?id=114238" name="attach_114238" title="Mat Version">attachment 114238</a> <a href="attachment.cgi?id=114238&amp;action=edit" title="Mat Version">[details]</a></span> Mat Version  Existing functionality: Existing Functionality: Right Click on object / primitive and save value to file. This works only for character types...  I have serialized objects in my heap dump and they are rather huge (25M). If I could save the byte[] to file, I could potentially de-serialize the object to understand the state. I need to be able to analyze how my serialized objects got that big in the first place and it should be a whole lot easier if I could retrieve the object state.  Thanks, Janardhan Hi Janardhan, I have changed the implementation of the &quot;Save Value To File&quot; context menu. If it is a primitive type (and if you select only one object) then it is written to a binary file which one can read using a java.io.DataInputStream.  The change is submitted with CL 166. If you want to test it right now, either build MAT from the repository or send me a short email and I can email you a patch.	
250741	normal	FIXED	Andreas Buchen	andrew_johnson	1223933880000	1225686120000		Deleting index files fails for dumps with [] in name.	If a dump with [] in the name is parsed then from the Heap Dump History pane the delete index files option is selected then nothing happens. The index files remain.   The problem is the brackets confuse the regular expression parser. Other characters may confuse the parser too. E.g. deleting index files for dump.1.hprof might also delete the indexes for dump21.hprof as the first dot will match any character.  Something like this should fix the problem.  Index: src/org/eclipse/mat/ui/internal/views/SnapshotHistoryView.java =================================================================== --- src/org/eclipse/mat/ui/internal/views/SnapshotHistoryView.java    (revision 150) +++ src/org/eclipse/mat/ui/internal/views/SnapshotHistoryView.java    (working copy) &#64;&#64; -558,13 +558,15 &#64;&#64;          File directory = snapshot.getParentFile();          String name = snapshot.getName();  -        final Pattern pattern = Pattern.compile(name.substring(0, name.lastIndexOf('.')) + &quot;\\.(.*\\.)?index&quot;); +        int lastDot = name.lastIndexOf('.'); +        final String prefix = lastDot &gt;= 0 ? name.substring(0, lastDot) : name; +        final Pattern pattern = Pattern.compile(&quot;\\.(.*\\.)?index&quot;);           String[] indexFiles = directory.list(new FilenameFilter()          {              public boolean accept(File dir, String name)              { -                return pattern.matcher(name).matches(); +                return name.startsWith(prefix) &amp;&amp; pattern.matcher(name.substring(prefix.length())).matches();              }          }); I'll look into it. Seems reasonable. fixed with cl [165] updated for ip log flag	
252562	normal	FIXED	Andreas Buchen	andreas.buchen	1225231500000	1250463480000		OQL removes keyword OBJECTS removed from query	When executing the following query in the OQL window, the second &quot;OBJECTS&quot; keywords is removed when printing the query to the navigation history and the input field.   SELECT classof(out).getName(), classof(out) FROM OBJECTS ( SELECT OBJECTS ${snapshot}.getOutboundReferentIds(thread.getObjectId()) FROM org.apache.tomcat.util.threads.ThreadWithAttributes thread  ) out WHERE (classof(out).getName()=&quot;java.security.AccessControlContext&quot;)  The problem occurs only if the query is nested into an out select statement. Strange. This can be fixed by modifying Query.java to output the &quot;OBJECTS &quot; keyword if selectClause.asObjects is true.  I've made the change.	
253178	minor	FIXED	Andreas Buchen	andrew_johnson	1225670460000	1227222480000		Schema definitions have errors	Several of the exsd files have   &lt;appinfo&gt; elements rather than &lt;appInfo&gt;  This causes an error when I attempt to view the files in Eclipse 3.3 and some such as org.eclipse.mat.api schema/factory.exsd  don't display the &lt;factory&gt; &lt;impl&gt; implements information if this &lt;appInfo&gt; element is not fixed.  Should all the exsd files have &lt;appInfo&gt; elements? Thanks Andrew. The schema files have been create via copy &amp; paste and need a thorough clean up (and some documentation). I'll look into that. fixes checked in with CL 188.  Note: if you use the Ganymede Schema editor, it will automatically change it back to lowercase &quot;appinfo&quot;..!?!	
254864	normal	FIXED	Dummy Inbox	christian.haegele	1226358900000	1256515800000		Leaking Memory after closing the Heap Dump Editor	Created <span class=""><a href="attachment.cgi?id=117532&amp;action=diff" name="attach_117532" title="Add disposal of toolbarMgrHelp">attachment 117532</a> <a href="attachment.cgi?id=117532&amp;action=edit" title="Add disposal of toolbarMgrHelp">[details]</a></span> Add disposal of toolbarMgrHelp  After opening/closing a heap dump, MAT consums more memory. Heap Dump analysis shows, that there is still a reference to the Snapshot by   Display - MenuItem[] - MenuItem - ExecuteQueryAction - HeapEditor - SnapshotQueryContext - SnapshotImpl  Therefore the swt widget is not disposed probably after closing the Heap Dump tab.  There's another issue in MultiPaneEditor which doesn't dispose toolbarMgrHelp (see attachement). added disposal of toolbarMgrHelp.  Failed to reproduce the leak, could be that the issue was already fixed --&gt; close the ticket.	
255510	normal	FIXED	Krum Tsvetkov	andrew_johnson	1226883720000	1236895920000		Finalizer queries don't work for IBM VMs	The finalizer queries don't work for IBM VMs and have a problem with Sun VMs as 1.The finalizer thread is called &quot;Finalizer thread&quot; 2.The finalizer thread is a java.lang.Thread 3.On IBM Java 5 &amp; 6 VMs, the objects to be finalized are not on the java.lang.ref.Finalizer queue. Instead they are marked as GC Roots of type finalizable. The order that these objects will be finalized is not known. 4.On IBM Java 5 &amp; 6 VMs, the object being finalized is not a referent of a java.lang.ref.Finalizer local variable. Instead it is a local variable of the finalizer thread, but it is not known which, so all local variables of the finalizer thread should be returned as possible finalizer objects in processing. 5.With Sun VMs calling System.runFinalization() causes the creation of an extra thread of type java.lang.Thread, name &quot;Secondary finalizer&quot; to do the finalization. The current queries don't allow for this thread, or multiple finalizer threads in general. If runFinalization is called by several threads at once or from a finalizer then several &quot;Secondary finalizer&quot; threads will be active at once.  I have a patch that separates the finding of the finalizer threads, and fixes the FinalizerQueueQuery and the FinalizerInProcessing query. Created <span class=""><a href="attachment.cgi?id=118887&amp;action=diff" name="attach_118887" title="Patch for multiple finalizer threads + IBM/Sun differences">attachment 118887</a> <a href="attachment.cgi?id=118887&amp;action=edit" title="Patch for multiple finalizer threads + IBM/Sun differences">[details]</a></span> Patch for multiple finalizer threads + IBM/Sun differences  Sun VMs can have multiple finalizer threads, so this patch isolates finding the  threads to one place, and also allows the code to find the IBM finalizer thread.  The IBM 5.0 and 6 VMs don't use the finalizer ref queue, so use the heap roots to get the finalizer queue (we don't get the order however).  The finalizers being processed in an IBM VM don't have a finalizer ref object, so the only thing to do is to indicate all local objects as possible objects being finalizer. Hi Andrew,  Thanks a lot for the patch. And I apologize for the long time without response to you. I have tried the patch with dtfj dumps from IBM I, AIX and pLinux and it worked fine on all of them. So I will submit your changes.  I have one more suggestion, and wanted to get your opinion on it. The list of objects to be finalized is cut to 25, and normally there are thousands of object in the list. So I wanted to add a histogram of all objects to be finalized. Thus the one doing the analysis will have a much better overview of whats in the queue. For Sun VMs, we would like to keep the object list also, as it shows the order of the objects. For the IBM VMs we cant get the order, so I was wondering if I should remove the list there and show only the histogram. What is your opinion?  Regards, Krum For the IBM 5.0 and 6 VMs there is no order, so the histogram would have all the information.  I think the IBM 1.4.2 VMs do use the finalizer ref queue, so I would say then do both.  I.E. always show the histogram and if there is a finalizer ref queue, show the list as well. Hi Andrew,  today I came accross some change which the patch introduced, but I think is undesired. In the FinalizerInProcessingQuery if there is no java.lang.ref.Finalizer you added all java locals. When I ran this on an HPROF dump, where there was no activity by the finalizer, it showed me tree objects as currently being processed - the thread itself, the reference queue and the queue lock. I think this is somewhat misleading. So I added some checks to exclude these objects specifically:  for (IObject object : localVars) {    if ((object.getObjectId() != i) // shouldn't be the finalizer thread itself     &amp;&amp; !object.getClazz().getName().equals(&quot;java.lang.ref.ReferenceQueue&quot;) // exclude the queue also     &amp;&amp; !object.getClazz().getName().equals(&quot;java.lang.ref.ReferenceQueue$Lock&quot;)) // exclude also the queue lock {     result.add(object.getObjectId()); } }  Is it possible to run into similar situation with IBM dumps? Do you have for me some further class names which I should exclude?  Regards, Krum Hi Andrew,  I applied your patch, made the change we discussed and committed them together - revision 279 in SVN.  I complete the message now. Thanks again for the contribution.  Greets, Krum	
256154	normal	FIXED	Andreas Buchen	chris	1227244800000	1269207660000		Inspector: Strings With Large Char Arrays	Find strings that retain wasteful char arrays. This helps find the common problem of a string holding onto a larger than  necessary char[] due to substring(), XML, regex, etc.  In one of my recent heaps this inspector found 16,546 strings backed by a  larger than necessary char[]. For example, the largest &quot;wasted&quot; String has  a length of 251, while it retains a char[] of length 25,546 - and it's the  only reference! That's quite a waste that's easy to fix. Created <span class=""><a href="attachment.cgi?id=118504&amp;action=diff" name="attach_118504" title="code">attachment 118504</a> <a href="attachment.cgi?id=118504&amp;action=edit" title="code">[details]</a></span> code Hi Chris,  thanks for the patch.  I am thinking right now if this query could possibly return &quot;false positives&quot;. Multiple strings could point to one and the same char[]. While each of the Strings point only to some parts of the char array, the char array itself is still fully used.  Andreas. Hello Andreas, Yes it can. I thought about trying harder to weed those out but initially opted not to.   It's simple to tell if there is a single String retaining the char[] and in the case where multiple Strings point to different parts of a large char[] I wanted to determine how &quot;efficiently&quot; the char[] was being shared.  Now that I say it, it may make more sense to separate these two into separate inspectors. One that finds the &quot;single string&quot; pointing to large char array and another inspector that calculates the amount wasted by having multiple Strings point to a shared char[]. Maybe one query is enough: if a char array has 50+ chars waste, then it should show up in the list. Only char arrays, that have inbound references by strings, are considered.  If multiple Strings point to one char array and reduce the waste below the 50 boundary, that's fine too. Copying the array to avoid the waste would probably be not efficient either. Hi all, I agree that finding Strings that retain too large char arrays is a good thing, also with JVM's &gt;1.4 less sharing is done and the problem is typically not as frequent anymore.   If I understand Andreas correctly he proposes going backwards from char[] to Strings. I think that makes sense, because it's very easy to implement and char[]'s which are referenced by more than one String can easily be discarded.  It's also very likely that the main problems are found because I dont' remember that I've seen char[] with unused areas referenced by more than one String.   One could extend it by counting all unused areas in a char, which would be clearly wasted space, but that would lead to a much more time consuming query.    I'm not sure whether counting how efficiently a char[] is shared makes sense, because you could argue that say 1000 Strings, which share the same char[] are not a good thing, because 1 String sharing one char[] would be much better.   &#64;Chris, I have a query that counts duplicated Strings, which typically is the more severe problem. It also counts how many char[] are referenced by the Strings, and therefore it also takes into account how efficient char[]'s are used.   I will submit a patch for it finally, I was searching for testers maybe Chris would also like to have some fun with it.  Created <span class=""><a href="attachment.cgi?id=120794&amp;action=diff" name="attach_120794" title="Alternative waste char[] query">attachment 120794</a> <a href="attachment.cgi?id=120794&amp;action=edit" title="Alternative waste char[] query">[details]</a></span> Alternative waste char[] query  Hi Chris,  I found the time to adapt your query. It is now considering all inbound references to a char array. If you find the time to test, I would be happy to get your feedback.  Happy Holidays,  Andreas. I have added the query with change list [246]...	
256155	normal	FIXED	Dummy Inbox	chris	1227244920000	1269208140000		Inspector: Find primitive arrays with a constant value	Created <span class=""><a href="attachment.cgi?id=118505&amp;action=diff" name="attach_118505" title="code">attachment 118505</a> <a href="attachment.cgi?id=118505&amp;action=edit" title="code">[details]</a></span> code  Find primitive arrays with a constant value This started with a more specific inspector that found SWT image(data)s  that were blank. Someone was create lots of images for a cache but never  actually using/drawing into them so they just wasted Java heap. I realized  that the specific image inspector can be extrapolated into a general array  constant value inspector.  If I run this inspector across a recent heap I see 1.3MB wasted by the top  8 offenders. For example someone created a byte[] of size 880,256 but every  entry of that array has the same value. Hi Chris,  thanks for the patch!  I did some minor changes: * I removed the unused &quot;segments&quot; variable. * If no primitive arrays are found, I return an empty result. I though that just silently not opening a window and no message might leave the user confused.  I wonder: should we exclude primitive arrays with length = 1? Such arrays will always have constant value.  Andreas. Thanks Andreas. Yes I think it makes sense to exclude primitive arrays with length 1. patch applied. :-)	
256248	normal	FIXED	Dummy Inbox	andrew_johnson	1227468180000	1271812500000		Huge object arrays are slow to view in the object inspector	Created <span class=""><a href="attachment.cgi?id=118566&amp;action=diff" name="attach_118566" title="Patch to only read the required element of the array">attachment 118566</a> <a href="attachment.cgi?id=118566&amp;action=edit" title="Patch to only read the required element of the array">[details]</a></span> Patch to only read the required element of the array  Build ID: 0.7.0.200810081028  Steps To Reproduce: 1.Generate a dump with a huge object array e.g. 15,000,000 elements 2.Open dump 3.Open object inspector 4.Open class histogram view 5.Expand list of object arrays 6.Select huge object array so that it comes up in the inspector window. 7.If this takes a long time, you've seen the bug.    More information: LazyFields.java asks for the whole reference array, rather than just the element it is interested in. thanks, andrew, fixed.	
257791	normal	FIXED	Andrew Johnson	chris	1228480920000	1231989960000		IBM 1.5 collections mischaracterized as IBM 1.6	Created <span class="bz_obsolete"><a href="attachment.cgi?id=119688&amp;action=diff" name="attach_119688" title="patch">attachment 119688</a> <a href="attachment.cgi?id=119688&amp;action=edit" title="patch">[details]</a></span> patch  Steps to reproduce: 1. Use MAT + DTFJ to load an IBM 1.5 heap. 2. Open class histogram 3. Find java.util.HashMap  Popup &gt; Java Collections &gt; Collections Grouped By Size Opens a view with a all collections of size zero  Popup &gt; Java Collections &gt; Hash Entries Causes a NullPointerException  These problems are caused by MAT recognizing IBM 1.5 collections as IBM 1.6 collections.  This patch fixes the problem. Andrew, can you please advise on this one? - Andreas. The diagnosis is correct, but I don't think the fix is quite right, as I've got an IBM Java 6 dump without the org.apache.harmony.kernel.vm.VM class.  I'll see what other reliable class differences there are between the IBM 1.5 and 1.6 VMs. Created <span class="bz_obsolete"><a href="attachment.cgi?id=119763&amp;action=diff" name="attach_119763" title="Patch to detirmine type of IBM VM">attachment 119763</a> <a href="attachment.cgi?id=119763&amp;action=edit" title="Patch to detirmine type of IBM VM">[details]</a></span> Patch to detirmine type of IBM VM  It seems that IBM Java 5.0 has com.ibm.oti.vm.BootstrapClassLoader$FindClassLock and IBM Java 6 doesn't, so perhaps this could be used instead.  I'll do some investigation to check this assumption. Created <span class=""><a href="attachment.cgi?id=122656&amp;action=diff" name="attach_122656" title="Patch to detirmine type of dump - IBM Java 5/6/1.4.2">attachment 122656</a> <a href="attachment.cgi?id=122656&amp;action=edit" title="Patch to detirmine type of dump - IBM Java 5/6/1.4.2">[details]</a></span> Patch to detirmine type of dump - IBM Java 5/6/1.4.2  The original code using com.ibm.oti.vm.AbstractClassLoader$CacheLock to spot IBM Java 6 doesn't work as recent IBM Java 5 such as SR8 also has this class.  The proposed patch using com.ibm.oti.vm.BootstrapClassLoader$FindClassLock to spot IBM Java 5 doesn't work as IBM Java 5 GA does not have this class.  The current patch is to try using com.ibm.misc.JavaRuntimeVersion to spot Java 5. This class seems to be present and loaded with IBM Java 5 GA and IBM Java 5 SR8, but not present with IBM Java 6. Andrew, I tested the code on my sample dump. Patch submitted. Thanks. Andreas.	
257871	normal	FIXED	Andreas Buchen	andreas.buchen	1228684140000	1232565420000		Confirm Intent	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=251715" title="RESOLVED FIXED - Confirm Intent">Bug #251715</a></span> +++  Projects must have stated and demonstrated their intent to join Galileo by the M4+0 date.  Projects do so by adding themselves to this bug and each of the P1 bugs used to define &quot;Must-Do&quot; requirements for train participation. (In reply to <a href="show_bug.cgi?id=257871#c0">comment #0</a>) <span class="quote">&gt; Projects must have stated and demonstrated their intent to join Galileo by the &gt; M4+0 date.  Projects do so by adding themselves to this bug and each of the P1 &gt; bugs used to define &quot;Must-Do&quot; requirements for train participation. &gt; </span > Is this done? Can you resolve as confirmation that you are joining the Galileo release train? Done. Addtl. bugzillas created. MAT has already added the Galileo build contribution.	
257872	normal	FIXED	Andreas Buchen	andreas.buchen	1228684200000	1236119100000		Intent	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252790" title="RESOLVED FIXED - Intent">Bug #252790</a></span> +++  Projects must have an project plan in XML format. Project plan available at <a href="http://www.eclipse.org/projects/project-plan.php?projectid=technology.mat">http://www.eclipse.org/projects/project-plan.php?projectid=technology.mat</a>	
257873	normal	FIXED	Andreas Buchen	andreas.buchen	1228684260000	1228771380000		Communicate	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252789" title="RESOLVED FIXED - Communicate">Bug #252789</a></span> +++  At least one person from each project must subscribe to cross-project bug inbox, i.e. edit Bugzilla prefs to watch &quot;cross-project.inbox&#64;eclipse.org&quot;. Build team members (or their designated alternates) from each project will provide communication channels: phone, mail, IM, IRC and will be available during the milestone integration periods. added myself.	
257874	normal	FIXED	Andreas Buchen	andreas.buchen	1228684320000	1243971300000		Attendance	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252791" title="RESOLVED FIXED - Attendance">Bug #252791</a></span> +++  Project representatives must attend the planning meetings and conference calls - you have to be involved to be involved. So far, we were represented by SAP representatives - K.Schmidt resp. K.Raev. I'll attend the next call.	
257875	normal	FIXED	Andreas Buchen	andreas.buchen	1228684380000	1244435820000		Ramp Down Policy	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252792" title="RESOLVED FIXED - Ramp Down Policy">Bug #252792</a></span> +++  Projects must have a written ramp down policy by M6+0, linked in the table above pending inclusion of ramp down element in the XML project plan. (One of the issues identified with this guideline is that its not so much the ramp down policy of how many votes are needed for each bug fix that we need to be consistent on, but rather the meaning of each of the milestones and release candidates. See Platform 3.4 Endgame plan as a guideline. See also Galileo Final Daze.) Ramp down - policy for a small project: <a href="http://dev.eclipse.org/mhonarc/lists/mat-dev/msg00056.html">http://dev.eclipse.org/mhonarc/lists/mat-dev/msg00056.html</a>	
257876	normal	FIXED	Andreas Buchen	andreas.buchen	1228684440000	1243971120000		IP	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252793" title="RESOLVED FIXED - IP">Bug #252793</a></span> +++  Projects must have their IP approved (a normal Eclipse requirement) and will follow the Eclipse Legal deadlines to do so. See also <span class="bz_closed"><a href="show_bug.cgi?id=220977" title="RESOLVED FIXED - Standard IP Log format automatically maintained">bug 220977</a></span>. IP log has been approved: <a href="http://dev.eclipse.org/mhonarc/lists/mat-dev/msg00054.html">http://dev.eclipse.org/mhonarc/lists/mat-dev/msg00054.html</a>	
257877	normal	FIXED	Andreas Buchen	andreas.buchen	1228684500000	1244578980000		APIs	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252794" title="RESOLVED FIXED - APIs">Bug #252794</a></span> +++  Projects should leverage only published APIs of dependencies. As a Release Review requirement, deviations should be listed as part of a migration plan, with bugs listed where APIs need to be provided by dependent projects. MAT is compliant.	
257878	normal	FIXED	Elena Nayashkova	andreas.buchen	1228684500000	1235678820000		Message Bundles	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252795" title="RESOLVED FIXED - Message Bundles">Bug #252795</a></span> +++  Projects must use Eclipse message bundles unless there are technical reasons not to. (see Message Bundle Conversion Tool and [1]) message bundles are used	
257879	normal	FIXED	Andreas Buchen	andreas.buchen	1228684560000	1236119520000		Version Numbering	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252796" title="RESOLVED FIXED - Version Numbering">Bug #252796</a></span> +++  Projects must use 4-part version numbers. done.	
257881	normal	FIXED	Andreas Buchen	andreas.buchen	1228684620000	1236119460000		Leverage OSGi	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252797" title="RESOLVED FIXED - Leverage OSGi">Bug #252797</a></span> +++  All plug-ins (bundles) must use the true bundle form. That is, provide a manifest.mf file, and not rely on the plugin.xml file being 'translated' into a manifest.mf file at initial startup. See <span class="bz_closed"><a href="show_bug.cgi?id=130598" title="RESOLVED FIXED - use of manifest.mf should be a release requirement">bug 130598</a></span>. With that, empty plugin.xml files in the presence of a manifest.mf file should not be included in a bundle. all MAT bundles provide manifest files.	
257882	normal	FIXED	Andreas Buchen	andreas.buchen	1228684680000	1236119460000		Execution Environment	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252798" title="RESOLVED FIXED - Execution Environment">Bug #252798</a></span> +++  All plug-ins must correctly list their required JVM versions in the manifest.mf. See the wiki page about selecting the correct JVM. requirement specified (J2SE-1.5)	
257884	normal	FIXED	Erwin Margewitsch	andreas.buchen	1228684680000	1236131820000		Signing	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252799" title="RESOLVED FIXED - Signing">Bug #252799</a></span> +++  Projects must use signed plugins using the Eclipse certificate. Exceptions must be authorized by the planning council for technical reasons. The plugins are signed.	
257885	normal	FIXED	Elena Nayashkova	andreas.buchen	1228684800000	1229646420000		Use Jars	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252800" title="RESOLVED FIXED - Use Jars">Bug #252800</a></span> +++  Projects must use jar'ed plug-ins (with unpack=false) unless authorized by the planning council for technical reasons. Nested jars should be avoided if possible since it creates problems for projects that has dependencies to such plug-ins. The OSGi runtime is fine with it but the compiler is not able to handle classpaths that contain nested jars. In case only one nested jar exists, it is often better to expand the contents of that jar into the root folder (i.e. unnest the jar). If a plug-in contains large files that are frequently used (opened and closed), a jar'ed plug-in might degrade performance significantly since the file must be decompressed each time it is opened. This is relevant for our help plug-in which in turn contains the sample heap dump. org.eclipse.mat.ui.help is now packed in jar. Sample heap dump, located in this plug-in, will be extracted to the &lt;workspace&gt;\.metadata\.plugins\org.eclipse.mat.ui\heapdump folder	
257886	normal	FIXED	Andreas Buchen	andreas.buchen	1228684800000	1236124440000		Builds	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252801" title="RESOLVED FIXED - Builds">Bug #252801</a></span> +++  Projects must have build process maturity: scripted, repeatable, and executable by others. We are using the PDE Build, so we fulfil the requirements.	
257887	normal	FIXED	Andreas Buchen	andreas.buchen	1228684860000	1236119340000		Orbit	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252803" title="RESOLVED FIXED - Orbit">Bug #252803</a></span> +++  Any new third-party plug-ins that are common between projects must be consumed via Orbit; the final Galileo release will not have duplicate third-party libraries (note that this only applies to identical versions of the libraries; thus if project A requires foo.jar 1.6 and project B uses foo.jar 1.7, that's ok). Libraries are consumed via Orbit (MAT uses only icu)	
257888	normal	FIXED	Erwin Margewitsch	andreas.buchen	1228684860000	1242110040000		Optimization	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252804" title="RESOLVED FIXED - Optimization">Bug #252804</a></span> +++  Projects must optimize their own update site using pack200 to reduce bandwidth utilization and provide a better update experience for users. With the introduction of p2, project update sites must generate metadata (artifact and content repository info). MAT packs its update-site with pack200 and provides p2 metadata.	
257889	normal	FIXED	Andreas Buchen	andreas.buchen	1228684920000	1244420760000		New & Noteworthy	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252805" title="RESOLVED FIXED - New &amp; Noteworthy">Bug #252805</a></span> +++  Must have new &amp; noteworthy for each milestone. Must be something readable and usable not just a static list of all the bugs, e.g. platform. Corollary: individual new &amp; noteworthy should be linked in to the collective New &amp; Noteworthy. Done. Shipped as part of help center.	
257890	normal	FIXED	Andreas Buchen	andreas.buchen	1228684980000	1243971060000		Work Together	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252806" title="RESOLVED FIXED - Work Together">Bug #252806</a></span> +++  This means that users can load any subset of the Galileo projects into Eclipse and each of the loaded projects will pass all the same tests as if it had been loaded independently. If such a problem is identified, the affected projects must fix the problem. We regularly compile and test against Eclipse Platform 3.3 and up. Both as RCP application or embedded into the IDE. I'm closing this bug, and if actual bugs are reported, a separate bug would have to be raised against the component in question.	
257892	normal	FIXED	Andreas Buchen	andreas.buchen	1228685040000	1235074500000		Localization - Babel	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252808" title="RESOLVED FIXED - Localization - Babel">Bug #252808</a></span> +++  The project participates in Babel, meaning it is registered and available for string translation, etc. MAT participates in Babel. All Strings are externalized and available for translation.	
257893	normal	FIXED	Andreas Buchen	andreas.buchen	1228685100000	1233878460000		Localization - ICU4J	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252809" title="RESOLVED FIXED - Localization - ICU4J">Bug #252809</a></span> +++  Must use  ICU4J. references of java.text.MessageFormat were changed to com.ibm.icu.text.MessageFormat. That was the only necessary change. 	
257895	normal	FIXED	Andreas Buchen	andreas.buchen	1228685160000	1243982460000		Usability	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252810" title="RESOLVED FIXED - Usability">Bug #252810</a></span> +++  Should follow the User Interface Guidelines. The UI Checklist is a good place to start. Also, should participate in a User Interface Best Practices Working Group  UI walkthrough. closing the bug. MAT follows the UI Guidelines. We didn't have time though to participate in a UI Best Practices User Group UI walkthrough.	
257896	normal	FIXED	Andreas Buchen	andreas.buchen	1228685280000	1243984500000		Accessibility	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252811" title="RESOLVED FIXED - Accessibility">Bug #252811</a></span> +++  Should design and test for accessibility. Not enough resources to achieve this SHOULD requirement.	
257897	normal	FIXED	Andreas Buchen	andreas.buchen	1228685340000	1243473240000		Performance	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252812" title="RESOLVED FIXED - Performance">Bug #252812</a></span> +++  Projects should devote at least one milestone to performance and scalability improvements. We care about performance and certainly do fix and improve performance but we do not plan to devote at least one milestone to performance and scalability improvements. The parsing has been extensively tuned - multi-threading is an option for Galileo.	
257898	normal	FIXED	Andreas Buchen	andreas.buchen	1228685340000	1243982700000		Localization - Babel PTT	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252814" title="RESOLVED FIXED - Localization - Babel PTT">Bug #252814</a></span> +++  The project should use the Babel Pseudo Translation Test to verify their translatablity. Translatability of MAT was checked with Babel PPT. Besides, we've got a contibutor, working on Japaneese translation of MAT - it is the best prove that everything works as expected.	
257899	normal	FIXED	Andreas Buchen	andreas.buchen	1228685400000	1243473000000		Localization - UI freeze	+++ This bug was initially created as a clone of <span class="bz_closed"><a href="show_bug.cgi?id=252815" title="RESOLVED FIXED - Localization - UI freeze">Bug #252815</a></span> +++  Should freeze the UI sufficiently early to allow the Babel project time to translate strings. *** <span class="bz_closed"><a href="show_bug.cgi?id=257900" title="RESOLVED DUPLICATE - Localization - UI freeze">Bug 257900</a></span> has been marked as a duplicate of this bug. *** UI is frozen, Babel is configured.	
258222	normal	FIXED	Andreas Buchen	chris	1228828140000	1281035280000		Add RGB resolver so RGB objects display their red/green/blue	Created <span class=""><a href="attachment.cgi?id=119988&amp;action=diff" name="attach_119988" title="RGB resolver patch">attachment 119988</a> <a href="attachment.cgi?id=119988&amp;action=edit" title="RGB resolver patch">[details]</a></span> RGB resolver patch  I found this resolver very useful in finding large duplication in RGB colors. In a recent heap dump 90% of all RGBs were the same color, black. Hi Chris, thx for this contribution! I applied the patch and it looks fine. Will commit the changes the next days. (we have made &quot;official&quot; release and had the IP log checked for that, so I want to wait for that). Andreas. Hi again,  what do you think of this format for the RGB output?     return String.format(&quot;(%03d,%03d,%03d)&quot;, red, blue, green);  I was thinking that the padding to 3 characters could make it more readable:     (042,255,000)    (000,000,000)    I also like your idea of running Group By value of all RGB objects. And ooops. There is quite a lot of black... :-)   String Value | Objects | Shallow Heap | Retained Heap  ----------------------------------------------------- (000,000,000)|   3.005 |       72.120 |     &gt;= 72.120  (255,255,255)|      76 |        1.824 |      &gt;= 1.824  (255,000,000)|      14 |          336 |        &gt;= 336  -----------------------------------------------------   Andreas. Hi Andreas - I like the padding. Chris, I have submitted the patch. thx. Hey Andreas - there was a small bug in your final commit.  The code is showing RBG instead of RGB. Created <span class=""><a href="attachment.cgi?id=120218&amp;action=diff" name="attach_120218" title="RGB instead of RBG">attachment 120218</a> <a href="attachment.cgi?id=120218&amp;action=edit" title="RGB instead of RBG">[details]</a></span> RGB instead of RBG thx chris, next try... :-) Comment on <span class=""><a href="attachment.cgi?id=119988&amp;action=diff" name="attach_119988" title="RGB resolver patch">attachment 119988</a> <a href="attachment.cgi?id=119988&amp;action=edit" title="RGB resolver patch">[details]</a></span> RGB resolver patch  Adjusting the iplog flags to be on the patches and not on the whole message.	
258224	normal	FIXED	Andreas Buchen	chris	1228829700000	1269207960000		InspectorView enhancement to render ImageData and RGBs	Created <span class="bz_obsolete"><a href="attachment.cgi?id=119989&amp;action=diff" name="attach_119989" title="inspector view patch">attachment 119989</a> <a href="attachment.cgi?id=119989&amp;action=edit" title="inspector view patch">[details]</a></span> inspector view patch  This patch modifies the inspector view to display the Image recreated from the ImageData found in a heap. It also displays the appropriate color when an RGB is selected. Sweet. That's really cool. This is going in for sure. :-)  I have tested this feature on a couple of Eclipse dumps. Somehow a lot of the images are &quot;broken&quot;: some are shown only partially, some are somehow gray. Do you see the same? Hi Andreas - No I haven't seen that. I tested against WinXP and Linux dumps of an RCP app. Is there anyway I can grab one of your dumps that shows corruption and take a look? Created <span class=""><a href="attachment.cgi?id=120197" name="attach_120197" title="Screenshot of sample ImageData">attachment 120197</a> <a href="attachment.cgi?id=120197&amp;action=edit" title="Screenshot of sample ImageData">[details]</a></span> Screenshot of sample ImageData  Hi Chris,  see the screenshot above. I'll also make the heap dump available. You'll get a separate email. From looking at the code, I cannot really tell anything.  Cheers,  Andreas. Perhaps the image you're looking at is a mask used to created other images. In other words, it might be correct. I'll know better once I take a look at your heapdump. Created <span class=""><a href="attachment.cgi?id=120217&amp;action=diff" name="attach_120217" title="patch with transparency fix">attachment 120217</a> <a href="attachment.cgi?id=120217&amp;action=edit" title="patch with transparency fix">[details]</a></span> patch with transparency fix Thanks for the dump Andreas. I did find a problem with transparency. As I suspected, I believe some of the images look badly because they're masks.  Let me know if the new patch works better for you.  -Chris Hi Chris,  I guess found the difference: when using a HPROF dump, the parser does not return a new array each time one calls getValueArray(). If the array is passed on to the ImageData constructor, it uses it internally and seems to change the data. I realized this when I was going up and down through the list of icons and the icon was changing each time... Now most of the icons look fine and the remaining icons are probably masks.  byte[] orig = (byte[]) ((IPrimitiveArray) object.resolveValue(&quot;data&quot;)).getValueArray(); byte[] dataArray = new byte[orig.length]; System.arraycopy(orig, 0, dataArray, 0, orig.length);   Andreas. Hi Andreas, Good catch, yeah that makes sense. submitted.  I'd like to blog a/b this on the MAT blog once we upload this version. Do you have a blog and/or website which I could link to? Just www.gstaff.org? Yes www.gstaff.org is it, that and google :-)	
263148	major	FIXED	Andreas Buchen	acoliver	1233394320000	1235598180000		java.lang.RuntimeException: multiple class instances exist for char[]	Build ID: (API 0.7.0.200812101332)   Steps To Reproduce: 1.can supply dumps which exhibit (contact via email) I don't want to have google crawling them :-) 2. 3.   More information: java.lang.RuntimeException: multiple class instances exist for char[] at org.eclipse.mat.hprof.HprofParserHandlerImpl.lookupClassByName(HprofParserHandlerImpl.java:487) at org.eclipse.mat.hprof.Pass1Parser.readPrimitiveArrayDump(Pass1Parser.java:368) at org.eclipse.mat.hprof.Pass1Parser.readDumpSegments(Pass1Parser.java:199) at org.eclipse.mat.hprof.Pass1Parser.read(Pass1Parser.java:104) at org.eclipse.mat.hprof.HprofIndexBuilder.fill(HprofIndexBuilder.java:65) at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:184) at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:102) at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:87) at org.eclipse.mat.ui.snapshot.ParseHeapDumpJob.run(ParseHeapDumpJob.java:54) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55) mainly this happens if you do more than 1 heap dump from the same process.  Meaning the first one will be good, the subsequent ones will cause this error.  Seems like it is 90% a JDK bug, but really it should be able to do something with these heap dumps (like realize &quot;oh that is from an earlier dump, ignore it or something&quot;)...   wow! 1st time I see this exception. Until now it was &quot;can never happen but just let's be sure&quot; coding...  I'd love to take a look into the heap dump. Maybe we can make a guess based on the class loader which loaded the class. It would be a better solution to write a warning to the log and continue loading the dump. sending you an email with a link (too big to u/l and fear the googlebot).  This is 99% a JDK bug.  Upgrading from 1.6.0_02 (lintel32) to 1.6.0_11 and using jmap instead of CTRL-/ and the &quot;-dump:format=b,file=HeapDump.hprof&quot; option fixed it.  Before I discovered this I did some &quot;Machiavellian&quot; changes to MAT which allowed things to continue to parse, but hovering over the big pie report mostly generated errors.     So I suspect throwing a big &quot;Upgrade your JDK, this one isn't good&quot; will probably do the most good. sent the email, let me know if you don't see it. Hi Oliver,  the problem actually ocurred, because the HPROF file contained multiple dumps. I guess you have triggered those dumps via the HPROF agent.  I have changed the code in such a way that we read only the first dump and print a message to the log file. If one wants to read an alternative dump, then one has to set a system property. That is a little bit awkward, but, heck, it doesn't happen that often. If it turns out to be a problem, we could think about UI support.   Andreas.	
264857	normal	FIXED	Dummy Inbox	benjamin.muskalla	1234492200000	1234494900000		Use Import-Package for com.ibm.icu	Instead of using Require-Bundle you should use Import-Package for all com.ibm.icu related stuff. This has the advantage of running MAT with com.ibm.icu.base instead of the full blown package.  See <a href="http://wiki.eclipse.org/index.php/ICU4J#Replacement_Plug-in">http://wiki.eclipse.org/index.php/ICU4J#Replacement_Plug-in</a> changed. Thanks for the hint.	
266231	normal	FIXED	Andreas Buchen	eclipse	1235555340000	1236663600000		NullPointerException on some reports on phd dump	I have a reasonably large (private, sorry) .PHD dump loaded using:  com.ibm.dtfj.feature_1.3.0.200902101205.jar org.eclipse.mat.ibmvm.feature_0.7.0.200902101205.jar  into:  org.eclipse.mat.jdt_0.7.0.200812101332.jar.  This needs of the order of -Xmx5G to complete the parse, and Eclipse has OOMed at least once while browsing the results.  The below happen before this OOM would occur (e.g. the &quot;used&quot; heap never passes 4gb even with -Xmx7G).  Many of the functions work fine (as far as I can tell) (Heap Dump Overview, Leak Suspects, Dominator Tree, etc.), but Top Components:   java.lang.NullPointerException     at org.eclipse.mat.inspections.component.ComponentReportQuery.addSoftReferenceStatistic(ComponentReportQuery.java:684)     at org.eclipse.mat.inspections.component.ComponentReportQuery.execute(ComponentReportQuery.java:117)     at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:114)     at org.eclipse.mat.snapshot.query.SnapshotQuery.execute(SnapshotQuery.java:147)     at org.eclipse.mat.inspections.component.TopComponentsReportQuery.execute(TopComponentsReportQuery.java:68)     at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:114)     at org.eclipse.mat.query.registry.CommandLine.execute(CommandLine.java:91)     at org.eclipse.mat.report.internal.QueryPart.execute(QueryPart.java:96)     at org.eclipse.mat.report.TestSuite.execute(TestSuite.java:127)     at org.eclipse.mat.report.internal.RunRegisterdReport.execute(RunRegisterdReport.java:49)     at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:114)     at org.eclipse.mat.ui.QueryExecution$ExecutionJob.run(QueryExecution.java:174)     at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)    ...and Finalizer References Statistics:  java.lang.NullPointerException     at org.eclipse.mat.inspections.ReferenceQuery.execute(ReferenceQuery.java:50)     at org.eclipse.mat.inspections.FinalizerReferenceStatQuery.execute(FinalizerReferenceStatQuery.java:33)     at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:114)     at org.eclipse.mat.ui.QueryExecution$ExecutionJob.run(QueryExecution.java:174)     at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)   ... NPE quickly.    Heap Dump Details: Format: J2RE 1.4.2 IBM AIX 5L for PowerPC (64 bit JVM) build... Identifier size: 64-bit File length: 286.4M. Heap: ~2.4gb Number of Object: &gt;33M. Number of Classes: ~2k Number of Class Loaders: 20 Number of GCRoots: ~14k.  Eclipse: eclipse.buildId=I20081211-1908 java.version=1.6.0_12 java.vendor=Sun Microsystems Inc. BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=en_GB Command-line arguments:  -os win32 -ws win32 -arch x86_64 PHD files don't have any field information. The both problems are caused by using a getField without testing for null. This could occur in other places too. Created <span class="bz_obsolete"><a href="attachment.cgi?id=127015&amp;action=diff" name="attach_127015" title="Isolate getting a referent field">attachment 127015</a> <a href="attachment.cgi?id=127015&amp;action=edit" title="Isolate getting a referent field">[details]</a></span> Isolate getting a referent field  This patch shows how to isolate getting a referent field. It also guesses a referent field from outbound references for a java.lang.ref.Reference if the field is not found (e.g. PHD files).  There are some other getFields to be fixed, notably in the Finalizer queries. The finalizer queries also need to be updated for IBM VMs - see another defect. Andrew,  together with Carmine, I added the following code to the Weak Reference, Finalizer Queries etc etc. So actually, the &quot;old&quot; PHD adapter should never allow the execution of this code.          InspectionAssert.heapFormatIsNot(snapshot, &quot;phd&quot;);  It looks like, now we only now it is DTFJ (because PHD is read via DTFJ). So we are back to square one a/b this discussion:  a) define a format/subformat pair which can be queried to decided how to do finalizer (&quot;dtfj&quot;/&quot;phd&quot; or &quot;hprof&quot;/&quot;sun&quot;). This actually relates to the other open issue a/b having multiple elements in the parser definition. Essentially those could be the sub elements? b) have the capabilities with the snapshot (&quot;hasFieldValues&quot;) and have the queries ask for those properties  I tend to go for (a). What are your thoughs on this?  Andreas. Each different implementation of DTFJ now has a different MAT heap format.  The type is defined in the DTFJ implementation and is converted by the DTFJ adapter into an MAT heap format with a separate parser element. The current formats are:  DTFJ-J9 DTFJ-Javacore DTFJ-SDFF DTFJ-PHD  DTFJ-PHD files don't have field information or primitive field/array values, though they do have outbound references.  DTFJ-Javacore files have very limited information - only classes and class loaders.  I think the first step is to check all the getFields() for null returns, and to use something like my patch for the referent fields.  The finalizer queries could be fixed in a similar way, but there is another bug open with patch about getting them to work with IBM dumps. I didn't want to give a patch on a patch.  Only if the query is completely bogus is it worth totally disabling the query for a dump type  The dump type (e.g. DTFJ-PHD) is not a good way of telling implementation specific parts of a VM dump, as IBM 1.4.2, 5.0 and 6 VMs can all generate DTFJ-PHD dumps.  I've cancelled the multiple parser element bug as I do not now need it. a/b the heap format...  I understand your solution via the dynamic bindings now. You are right, it is not urgent to change something. Nevertheless, with the heap dump, I only store the unique identifier of the extension to be able to re-create the object reader. As long as one and the same id (&quot;DTFJ-PHD&quot; shows up tow times) has the same reader implementation, id does not hurt.   a/b your patch reading the reference field...  If I understand you correctly, if you do not find any field names, you simply take the second outgoing reference (the first one is the &lt;class&gt; reference). This is where I am hesitating a little bit. The second reference could the &quot;referent&quot;, but maybe also the &quot;queue&quot;, &quot;next&quot; or &quot;discovered&quot;. And this is just talking about Sun's current implementation. Any thoughts? Does it work for your PHD dumps? I tried running the following query on my dump:   SELECT w.getOutboundReferences() FROM INSTANCEOF java.lang.ref.WeakReference w WHERE (w.getOutboundReferences().size()&gt;=2) and it does not return any results. I checked the coding, and this is due to the fact that the heap object reader does not fill the &quot;fields&quot; field of the instance.  I also discovered, that in the PHD dump I have on my computer, WeakReference and SoftReference do not extend java.lang.ref.Reference, but java.lang.Object. Any idea? You have added the check (obj.getClazz().doesExtend(&quot;java.lang.ref.Reference&quot;)) but this check would not really help.  Maybe my version is too old? I was using org.eclipse.mat.dtfj_0.7.0.200902101205.jar   On the other hand, the global &quot;it won't work and I don't even try&quot;-approach of not running the query for PHD (which didn't work anymore because the Id changed) is not good either. <span class="quote">&gt;in the PHD dump I have on my computer, WeakReference and SoftReference do not extend java.lang.ref.Reference</span >  Some PHD dumps (e.g. IBM Java 5.0) do not have superclass information, so the doesExtend test is not reliable. We could also test the name against each of the reference types (or regex &quot;java\.util.\.*Reference&quot; and perhaps java.util.ref.Finalizer).  The idea of taking the second reference as the referent isn't good. PHD dumps omit null references, so if the referent is null we would get another field.  We could skip outbound references to reference types or reference queues, then if something was left presume it was the referent.  Your are right about the getOutboundReferences. I was thinking of    obj.getSnapshot().getOutboundReferentIds(obj.getObjectId());  Is there a problem with PHD dumps having getOutboundReferentIds() but not getOutboundReferences()? Inventing field names for getOutboundReferences() seems bogus, especially as the field names would not correspond between different objects of the same type as null fields are omitted.  (In reply to <a href="show_bug.cgi?id=266231#c6">comment #6</a>) <span class="quote">&gt; Your are right about the getOutboundReferences. I was thinking of &gt;    obj.getSnapshot().getOutboundReferentIds(obj.getObjectId());</span >  If you do this, then you cannot make any assumption about the order of the outbounds. Null values do not show up. Only actual outgoing references. (I think it is not re-ordered though, but inbounds are ordered ascending by object id).  <span class="quote">&gt; We could skip outbound references to reference types or reference queues, then &gt; if something was left presume it was the referent.</span >  That surely is one possibility. I ran the following OQL: SELECT OBJECTS outbounds(w) FROM java.lang.ref.WeakReference w and grouped the result as a class histogram.  This created the following for 25.890 weak references.  Class Name                                                  | Objects | ----------------------------------------------------------------------- java.lang.Class                                             |  26.044 | java.lang.ref.ReferenceQueue                                |   2.333 | ....others....                                              |  20.636 | -----------------------------------------------------------------------                                                                49.013  The query does not use the DISTINCT keyword! Interesting, I get more classes than weak references, which means the class types are referenced multiple times. I get similar results for HPROF dumps (33.327 classes references for 18.210 weak references).  What is your take on this? Are the results sufficiently close to the actual data that we can live with the margin of error?  <span class="quote">&gt; Is there a problem with PHD dumps having getOutboundReferentIds() but not &gt; getOutboundReferences()? Inventing field names for getOutboundReferences() &gt; seems bogus, especially as the field names would not correspond between &gt; different objects of the same type as null fields are omitted.</span >  Agreed. Inventing field names is bogus. It just means that we cannot use the getOutboundReferences() to determine the n'th outbound reference. Those include only named outbound references. Created <span class=""><a href="attachment.cgi?id=127309&amp;action=diff" name="attach_127309" title="Try to get the referent when fields do not exist">attachment 127309</a> <a href="attachment.cgi?id=127309&amp;action=edit" title="Try to get the referent when fields do not exist">[details]</a></span> Try to get the referent when fields do not exist  This patch isolates getting the referent of a Reference. If the field is found then it is used.  If it is not found, then if the object appears to be of type Reference or Finalizer (via checking the type, supertype or name) then we look at all the outbound referent ids. We then exclude the type of the object, and what might be link or queue fields pointing to other references or queues. Out of curiosity, I wrote a little query to compare the actual referent with the one determined by the getReferent method. (see attachment) I did run it on a variety of hprof dumps which contain the referent field and therefore allow me to compare. I looked at 5 dumps:  [1] Dump        Dump04 pid775  710    pid14882 oom  [2] Size        3,3GB  1,8GB   0,3GB  2,5GB    2,5GB  [3] References  88389  108343  70462  103726   25082 [4] Success       76%     75%    69%     67%     69%  [5] only JDK    49880   60154  28020    7742   13122 [6] Success      100%    100%   100%    100%    100%  [7] % JDK Refs    56%     56%    40%      7%     52%   First [1] line contains my test dumps, don't bother with the names and[2] is the size of the hprof file.  [3] and [4] show the total number of objects extending java.lang.ref.Reference and the success rate in trying to guess the referent field.  [5] and [6] show the same, but this time only for classes that match the following pattern (&quot;JDK Refs&quot;): &quot;java\\.lang\\.ref\\..*Reference&quot; or &quot;java.lang.ref.Finalizer&quot;.  [7] shows the ratio of JDK references : all references.   In summary, guessing the referent for JDK references works perfectly. However, those make up only between 7% to 56% depending on the use case. Guessing the referent for all references shows a high margin of error - somewhere between 33% and 24%.   Right now I tend to opt for the following option:  * guess the referent only for JDK classes * add indicator to the title that this contains only partial results (e.g. &quot;... (only JDK references)&quot;) * do not show wrong results (e.g. rather show nothing for the non JDK references)   What do you think about this? Created <span class=""><a href="attachment.cgi?id=127333" name="attach_127333" title="Query to check java.lang.ref.Reference guessing">attachment 127333</a> <a href="attachment.cgi?id=127333&amp;action=edit" title="Query to check java.lang.ref.Reference guessing">[details]</a></span> Query to check java.lang.ref.Reference guessing Your idea sounds good. Created <span class=""><a href="attachment.cgi?id=128181&amp;action=diff" name="attach_128181" title="guess referent according to cooment #9">attachment 128181</a> <a href="attachment.cgi?id=128181&amp;action=edit" title="guess referent according to cooment #9">[details]</a></span> guess referent according to cooment #9  Hi Andrew,  I have updated the coding. I tested it on my dumps. Can you do me the favour and do a quick (codE) review of the patch?  Andreas. The fix looks good.  The comment  +     * Important: the &lt;strong&gt;className&lt;/strong&gt; must point to +     * java.lang.ref.Reference or one of its subclasses. We cannot check this, +     * because  isn't quite complete and I don't see the immediate relevance of the OpenSnapshot.java and SnapshotFactoryImpl.java changes, but they look harmless. Hi Andrew,  you're right a/b OpenSnapshot/SnapshotFactoryImpl - it's purpose was to sort the heap formats in the drop-down box alphabetical.  I have committed the patch.  Andreas. Comment on <span class=""><a href="attachment.cgi?id=127309&amp;action=diff" name="attach_127309" title="Try to get the referent when fields do not exist">attachment 127309</a> <a href="attachment.cgi?id=127309&amp;action=edit" title="Try to get the referent when fields do not exist">[details]</a></span> Try to get the referent when fields do not exist  basis for patch	
266348	normal	FIXED	Dummy Inbox	andrew_johnson	1235623680000	1271812560000		Configurable queries for Java Collections: Hash Entries and Extract Hash Set values	Created <span class=""><a href="attachment.cgi?id=126875&amp;action=diff" name="attach_126875" title="Make the queries configurable and allow for null tables">attachment 126875</a> <a href="attachment.cgi?id=126875&amp;action=edit" title="Make the queries configurable and allow for null tables">[details]</a></span> Make the queries configurable and allow for null tables  These queries use known values for the array fields and key/value fields.  They could be made configurable for non-standard hash maps and hash sets.  Also on some IBM dumps an empty HashMap can have a null table. The current query fails which is annoying if the query is done on a whole group of HashMaps. thanks andrew! I added one more check (not only to your query) because I noticed that getClassesByName can return null (and not only an empty list)	
266663	normal	FIXED	Dummy Inbox	andrew_johnson	1235946360000	1235957820000		mat.psf project set file doesn't work properly	Build ID: 0.7.100.20090302  Steps To Reproduce: 1.Go to <a href="http://wiki.eclipse.org/index.php?title=MemoryAnalyzer/Contributor_Reference">http://wiki.eclipse.org/index.php?title=MemoryAnalyzer/Contributor_Reference</a> 2.Download mat.psf 3.File -&gt; Import -&gt; Team Project Set.    More information: Errors:  Checkout operation for '<a href="http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/plugins/org.eclipse.mat.chart">http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/plugins/org.eclipse.mat.chart</a>' failed. Checkout operation for '<a href="http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/features/org.eclipse.mat-feature">http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/features/org.eclipse.mat-feature</a>' failed. Checkout operation for '<a href="http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/plugins/org.eclipse.mat.jetty">http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/plugins/org.eclipse.mat.jetty</a>' failed. Checkout operation for '<a href="http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/features/org.eclipse.mat.chart-feature">http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/features/org.eclipse.mat.chart-feature</a>' failed. Checkout operation for '<a href="http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/plugins/org.eclipse.mat.eclipse">http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/plugins/org.eclipse.mat.eclipse</a>' failed. svn: REPORT request failed on '/svnroot/technology/org.eclipse.mat/!svn/vcc/default' svn: Processing REPORT request response failed: The element type &quot;META&quot; must be terminated by the matching end-tag &quot;&lt;/META&gt;&quot;. (/svnroot/technology/org.eclipse.mat/!svn/vcc/default)   svn: URL '<a href="http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/features/org.eclipse.mat-feature">http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/features/org.eclipse.mat-feature</a>' doesn't exist  svn: URL '<a href="http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/plugins/org.eclipse.mat.jetty">http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/plugins/org.eclipse.mat.jetty</a>' doesn't exist  svn: URL '<a href="http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/features/org.eclipse.mat.chart-feature">http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/features/org.eclipse.mat.chart-feature</a>' doesn't exist  svn: URL '<a href="http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/plugins/org.eclipse.mat.eclipse">http://dev.eclipse.org/svnroot/technology/org.eclipse.mat/trunk/plugins/org.eclipse.mat.eclipse</a>' doesn't exist I update the project file set to reflect the new subversion structure (MAT got its own repository some time ago. While the full URL did not change, the repository URL did). Thanks.	
267592	normal	FIXED	Dummy Inbox	andrew_johnson	1236546360000	1236644040000		NullPointerException with IBM Java 5.0 PHD and class loader query	Build ID: 0.7.100  Steps To Reproduce: 1.Open an IBM Java 5.0 PHD file 2.Select the Class Loader Explorer query 3.A null pointer exception occurs   More information: java.lang.NullPointerException at org.eclipse.mat.inspections.ClassLoaderExplorerQuery.execute(ClassLoaderExplorerQuery.java:68) at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129) at org.eclipse.mat.ui.QueryExecution$ExecutionJob.run(QueryExecution.java:174) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55) Created <span class=""><a href="attachment.cgi?id=128000&amp;action=diff" name="attach_128000" title="Generalize loader queries">attachment 128000</a> <a href="attachment.cgi?id=128000&amp;action=edit" title="Generalize loader queries">[details]</a></span> Generalize loader queries  The problem is that the IBM Java 5.0 PHD files do not have superclass information so the class loaders are not subclasses of java.lang.ClassLoader.  The patch fixes this by 1.Tidy up to use names of Class Loader and Class from IClass 2.Handle case where class loaders are not instances of subclasses of ClassLoader. Hi Andrew, thanks for the patch. I retested and it works sweet. Andreas.	
269165	normal	FIXED	Dummy Inbox	andrew_johnson	1237331700000	1267563780000		Minor documentation problems	Build ID: 0.7.100  Steps To Reproduce: Build MAT from latest source  1.Menu help 2.Select help contents 3.View help    More information: New and noteworthy doesn't work (missing items from build.properties in org.eclipse.mat.ui.help )  noteworthy.html noteworthy.dita toc.ditamap  The gc roots page should identify all the root types in GCRootInfo.java  Should heapdump.dita have a dita xref to acquiringheapdump ?  There is a lot of information in the help, which is great. A full review for typos and checking it is up to date might take a while though. I've made some minor updates to the DITA files for these pointer, and updated the corresponding HTML.  I'll do some more checks, then update the DITA and HTML if required. These problems have now been fixed.  Any further updates should be tracked under a new defect.	
270777	normal	FIXED	Elena Nayashkova	hiroyuki.inaba	1238550960000	1260830760000		The dialog font not apply to the ArgumentWizard	The custom dialog font set to the perference  is not applied to ArgumentWizard. The patch that resolves this bug is included in <a href="show_bug.cgi?id=269608" title="NEW - Externalize UI Strings, Labels, Messages, etc for internationalization">bug 269608</a>. Created <span class=""><a href="attachment.cgi?id=130847" name="attach_130847" title="table rows do not resize properly">attachment 130847</a> <a href="attachment.cgi?id=130847&amp;action=edit" title="table rows do not resize properly">[details]</a></span> table rows do not resize properly  patch was committed with the changelist #292. Font issue is fixed. Remaining issue: table rows do not resize properly (decoration icons are bigger than the height of the row), see attached screenshot.  Could you please have alook at it. It causes because the image is not set to TableItem.   To evade, it tried it.  An easy solution is a method of setting the transparent image (X=1, Y=16) to TableItem.   ImageHyperlink have the margin for drawing. Please extend ImageHyperlink, and set 0 to the margin.   EX)  private class _ImageHyperlink extends ImageHyperlink {   public _ImageHyperlink(Composite parent, int style) {     super(parent, style);     marginHeight = 0;   } } Created <span class=""><a href="attachment.cgi?id=154304&amp;action=diff" name="attach_154304" title="Gets the rows in the table tall enough for the icons">attachment 154304</a> <a href="attachment.cgi?id=154304&amp;action=edit" title="Gets the rows in the table tall enough for the icons">[details]</a></span> Gets the rows in the table tall enough for the icons  On Windows XP, normal font size:  The help icon (question mark in a circule) is currently still chopped off at the bottom.  The customized retained set file button is chopped off at the top.  I tried to fix this by adjusting the ImageTextEditor and the layout manager but didn't succeed. The button image is a bit unusual as there is a custom layout manager for the button, but it affects the text box too.  It might be possible to adjust it using SWT.MeasureItem: <a href="http://www.eclipse.org/articles/article.php?file=Article-CustomDrawingTableAndTreeItems/index.html">http://www.eclipse.org/articles/article.php?file=Article-CustomDrawingTableAndTreeItems/index.html</a>  I also saw notes in the code about setting the font size for the table bigger, then setting fonts for individual items smaller so that the table rows were bigger.  I followed this approach, but needed several modifications where subitems inherited fonts from the table. I made them inherit from the TableItem instead. This seems sensible anyway.  The bold/normal applies to the first box of the table item only, the default is the normal for the whole TableItem.  At the beginning the table font size is increased until the height of the row is 16 (the height of the icon). This should probably be dynamic though, in case the icons are changed.  The column headers are in the larger font size, but everything else is the normal size.  Is this a good solution to the problem? I've checked in a fix to make the table font bigger if a table editor needed extra height. The other fonts for table items are not made bigger and the editors inherit from the table items.	
270782	normal	FIXED	Dummy Inbox	hiroyuki.inaba	1238551320000	1238700060000		The help displayed under the ArgumentWizard doesn't follow to the movement	The help displayed under the ArgumentWizard doesn't follow to the movement of the ArgumentWizard. fixed with the patch, provided by Hiroyuki Inaba in <span class="bz_closed"><a href="show_bug.cgi?id=270787" title="RESOLVED FIXED - When the help displayed under the ArgumentWizard resizes, it blinks">bug 270787</a></span>. Change list- 288.  Thank you for your contribution.	
270787	normal	FIXED	Dummy Inbox	hiroyuki.inaba	1238551680000	1271812680000		When the help displayed under the ArgumentWizard resizes, it blinks	When the help displayed under the ArgumentWizard resizes the ArgumentWizard, it blinks.  And, the help displayed always top (It is displayed on the window of the another application). Created <span class=""><a href="attachment.cgi?id=130566&amp;action=diff" name="attach_130566" title="QueryContextHelp.patch">attachment 130566</a> <a href="attachment.cgi?id=130566&amp;action=edit" title="QueryContextHelp.patch">[details]</a></span> QueryContextHelp.patch  This patch is an example of fix this bug and <span class="bz_closed"><a href="show_bug.cgi?id=270782" title="RESOLVED FIXED - The help displayed under the ArgumentWizard doesn't follow to the movement">bug 270782</a></span>. Super! Thank you for the patch. IPlog is approved.	
272887	normal	FIXED	Dummy Inbox	andrew_johnson	1240190040000	1263328020000		No JvmInfo in Heap Dump details pane	Build ID: 0.7.100  Steps To Reproduce: 1.Start MAT 2.Window - Heap Dump History 3.Click on a previous heap dump  The JVM info is not displayed for the dump. With previous builds it used to be. Now it is replaced by the heap dump format.   More information: The 'Format' row used to have information such as the VM version. This was useful when looking at several dumps and deciding which was the appropriate one to reload.  Now it just has the internal dump type identifier, and that doesn't appear until the dump is reloaded. To be honest I don't remember what was previously there. I looked at this today, and figured out that XSnapshotInfo.setJvmInfo() is called only from the DTFJ adapter, i.e. for .hprof we don't call it at all. What appers right now as &quot;Format&quot; is the ID of the parser, e.g. hprof.  What you expected to see there is rather something like: IBM JVM 1.x.y ... Right?  Just let me know what was the expected / previous behaviour and I'll try to figure out when and why the change happened. JVM version disappeared in revision 250, 16 January 2009 of SnapshotOutlinePage.java The Format (hprof, DTFJ-J9, etc) line also isn't saved in the history. This is because a copy of the SnapshotInfo is made for the history without the properties. We need to add this $heapFormat property too. Fixes check in - also copy the $heapFormat property when creating a snapshot history entry, and display the version as &quot;JVM version&quot;.  hprof files don't have a convenient version from the dump. It might be possible to assemble a version from the system properties but that could be complicated, and would have to be done from a query like the System Overview.	
273915	normal	FIXED	Dummy Inbox	chris	1240809540000	1269208320000		New resolvers URL, Point and Rectangle	Created <span class=""><a href="attachment.cgi?id=133396&amp;action=diff" name="attach_133396" title="patch for URL resolver">attachment 133396</a> <a href="attachment.cgi?id=133396&amp;action=edit" title="patch for URL resolver">[details]</a></span> patch for URL resolver  I've found these useful for finding unnecessary duplication. This is similar to Markus's post on Android memory analysis but more powerful. <a href="http://kohlerm.blogspot.com/2009/04/analyzing-memory-usage-off-your-android.html">http://kohlerm.blogspot.com/2009/04/analyzing-memory-usage-off-your-android.html</a> Created <span class=""><a href="attachment.cgi?id=133397&amp;action=diff" name="attach_133397" title="Point, Rectangle resolver">attachment 133397</a> <a href="attachment.cgi?id=133397&amp;action=edit" title="Point, Rectangle resolver">[details]</a></span> Point, Rectangle resolver Created <span class="bz_obsolete"><a href="attachment.cgi?id=133398&amp;action=diff" name="attach_133398" title="Point, Rectangle. URL resolvers">attachment 133398</a> <a href="attachment.cgi?id=133398&amp;action=edit" title="Point, Rectangle. URL resolvers">[details]</a></span> Point, Rectangle. URL resolvers Created <span class=""><a href="attachment.cgi?id=133607&amp;action=diff" name="attach_133607" title="plugin xml changes for new resolvers">attachment 133607</a> <a href="attachment.cgi?id=133607&amp;action=edit" title="plugin xml changes for new resolvers">[details]</a></span> plugin xml changes for new resolvers Thank you for this contribution! And apologies for the long time without any reply. I have just submitted the patches proposed by you into our SVN depot.  I added one thing - as the structure of the org.eclipse.swt.graphics  Point and Rectangle classes was exactly the same as for the java.awt. Point and Rectangle classes, I registered the same resolvers for both AWT and SWT.  I close the message now. If you find some further work on this should be done, just re-open it.	
274539	normal	FIXED	Dummy Inbox	andrew_johnson	1241062620000	1258505400000		Overview pane is missing scroll bars	The overview pane with the   Details Biggest objects by retained size Actions   sections doesn't have scroll bars and if the size of the window is too small then information is hidden.  It isn't clear to a user that he must resize the whole of MAT to get the Actions section to be visible. Changing  org.eclipse.mat.ui.snapshot.panes.OverviewPane to use createScrolledForm() instead of createForm() does not fix it. The pane is then very wide with a scroll bar on the bottom but no scroll bar on the side. The fix is to use a ScrolledForm, TableWrapLayout and TableWrapData. The TableWrapLayout has 3 columns and the TableWrapData specifies which sections need to span 3 columns and which are in single columns.	
278362	normal	FIXED	Dummy Inbox	hiroyuki.inaba	1243551180000	1247007300000		ArrayIndexOutOfBoundsException occurred when international language (ja_jp) is displayed	!SESSION 2009-05-29 19:45:55.425 ----------------------------------------------- eclipse.buildId=M20090211-1700 java.version=1.6.0_11 java.vendor=Sun Microsystems Inc. BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=ja_JP Framework arguments:  -product org.eclipse.sdk.ide Command-line arguments:  -product org.eclipse.sdk.ide -data C:\java\3.4.org\eclipse\mat\plugins/../runtime-new -dev file:C:/java/3.4.org/eclipse/mat/plugins/.metadata/.plugins/org.eclipse.pde.core/new/dev.properties -os win32 -ws win32 -arch x86  !ENTRY org.eclipse.mat.ui 1 0 2009-05-29 19:46:25.582 !MESSAGE ??? C:\java\3.4.org\ja\eclipse.hprof ? 2,358,916 ?????????  !ENTRY org.eclipse.mat.ui 2 0 2009-05-29 19:46:55.466 !MESSAGE Sort column not found: Key  !ENTRY org.eclipse.mat.ui 4 0 2009-05-29 19:46:55.992 !MESSAGE 0 !STACK 0 java.lang.ArrayIndexOutOfBoundsException: 0     at org.eclipse.mat.query.refined.RefinedResultBuilder.setSortOrder(RefinedResultBuilder.java:197)     at org.eclipse.mat.report.internal.QueryPart.addSortOrder(QueryPart.java:465)     at org.eclipse.mat.report.internal.QueryPart.readParamsAndProcess(QueryPart.java:245)     at org.eclipse.mat.report.internal.QueryPart.execute(QueryPart.java:142)     at org.eclipse.mat.report.internal.SectionPart.execute(SectionPart.java:53)     at org.eclipse.mat.report.internal.SectionPart.execute(SectionPart.java:53)     at org.eclipse.mat.report.TestSuite.execute(TestSuite.java:127)     at org.eclipse.mat.report.internal.RunRegisterdReport.execute(RunRegisterdReport.java:50)     at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129)     at org.eclipse.mat.ui.QueryExecution$ExecutionJob.run(QueryExecution.java:174)     at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55) When &quot;Leak Suspects&quot; was executed, it was occurred as follows.   1) !MESSAGE Sort column not found: Key 2) java.lang.ArrayIndexOutOfBoundsException: 0 Changing  HashEntriesQuery_Column_Key=Key in org.eclipse.mat.internal.messages.properties causes the error, as does changing overview.xml     &lt;query name=&quot;%overview.system_properties&quot;&gt;         &lt;param key=&quot;html.separate_file&quot; value=&quot;true&quot; /&gt;         &lt;param key=&quot;sort_column&quot; value=&quot;Key&quot; /&gt;   Changing the overview.xml to use &quot;#1&quot; seems to work. Fix checked in.	
278366	normal	FIXED	Andreas Buchen	hiroyuki.inaba	1243551720000	1243553880000		There is a part where the number of bytes is not displayed.	There is a part where the number of bytes is not displayed. Created <span class=""><a href="attachment.cgi?id=137623" name="attach_137623" title="screenshot.png">attachment 137623</a> <a href="attachment.cgi?id=137623&amp;action=edit" title="screenshot.png">[details]</a></span> screenshot.png good spotting :-) fixed it with cl 327 Confirmed the fixed source on the SVN repository.  Thanks.  Bug Closed. Thank you!	
278367	normal	FIXED	Andreas Buchen	hiroyuki.inaba	1243551960000	1264709460000		The archive file doesn't become an English name.	When international language (ja_jp) is displayed, The archive file doesn't become an English name. Created <span class=""><a href="attachment.cgi?id=137625" name="attach_137625" title="screenshot.png">attachment 137625</a> <a href="attachment.cgi?id=137625&amp;action=edit" title="screenshot.png">[details]</a></span> screenshot.png  Archive file list made by English display, and Archive file list made by Japanese display Right now, the ZIP file name consists of (a) the common prefix of the heap dump file (&quot;eclipse&quot; in your case) and (b) the readable heading of the report (in your case the Japanese).  What would be the expected behavior? The file name remains fully English? Everything translated is difficult because we can make some assumptions based on the common prefix. I think that file name should not depend on the display language.  The file name should always be made an English name.   The Developers (American, Japanese, etc) cannot share the file analyzed to depend on the display language.  The ZIP file of a content the same in each display language will be made.  Understood.  The ZIP file contains only static HTML pages - the intention was to have something distributable via email independent form the (possibly) huge heap dump. One can open the file with any browser - no MAT installation required.  Right now, the static HTML will be generated with the language of the current user. Therefore sharing across languages is a problem. One would need to re-run the report in his own language. Making the static pages &quot;translate&quot; themselves feels like a very heavy solution. I understood that this was a specification. I demand to be going to be improved in the future.  Created <span class=""><a href="attachment.cgi?id=141099&amp;action=diff" name="attach_141099" title="Tag generated HTML with the character encoding">attachment 141099</a> <a href="attachment.cgi?id=141099&amp;action=edit" title="Tag generated HTML with the character encoding">[details]</a></span> Tag generated HTML with the character encoding  The file name is based on the internationalized report name and is converted by FileUtils.toFilename(). This takes the prefix and 20 characters of the name, replacing characters which are not letters or digits by underscore.  If the name is not translated then we would need to get a fixed name from somewhere. I was also suggest appending the language identifier from the message files used. heapdump123456.1244656860_Leak_Suspects.zip if messages.properties was used, or heapdump123456.1244656860_Leak_Suspects_fr.zip if messages_fr.properties was used, or heapdump123456.1244656860_Leak_Suspects_en_GB.zip if messages_en_GB.properties was used.  We should also put the encoding into the HTML. &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;&gt; or the native file.encoding.  I've got a patch for that.  Perhaps we should also use the HTML lang tag.  &lt;html lang=&quot;en-GB&quot;&gt; (In reply to <a href="show_bug.cgi?id=278367#c6">comment #6</a>) <span class="quote">&gt; We should also put the encoding into the HTML. &gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;&gt; &gt; or the native file.encoding.</span >  Totally agree to adding the encoding. I am not sure a/b which encoding to use: When saving a String value into a text file from the UI, I take System.getProperty(&quot;file.encoding&quot;). So I am okay with that.  <span class="quote">&gt; If the name is not translated then we would need to get a fixed name from &gt; somewhere.</span >  Can we use the &quot;id&quot; property of the report? We could improve on the names, but the id is not translated.  &lt;report id=&quot;suspects&quot; name=&quot;%report.suspects.name&quot;     description=&quot;%report.suspects.help&quot;     file=&quot;META-INF/reports/suspects.xml&quot; /&gt;    <span class="quote">&gt; I was also suggest appending the language identifier from the &gt; message files used.</span >  +1 TestSuite.java:  output = new File(output, prefix + &quot;_&quot; + FileUtils.toFilename(template.getName(), &quot;zip&quot;)); //$NON-NLS-1$ //$NON-NLS-2$  template is a Spec  It's quite hard to get a non-translated name at this point - the Spec doesn't have it, and is generated from lots of places including:  &lt;section name=&quot;%overview.title&quot;&gt;     &lt;param key=&quot;html.collapsed&quot; value=&quot;false&quot; /&gt;      &lt;query name=&quot;%overview.heap_dump_overview&quot;&gt;         &lt;param key=&quot;html.show_table_header&quot; value=&quot;false&quot; /&gt;         &lt;command&gt;heap_dump_overview&lt;/command&gt;     &lt;/query&gt;  # reports overview.title = System Overview  so this might need API changes Created <span class=""><a href="attachment.cgi?id=156949&amp;action=diff" name="attach_156949" title="Allow file suffix to be specified in report xml">attachment 156949</a> <a href="attachment.cgi?id=156949&amp;action=edit" title="Allow file suffix to be specified in report xml">[details]</a></span> Allow file suffix to be specified in report xml  Here's a way to solve the problem - we add a param to the report XML, then retrieve that param to build the file name.  I'm not sure if the suffix needs to go through the FileUtil processing to convert spaces to underscore - is that a platform specific encoding?  Also, should TestSuite attempt to get the base name of the dump - or should we get the prefix from the SnapshotInfo? I've checked in some fixes for this.  The reports now take the suffix from the filename_suffix param     &lt;param key=&quot;filename_suffix&quot; value=&quot;%overview.suffix&quot; /&gt;  This is translatable, if required, separately from the report title.  overview.suffix = System Overview  If the user spoke no English, and MAT was fully translated, then the user would need the report suffix translated to find the report from the Open Report dialog. To reduce clutter I've changed the file dialogs to expect reports with an underscore as there is always an underscore between the root and the suffix.  I therefore think it is worth having the capability to translate the file  suffix, but with this fix the plugin.xml file can be adjusted to suit. The report file name is now separately translatable from the report name.	
279527	major	FIXED	Dummy Inbox	andrew_johnson	1244453100000	1244531940000		AIX build cannot render charts in batch mode	On AIX 64-bit (which doesn't have SWT) I used to be able to render charts by running MAT in batch mode.  I've noticed that more recent builds (in the past month or so?) fail. The charts do not appear, but the rest of the reports do.  E.g. MemoryAnalyzer-Incubation-0.8.0.20090604-aix.motif.ppc.zip Run using batch mode as in the MAT wiki page.  Looking at ChartBuilder.java, is JFaceResources safe to use in non-SWT mode?  [Jun 8, 2009 9:48:44 PM org.eclipse.mat.impl.chart.HtmlPieChartRenderer handleEr ror SEVERE: Error rendering chart: java.lang.NoClassDefFoundError: org.eclipse.swt.g raphics.Device java.lang.NoClassDefFoundError: org.eclipse.swt.graphics.Device         at java.lang.J9VMInternals.verifyImpl(Native Method)         at java.lang.J9VMInternals.verify(J9VMInternals.java:63)         at java.lang.J9VMInternals.initialize(J9VMInternals.java:124)         at org.eclipse.mat.impl.chart.ChartBuilder.create(ChartBuilder.java:83)         at org.eclipse.mat.impl.chart.HtmlPieChartRenderer.embedd(HtmlPieChartRe nderer.java:46)         at org.eclipse.mat.report.internal.ResultRenderer.doProcess(ResultRender er.java:295)         at org.eclipse.mat.report.internal.ResultRenderer.process(ResultRenderer .java:233)         at org.eclipse.mat.report.internal.QueryPart.execute(QueryPart.java:160)         at org.eclipse.mat.report.internal.SectionPart.execute(SectionPart.java:53)                                                                                a t org.eclipse.mat.report.internal.QueryPart.execute(QueryPart.java:123)        a t org.eclipse.mat.report.internal.SectionPart.execute(SectionPart.java:53)                                                                                a t org.eclipse.mat.report.internal.SectionPart.execute(SectionPart.java:53)                                                                                a t org.eclipse.mat.report.TestSuite.execute(TestSuite.java:127)         at org.eclipse.mat.internal.apps.ParseSnapshotApp.runReport(ParseSnapsho tApp.java:139)         at org.eclipse.mat.internal.apps.ParseSnapshotApp.parse(ParseSnapshotApp .java:11at org.eclipse.mat.internal.apps.ParseSnapshotApp.start(ParseSnapshotApp .java:95at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandl e.java:1at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runAppli cation(Eat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(Ec lipseAppat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.ja va:368) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.ja va:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl. java:64)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces sorImpl.at java.lang.reflect.Method.invoke(Method.java:615)         at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)         at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)         at org.eclipse.equinox.launcher.Main.run(Main.java:1311)         at org.eclipse.equinox.launcher.Main.main(Main.java:1287) Created <span class=""><a href="attachment.cgi?id=138662&amp;action=diff" name="attach_138662" title="Don't set font in batch mode">attachment 138662</a> <a href="attachment.cgi?id=138662&amp;action=edit" title="Don't set font in batch mode">[details]</a></span> Don't set font in batch mode  This avoids setting calling JFace in batch mode by not getting the default font.  This stops an error on AIX. Patch approved by Andreas Buchen and committed.	
280473	critical	FIXED	Dummy Inbox	andrew_johnson	1245125460000	1245181140000		Plug-in "org.eclipse.mat.dtfj" was unable to instantiate class	After installing MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86.zip  and installing the DTFJ dtfj-updatesite.zip available from IBM developerWorks I get the following errors.  The problem goes away if I start MAT with MemoryAnalyzer -clean  The problem didn't occur with the 20090604 build.  I've reproduced the problem on two different machines and for me it happens each time MAT is installed. Once it works once then it is fine.  The configuration page shows that DTFJ is resolved but not active. Perhaps the org.eclipse.mat.dtfj MANIFEST.MF resolution:=optional has changed things. com.ibm.dtfj.api;bundle-version=&quot;1.3.0&quot;;resolution:=optional  org.eclipse.core.runtime.CoreException: Plug-in &quot;org.eclipse.mat.dtfj&quot; was unable to instantiate class &quot;org.eclipse.mat.dtfj.DTFJHeapObjectReader&quot;.          at org.eclipse.core.internal.registry.osgi.RegistryStrategyOSGI.throwException(RegistryStrategyOSGI.java:180)          at org.eclipse.core.internal.registry.osgi.RegistryStrategyOSGI.createExecutableExtension(RegistryStrategyOSGI.java:174)          at org.eclipse.core.internal.registry.ExtensionRegistry.createExecutableExtension(ExtensionRegistry.java:874)          at org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:243)          at org.eclipse.core.internal.registry.ConfigurationElementHandle.createExecutableExtension(ConfigurationElementHandle.java:51)          at org.eclipse.mat.parser.internal.util.ParserRegistry$Parser.create(ParserRegistry.java:72)          at org.eclipse.mat.parser.internal.SnapshotImpl.readFromFile(SnapshotImpl.java:108)          at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:87)          at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:114)          at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:94)          at org.eclipse.mat.ui.snapshot.ParseHeapDumpJob.run(ParseHeapDumpJob.java:54)          at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)  Caused by: java.lang.NoClassDefFoundError: com/ibm/dtfj/image/MemoryAccessException          at java.lang.Class.getDeclaredConstructors0(Native Method)          at java.lang.Class.privateGetDeclaredConstructors(Unknown Source)          at java.lang.Class.getConstructor0(Unknown Source)          at java.lang.Class.newInstance0(Unknown Source)          at java.lang.Class.newInstance(Unknown Source)          at org.eclipse.core.internal.registry.osgi.RegistryStrategyOSGI.createExecutableExtension(RegistryStrategyOSGI.java:170)          ... 10 more  Caused by: java.lang.ClassNotFoundException: com.ibm.dtfj.image.MemoryAccessException          at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:489)          at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:405)          at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:393)          at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:105)          at java.lang.ClassLoader.loadClass(Unknown Source)          at java.lang.ClassLoader.loadClassInternal(Unknown Source)          ... 16 more    *** Date: Tuesday, 16 June 2009 17:10:24 United Kingdom Time  *** Platform Details:  *** System properties: awt.toolkit=sun.awt.windows.WToolkit eclipse.commands=-os win32 -ws win32 -arch x86 -showsplash -launcher C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat\MemoryAnalyzer.exe -name MemoryAnalyzer --launcher.library C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat\plugins\org.eclipse.equinox.launcher.win32.win32.x86_1.0.200.v20090519\eclipse_1206.dll -startup C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat\plugins\org.eclipse.equinox.launcher_1.0.200.v20090520.jar -vm C:\Program Files\Java\jre6\bin\client\jvm.dll eclipse.home.location=file:/C:/m5/MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86/mat/ eclipse.launcher=C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat\MemoryAnalyzer.exe eclipse.product=org.eclipse.mat.ui.rcp.MemoryAnalyzer eclipse.startTime=1245168295781 eclipse.vm=C:\Program Files\Java\jre6\bin\client\jvm.dll eclipse.vmargs=-Xmx1024m -Djava.class.path=C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat\plugins\org.eclipse.equinox.launcher_1.0.200.v20090520.jar file.encoding=Cp1252 file.encoding.pkg=sun.io file.separator=\ java.awt.graphicsenv=sun.awt.Win32GraphicsEnvironment java.awt.printerjob=sun.awt.windows.WPrinterJob java.class.path=C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat\plugins\org.eclipse.equinox.launcher_1.0.200.v20090520.jar java.class.version=50.0 java.endorsed.dirs=C:\Program Files\Java\jre6\lib\endorsed java.ext.dirs=C:\Program Files\Java\jre6\lib\ext;C:\WINDOWS\Sun\Java\lib\ext java.home=C:\Program Files\Java\jre6 java.io.tmpdir=C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\ java.library.path=C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat;.;C:\WINDOWS\Sun\Java\bin;C:\WINDOWS\system32;C:\WINDOWS;C:/Program Files/Java/jre6/bin/client;C:/Program Files/Java/jre6/bin;C:\Program Files\RSA SecurID Token Common;C:\Program Files\ThinkPad\Utilities;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\Program Files\IBM\Infoprint Select;C:\Notes;C:\Program Files\XLView;C:\lotus\compnent;C:\Utilities;C:\Program Files\IBM\Personal Communications\;C:\Program Files\IBM\Trace Facility\;C:\Program Files\ThinkPad\ConnectUtilities;C:\WINDOWS\Downloaded Program Files;C:\Program Files\ObjREXX;C:\Program Files\ObjREXX\OODIALOG;C:\Program Files\ATI Technologies\ATI.ACE\Core-Static;C:\Program Files\Common Files\Lenovo;C:\Program Files\QuickTime\QTSystem\;C:\Program Files\IBM\CMVCDC50 java.runtime.name=Java(TM) SE Runtime Environment java.runtime.version=1.6.0_10-b33 java.specification.name=Java Platform API Specification java.specification.vendor=Sun Microsystems Inc. java.specification.version=1.6 java.vendor=Sun Microsystems Inc. java.vendor.url=<a href="http://java.sun.com/">http://java.sun.com/</a> java.vendor.url.bug=<a href="http://java.sun.com/cgi-bin/bugreport.cgi">http://java.sun.com/cgi-bin/bugreport.cgi</a> java.version=1.6.0_10 java.vm.info=mixed mode java.vm.name=Java HotSpot(TM) Client VM java.vm.specification.name=Java Virtual Machine Specification java.vm.specification.vendor=Sun Microsystems Inc. java.vm.specification.version=1.0 java.vm.vendor=Sun Microsystems Inc. java.vm.version=11.0-b15 line.separator=  org.osgi.framework.executionenvironment=OSGi/Minimum-1.0,OSGi/Minimum-1.1,OSGi/Minimum-1.2,JRE-1.1,J2SE-1.2,J2SE-1.3,J2SE-1.4,J2SE-1.5,JavaSE-1.6 org.osgi.framework.language=en org.osgi.framework.os.name=WindowsXP org.osgi.framework.os.version=5.1.0 org.osgi.framework.processor=x86 org.osgi.framework.system.packages=javax.accessibility,javax.activation,javax.activity,javax.annotation,javax.annotation.processing,javax.crypto,javax.crypto.interfaces,javax.crypto.spec,javax.imageio,javax.imageio.event,javax.imageio.metadata,javax.imageio.plugins.bmp,javax.imageio.plugins.jpeg,javax.imageio.spi,javax.imageio.stream,javax.jws,javax.jws.soap,javax.lang.model,javax.lang.model.element,javax.lang.model.type,javax.lang.model.util,javax.management,javax.management.loading,javax.management.modelmbean,javax.management.monitor,javax.management.openmbean,javax.management.relation,javax.management.remote,javax.management.remote.rmi,javax.management.timer,javax.naming,javax.naming.directory,javax.naming.event,javax.naming.ldap,javax.naming.spi,javax.net,javax.net.ssl,javax.print,javax.print.attribute,javax.print.attribute.standard,javax.print.event,javax.rmi,javax.rmi.CORBA,javax.rmi.ssl,javax.script,javax.security.auth,javax.security.auth.callback,javax.security.auth.kerberos,javax.security.auth.login,javax.security.auth.spi,javax.security.auth.x500,javax.security.cert,javax.security.sasl,javax.sound.midi,javax.sound.midi.spi,javax.sound.sampled,javax.sound.sampled.spi,javax.sql,javax.sql.rowset,javax.sql.rowset.serial,javax.sql.rowset.spi,javax.swing,javax.swing.border,javax.swing.colorchooser,javax.swing.event,javax.swing.filechooser,javax.swing.plaf,javax.swing.plaf.basic,javax.swing.plaf.metal,javax.swing.plaf.multi,javax.swing.plaf.synth,javax.swing.table,javax.swing.text,javax.swing.text.html,javax.swing.text.html.parser,javax.swing.text.rtf,javax.swing.tree,javax.swing.undo,javax.tools,javax.transaction,javax.transaction.xa,javax.xml,javax.xml.bind,javax.xml.bind.annotation,javax.xml.bind.annotation.adapters,javax.xml.bind.attachment,javax.xml.bind.helpers,javax.xml.bind.util,javax.xml.crypto,javax.xml.crypto.dom,javax.xml.crypto.dsig,javax.xml.crypto.dsig.dom,javax.xml.crypto.dsig.keyinfo,javax.xml.crypto.dsig.spec,javax.xml.datatype,javax.xml.namespace,javax.xml.parsers,javax.xml.soap,javax.xml.stream,javax.xml.stream.events,javax.xml.stream.util,javax.xml.transform,javax.xml.transform.dom,javax.xml.transform.sax,javax.xml.transform.stax,javax.xml.transform.stream,javax.xml.validation,javax.xml.ws,javax.xml.ws.handler,javax.xml.ws.handler.soap,javax.xml.ws.http,javax.xml.ws.soap,javax.xml.ws.spi,javax.xml.ws.wsaddressing,javax.xml.xpath,org.ietf.jgss,org.omg.CORBA,org.omg.CORBA_2_3,org.omg.CORBA_2_3.portable,org.omg.CORBA.DynAnyPackage,org.omg.CORBA.ORBPackage,org.omg.CORBA.portable,org.omg.CORBA.TypeCodePackage,org.omg.CosNaming,org.omg.CosNaming.NamingContextExtPackage,org.omg.CosNaming.NamingContextPackage,org.omg.Dynamic,org.omg.DynamicAny,org.omg.DynamicAny.DynAnyFactoryPackage,org.omg.DynamicAny.DynAnyPackage,org.omg.IOP,org.omg.IOP.CodecFactoryPackage,org.omg.IOP.CodecPackage,org.omg.Messaging,org.omg.PortableInterceptor,org.omg.PortableInterceptor.ORBInitInfoPackage,org.omg.PortableServer,org.omg.PortableServer.CurrentPackage,org.omg.PortableServer.POAManagerPackage,org.omg.PortableServer.POAPackage,org.omg.PortableServer.portable,org.omg.PortableServer.ServantLocatorPackage,org.omg.SendingContext,org.omg.stub.java.rmi,org.w3c.dom,org.w3c.dom.bootstrap,org.w3c.dom.css,org.w3c.dom.events,org.w3c.dom.html,org.w3c.dom.ls,org.w3c.dom.ranges,org.w3c.dom.stylesheets,org.w3c.dom.traversal,org.w3c.dom.views,org.w3c.dom.xpath,org.xml.sax,org.xml.sax.ext,org.xml.sax.helpers org.osgi.framework.vendor=Eclipse org.osgi.framework.version=1.5.0 org.osgi.supports.framework.extension=true org.osgi.supports.framework.fragment=true org.osgi.supports.framework.requirebundle=true os.arch=x86 os.name=Windows XP os.version=5.1 osgi.arch=x86 osgi.bundles=org.eclipse.equinox.common&#64;2:start,org.eclipse.update.configurator&#64;3:start,org.eclipse.core.runtime&#64;start osgi.bundles.defaultStartLevel=4 osgi.bundlestore=C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat\configuration\org.eclipse.osgi\bundles osgi.configuration.area=file:/C:/m5/MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86/mat/configuration/ osgi.framework=file:/c:/m5/MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86/mat/plugins/org.eclipse.osgi_3.5.0.v20090520.jar osgi.framework.shape=jar osgi.framework.version=3.5.0.v20090520 osgi.install.area=file:/C:/m5/MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86/mat/ osgi.instance.area=file:/C:/m5/MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86/mat/workspace/ osgi.logfile=C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat\workspace\.metadata\.log osgi.manifest.cache=C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat\configuration\org.eclipse.osgi\manifests osgi.nl=en_GB osgi.os=win32 osgi.splashPath=platform:/base/plugins/org.eclipse.mat.ui.rcp osgi.syspath=c:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat\plugins osgi.tracefile=C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat\workspace\.metadata\trace.log osgi.ws=win32 path.separator=; sun.arch.data.model=32 sun.boot.class.path=C:\Program Files\Java\jre6\lib\resources.jar;C:\Program Files\Java\jre6\lib\rt.jar;C:\Program Files\Java\jre6\lib\sunrsasign.jar;C:\Program Files\Java\jre6\lib\jsse.jar;C:\Program Files\Java\jre6\lib\jce.jar;C:\Program Files\Java\jre6\lib\charsets.jar;C:\Program Files\Java\jre6\classes sun.boot.library.path=C:\Program Files\Java\jre6\bin sun.cpu.endian=little sun.cpu.isalist=pentium_pro+mmx pentium_pro pentium+mmx pentium i486 i386 i86 sun.desktop=windows sun.io.unicode.encoding=UnicodeLittle sun.jnu.encoding=Cp1252 sun.management.compiler=HotSpot Client Compiler sun.os.patch.level=Service Pack 2 user.country=GB user.dir=C:\m5\MemoryAnalyzer-Incubation-0.8.0.20090615-win32.win32.x86\mat user.home=C:\Documents and Settings\Administrator user.language=en user.name=ajohnson user.timezone=Europe/London user.variant=  *** Features: com.ibm.dtfj.feature (1.3.0.200903241644) &quot;DTFJ Common documentation&quot;  *** Plug-in Registry: com.ibm.dtfj.api (1.3.0.200903241644) &quot;DTFJ API Plug-in&quot; [Resolved] com.ibm.dtfj.j9.impl (1.3.0.200903241644) &quot;DTFJ J9 Implementation&quot; [Resolved] com.ibm.dtfj.phd (1.3.0.200903241644) &quot;DTFJ Portable Heap Dump reader&quot; [Resolved] com.ibm.dtfj.sov.impl (1.3.0.200903241644) &quot;DTFJ Sovereign Implementation Plug-in&quot; [Resolved] com.ibm.icu (4.0.1.v20090415) &quot;International Components for Unicode for Java (ICU4J)&quot; [Active] com.ibm.java.doc.tools.dtfj (1.3.0.200903241644) &quot;DTFJ Common documentation&quot; [Resolved] javax.servlet (2.5.0.v200806031605) &quot;Servlet API Bundle&quot; [Resolved] javax.servlet.jsp (2.0.0.v200806031607) &quot;Java Server Pages API Bundle&quot; [Resolved] org.apache.ant (1.7.1.v20090120-1145) &quot;Apache Ant&quot; [Resolved] org.apache.commons.codec (1.3.0.v20080530-1600) &quot;Apache Commons Codec Plug-in&quot; [Resolved] org.apache.commons.el (1.0.0.v200806031608) &quot;Apache Commons JSP 2.0 Expression Language Interpreter&quot; [Resolved] org.apache.commons.logging (1.0.4.v200904062259) &quot;Apache Commons Logging Plug-in&quot; [Resolved] org.apache.jasper (5.5.17.v200903231320) &quot;Apache Jasper 2 Plug-in&quot; [Resolved] org.apache.lucene (1.9.1.v20080530-1600) &quot;Apache Lucene&quot; [Resolved] org.apache.lucene.analysis (1.9.1.v20080530-1600) &quot;Apache Lucene Analysis&quot; [Resolved] org.eclipse.ant.core (3.2.100.v20090520) &quot;Ant Build Tool Core&quot; [Starting] org.eclipse.birt.chart.device.extension (2.5.0.v20090514) &quot;BIRT Chart Device Extension(s)&quot; [Starting] org.eclipse.birt.chart.device.swt (2.5.0.v20090514) &quot;BIRT Chart Device SWT Extension&quot; [Starting] org.eclipse.birt.chart.engine (2.5.0.v20090604) &quot;BIRT Chart Engine&quot; [Starting] org.eclipse.birt.chart.engine.extension (2.5.0.v20090527) &quot;BIRT Chart Engine Extension&quot; [Starting] org.eclipse.birt.core (2.5.0.v20090601) &quot;BIRT Core Package&quot; [Starting] org.eclipse.compare.core (3.5.0.I20090430-0408) &quot;Core Compare Support&quot; [Starting] org.eclipse.core.commands (3.5.0.I20090525-2000) &quot;Commands&quot; [Resolved] org.eclipse.core.contenttype (3.4.0.v20090429-1800) &quot;Eclipse Content Mechanism&quot; [Active] org.eclipse.core.databinding (1.2.0.I20090604-2000) &quot;JFace Data Binding&quot; [Starting] org.eclipse.core.databinding.observable (1.2.0.I20090604-2000) &quot;JFace Data Binding Observables&quot; [Active] org.eclipse.core.databinding.property (1.2.0.I20090526-2000) &quot;JFace Data Binding&quot; [Starting] org.eclipse.core.expressions (3.4.100.v20090429-1800) &quot;Expression Language&quot; [Active] org.eclipse.core.filebuffers (3.5.0.v20090526-2000) &quot;File Buffers&quot; [Starting] org.eclipse.core.filesystem (1.2.0.v20090507) &quot;Core File Systems&quot; [Active] org.eclipse.core.filesystem.win32.x86 (1.1.0.v20080604-1400) &quot;Core File System for Windows&quot; [Resolved] org.eclipse.core.jobs (3.4.100.v20090429-1800) &quot;Eclipse Jobs Mechanism&quot; [Active] org.eclipse.core.net (1.2.0.I20090522-1010) &quot;Internet Connection Management&quot; [Starting] org.eclipse.core.net.win32.x86 (1.0.0.I20080909) &quot;Proxy for Windows&quot; [Resolved] org.eclipse.core.resources (3.5.0.v20090512) &quot;Core Resource Management&quot; [Active] org.eclipse.core.resources.compatibility (3.4.0.v20090505) &quot;Core Resource Management Compatibility Fragment&quot; [Resolved] org.eclipse.core.resources.win32.x86 (3.5.0.v20081020) &quot;Core Resource Management Win32 Fragment&quot; [Resolved] org.eclipse.core.runtime (3.5.0.v20090525) &quot;Core Runtime&quot; [Active] org.eclipse.core.runtime.compatibility.auth (3.2.100.v20090413) &quot;Authorization Compatibility Plug-in&quot; [Active] org.eclipse.core.runtime.compatibility.registry (3.2.200.v20090429-1800) &quot;Eclipse Registry Compatibility Fragment&quot; [Resolved] org.eclipse.core.variables (3.2.200.v20090521) &quot;Core Variables&quot; [Starting] org.eclipse.ecf (3.0.0.v20090604-1131) &quot;Eclipse Communication Framework (ECF)&quot; [Starting] org.eclipse.ecf.filetransfer (3.0.0.v20090604-1131) &quot;ECF Filetransfer API&quot; [Starting] org.eclipse.ecf.identity (3.0.0.v20090604-1131) &quot;ECF Identity API&quot; [Starting] org.eclipse.ecf.ssl (1.0.0.v20090604-1131) &quot;Eclipse Communication Framework (ECF)&quot; [Resolved] org.eclipse.emf.common (2.5.0.v200906080927) &quot;EMF Common&quot; [Starting] org.eclipse.emf.ecore (2.5.0.v200906080927) &quot;EMF Ecore&quot; [Starting] org.eclipse.emf.ecore.xmi (2.5.0.v200906080927) &quot;EMF XML/XMI Persistence&quot; [Starting] org.eclipse.equinox.app (1.2.0.v20090520-1800) &quot;Equinox Application Container&quot; [Active] org.eclipse.equinox.common (3.5.0.v20090520-1800) &quot;Common Eclipse Runtime&quot; [Active] org.eclipse.equinox.concurrent (1.0.0.v20090520-1800) &quot;Equinox Concurrent API&quot; [Starting] org.eclipse.equinox.http.jetty (2.0.0.v20090520-1800) &quot;Jetty Http Service&quot; [Starting] org.eclipse.equinox.http.registry (1.0.200.v20090520-1800) &quot;Http Service Registry Extensions&quot; [Resolved] org.eclipse.equinox.http.servlet (1.0.200.v20090520-1800) &quot;Http Services Servlet&quot; [Starting] org.eclipse.equinox.jsp.jasper (1.0.200.v20090520-1800) &quot;Jasper Jsp Support Bundle&quot; [Starting] org.eclipse.equinox.jsp.jasper.registry (1.0.100.v20090520-1800) &quot;Jasper Jsp Registry Support Plug-in&quot; [Starting] org.eclipse.equinox.launcher (1.0.200.v20090520) &quot;Equinox Launcher&quot; [Resolved] org.eclipse.equinox.launcher.win32.win32.x86 (1.0.200.v20090519) &quot;Equinox Launcher Win32 X86 Fragment&quot; [Resolved] org.eclipse.equinox.p2.artifact.repository (1.0.100.v20090527-1812) &quot;Equinox Provisioning Artifact Repository Support&quot; [Starting] org.eclipse.equinox.p2.core (1.0.100.v20090520-1905) &quot;Equinox Provisioning Core&quot; [Active] org.eclipse.equinox.p2.engine (1.0.100.v20090525) &quot;Equinox Provisioning Engine&quot; [Active] org.eclipse.equinox.p2.jarprocessor (1.0.100.v20090520-1905) &quot;Equinox Provisioning JAR Processor&quot; [Resolved] org.eclipse.equinox.p2.metadata (1.0.100.v20090525) &quot;Equinox Provisioning Metadata&quot; [Starting] org.eclipse.equinox.p2.metadata.repository (1.0.100.v20090525) &quot;Equinox Provisioning Metadata Repository&quot; [Starting] org.eclipse.equinox.p2.repository (1.0.0.v20090601-1921) &quot;Equinox Provisioning Repository&quot; [Starting] org.eclipse.equinox.preferences (3.2.300.v20090520-1800) &quot;Eclipse Preferences Mechanism&quot; [Active] org.eclipse.equinox.registry (3.4.100.v20090520-1800) &quot;Extension Registry Support&quot; [Active] org.eclipse.equinox.security (1.0.100.v20090520-1800) &quot;Equinox Java Authentication and Authorization Service (JAAS)&quot; [Starting] org.eclipse.equinox.security.win32.x86 (1.0.100.v20090520-1800) &quot;Windows Data Protection services integration&quot; [Resolved] org.eclipse.help (3.4.0.v20090526) &quot;Help System Core&quot; [Active] org.eclipse.help.appserver (3.1.400.v20090429_1800) &quot;Help Application Server&quot; [Starting] org.eclipse.help.base (3.4.0.v200906051444) &quot;Help System Base&quot; [Starting] org.eclipse.help.ui (3.4.0.v20090528) &quot;Help System UI&quot; [Starting] org.eclipse.help.webapp (3.4.0.v20090429_1800) &quot;Help System Webapp&quot; [Starting] org.eclipse.jface (3.5.0.I20090525-2000) &quot;JFace&quot; [Active] org.eclipse.jface.databinding (1.3.0.I20090525-2000) &quot;JFace Data Binding for SWT and JFace&quot; [Resolved] org.eclipse.jface.text (3.5.0.v20090602) &quot;JFace Text&quot; [Resolved] org.eclipse.mat.api (0.8.0.200906151352) &quot;Memory Analyzer API (Incubation)&quot; [Active] org.eclipse.mat.chart (0.8.0.200906151352) &quot;Memory Analyzer - Chart (Incubation)&quot; [Starting] org.eclipse.mat.chart.ui (0.8.0.200906151352) &quot;Memory Analyzer - Chart UI (Incubation)&quot; [Resolved] org.eclipse.mat.dtfj (0.8.0.200906151352) &quot;Memory Analyzer - DTFJ Adapter (Incubation)&quot; [Active] org.eclipse.mat.hprof (0.8.0.200906151352) &quot;Memory Analyzer - HPROF Adapter (Incubation)&quot; [Resolved] org.eclipse.mat.jdt (0.8.0.200906151352) &quot;Memory Analyzer Bridge: Eclipse SDK&quot; [Installed] org.eclipse.mat.parser (0.8.0.200906151352) &quot;Memory Analyzer - Parser (Incubation)&quot; [Active] org.eclipse.mat.report (0.8.0.200906151352) &quot;Memory Analyzer HTML Reporting (Incubation)&quot; [Active] org.eclipse.mat.ui (0.8.0.200906151352) &quot;Memory Analyzer UI (Incubation)&quot; [Active] org.eclipse.mat.ui.help (0.8.0.200906151352) &quot;Memory Analyzer Help (Incubation)&quot; [Resolved] org.eclipse.mat.ui.rcp (0.8.0.200906151352) &quot;Memory Analyzer RCP (Incubation)&quot; [Active] org.eclipse.osgi (3.5.0.v20090520) &quot;OSGi System Bundle&quot; [Active] org.eclipse.osgi.services (3.2.0.v20090520-1800) &quot;OSGi Release 4.2.0 Services&quot; [Resolved] org.eclipse.platform (3.3.200.v200906051444) &quot;Eclipse Platform&quot; [Resolved] org.eclipse.swt (3.5.0.v3550a) &quot;Standard Widget Toolkit&quot; [Resolved] org.eclipse.swt.win32.win32.x86 (3.5.0.v3550a) &quot;Standard Widget Toolkit for Windows&quot; [Resolved] org.eclipse.text (3.5.0.v20090513-2000) &quot;Text&quot; [Resolved] org.eclipse.ui (3.5.0.I20090604-2000) &quot;Eclipse UI&quot; [Active] org.eclipse.ui.cheatsheets (3.3.200.v20090526) &quot;Cheat Sheets&quot; [Starting] org.eclipse.ui.console (3.4.0.v20090513) &quot;Console&quot; [Starting] org.eclipse.ui.editors (3.5.0.v20090527-2000) &quot;Default Text Editor&quot; [Starting] org.eclipse.ui.forms (3.4.0.v20090526) &quot;Eclipse Forms&quot; [Active] org.eclipse.ui.ide (3.5.0.I20090525-2000) &quot;Eclipse IDE UI&quot; [Active] org.eclipse.ui.ide.application (1.0.100.I20090525-2000) &quot;Eclipse IDE UI Application&quot; [Resolved] org.eclipse.ui.intro (3.3.0.v20090526) &quot;Welcome Framework&quot; [Active] org.eclipse.ui.intro.universal (3.2.300.v20090526) &quot;Universal Welcome&quot; [Starting] org.eclipse.ui.navigator (3.4.0.I20090525-2000) &quot;Common Navigator View&quot; [Starting] org.eclipse.ui.navigator.resources (3.4.0.I20090525-2000) &quot;Navigator Workbench Components&quot; [Starting] org.eclipse.ui.net (1.2.0.I20090430-0408) &quot;Internet Connection Management UI&quot; [Starting] org.eclipse.ui.views (3.4.0.I20090525-2000) &quot;Views&quot; [Active] org.eclipse.ui.views.log (1.0.100.v20090527) &quot;Log View&quot; [Active] org.eclipse.ui.views.properties.tabbed (3.5.0.I20090429-1800) &quot;Tabbed Properties View&quot; [Starting] org.eclipse.ui.win32 (3.2.100.v20090429-1800) &quot;Eclipse UI Win32 Enhancements&quot; [Resolved] org.eclipse.ui.workbench (3.5.0.I20090603-2000) &quot;Workbench&quot; [Active] org.eclipse.ui.workbench.texteditor (3.5.0.v20090603) &quot;Text Editor Framework&quot; [Active] org.eclipse.update.configurator (3.3.0.v20090312) &quot;Install/Update Configurator&quot; [Active] org.eclipse.update.core (3.2.300.v20090525) &quot;Install/Update Core&quot; [Starting] org.eclipse.update.core.win32 (3.2.100.v20080107) &quot;Install/Update Core for Windows&quot; [Resolved] org.eclipse.update.ui (3.2.200.v20090213) &quot;Install/Update UI&quot; [Starting] org.hamcrest.core (1.1.0.v20090501071000) &quot;Hamcrest Core Library of Matchers&quot; [Starting] org.junit4 (4.5.0.v20090423) &quot;JUnit Testing Framework Version 4&quot; [Resolved] org.mortbay.jetty.server (6.1.15.v200905151201) &quot;Jetty Server&quot; [Resolved] org.mortbay.jetty.util (6.1.15.v200905182336) &quot;Jetty Utilities&quot; [Resolved] org.mozilla.rhino (1.7.1.v20090608) &quot;Mozilla Rhino&quot; [Resolved]  *** User Preferences: #Tue Jun 16 17:10:24 BST 2009 /instance/org.eclipse.ui.views.log/column4=150 /instance/org.eclipse.update.ui/ConfigurationView.showUnconf=true /instance/org.eclipse.ui.views.log/column3=150 \!/= /instance/org.eclipse.ui.views.log/column2=300 &#64;org.eclipse.mat.ui=0.8.0.200906151352 &#64;org.eclipse.update.ui=3.2.200.v20090213 /instance/org.eclipse.ui.views.log/groupBy=0 /instance/org.eclipse.core.resources/version=1 /instance/org.eclipse.mat.ui/org.eclipse.mat.ui.snapshot.OpenSnapshot.lastDir=C\:\\m5\\dumps &#64;org.eclipse.core.resources=3.5.0.v20090512 /instance/org.eclipse.ui.views.log/orderType=2 /instance/org.eclipse.ui.views.log/activate=true &#64;org.eclipse.ui.views.log=1.0.100.v20090527 /instance/org.eclipse.ui.views.log/show_filter_text=true /instance/org.eclipse.update.ui/ConfigurationView.showNestedFeatures=false /instance/org.eclipse.ui.views.log/orderValue=-1 /instance/org.eclipse.update.ui/ConfigurationView.showSites=false file_export_version=3.0  *** Current Install Configuration:  Bundles in the system:  Id: com.ibm.dtfj.api, Version: 1.3.0.200903241644, Location: update&#64;plugins/com.ibm.dtfj.api_1.3.0.200903241644.jar Id: com.ibm.dtfj.j9.impl, Version: 1.3.0.200903241644, Location: update&#64;plugins/com.ibm.dtfj.j9.impl_1.3.0.200903241644.jar Id: com.ibm.dtfj.phd, Version: 1.3.0.200903241644, Location: update&#64;plugins/com.ibm.dtfj.phd_1.3.0.200903241644.jar Id: com.ibm.dtfj.sov.impl, Version: 1.3.0.200903241644, Location: update&#64;plugins/com.ibm.dtfj.sov.impl_1.3.0.200903241644.jar Id: com.ibm.icu, Version: 4.0.1.v20090415, Location: update&#64;plugins/com.ibm.icu_4.0.1.v20090415.jar Id: com.ibm.java.doc.tools.dtfj, Version: 1.3.0.200903241644, Location: update&#64;plugins/com.ibm.java.doc.tools.dtfj_1.3.0.200903241644.jar Id: javax.servlet, Version: 2.5.0.v200806031605, Location: update&#64;plugins/javax.servlet_2.5.0.v200806031605.jar Id: javax.servlet.jsp, Version: 2.0.0.v200806031607, Location: update&#64;plugins/javax.servlet.jsp_2.0.0.v200806031607.jar Id: org.apache.ant, Version: 1.7.1.v20090120-1145, Location: update&#64;plugins/org.apache.ant_1.7.1.v20090120-1145/ Id: org.apache.commons.codec, Version: 1.3.0.v20080530-1600, Location: update&#64;plugins/org.apache.commons.codec_1.3.0.v20080530-1600.jar Id: org.apache.commons.el, Version: 1.0.0.v200806031608, Location: update&#64;plugins/org.apache.commons.el_1.0.0.v200806031608.jar Id: org.apache.commons.logging, Version: 1.0.4.v200904062259, Location: update&#64;plugins/org.apache.commons.logging_1.0.4.v200904062259.jar Id: org.apache.jasper, Version: 5.5.17.v200903231320, Location: update&#64;plugins/org.apache.jasper_5.5.17.v200903231320.jar Id: org.apache.lucene, Version: 1.9.1.v20080530-1600, Location: update&#64;plugins/org.apache.lucene_1.9.1.v20080530-1600.jar Id: org.apache.lucene.analysis, Version: 1.9.1.v20080530-1600, Location: update&#64;plugins/org.apache.lucene.analysis_1.9.1.v20080530-1600.jar Id: org.eclipse.ant.core, Version: 3.2.100.v20090520, Location: update&#64;plugins/org.eclipse.ant.core_3.2.100.v20090520.jar Id: org.eclipse.birt.chart.device.extension, Version: 2.5.0.v20090514, Location: update&#64;plugins/org.eclipse.birt.chart.device.extension_2.5.0.v20090514.jar Id: org.eclipse.birt.chart.device.swt, Version: 2.5.0.v20090514, Location: update&#64;plugins/org.eclipse.birt.chart.device.swt_2.5.0.v20090514.jar Id: org.eclipse.birt.chart.engine, Version: 2.5.0.v20090604, Location: update&#64;plugins/org.eclipse.birt.chart.engine_2.5.0.v20090604.jar Id: org.eclipse.birt.chart.engine.extension, Version: 2.5.0.v20090527, Location: update&#64;plugins/org.eclipse.birt.chart.engine.extension_2.5.0.v20090527.jar Id: org.eclipse.birt.core, Version: 2.5.0.v20090601, Location: update&#64;plugins/org.eclipse.birt.core_2.5.0.v20090601.jar Id: org.eclipse.compare.core, Version: 3.5.0.I20090430-0408, Location: update&#64;plugins/org.eclipse.compare.core_3.5.0.I20090430-0408.jar Id: org.eclipse.core.commands, Version: 3.5.0.I20090525-2000, Location: update&#64;plugins/org.eclipse.core.commands_3.5.0.I20090525-2000.jar Id: org.eclipse.core.contenttype, Version: 3.4.0.v20090429-1800, Location: update&#64;plugins/org.eclipse.core.contenttype_3.4.0.v20090429-1800.jar Id: org.eclipse.core.databinding, Version: 1.2.0.I20090604-2000, Location: update&#64;plugins/org.eclipse.core.databinding_1.2.0.I20090604-2000.jar Id: org.eclipse.core.databinding.observable, Version: 1.2.0.I20090604-2000, Location: update&#64;plugins/org.eclipse.core.databinding.observable_1.2.0.I20090604-2000.jar Id: org.eclipse.core.databinding.property, Version: 1.2.0.I20090526-2000, Location: update&#64;plugins/org.eclipse.core.databinding.property_1.2.0.I20090526-2000.jar Id: org.eclipse.core.expressions, Version: 3.4.100.v20090429-1800, Location: update&#64;plugins/org.eclipse.core.expressions_3.4.100.v20090429-1800.jar Id: org.eclipse.core.filebuffers, Version: 3.5.0.v20090526-2000, Location: update&#64;plugins/org.eclipse.core.filebuffers_3.5.0.v20090526-2000.jar Id: org.eclipse.core.filesystem, Version: 1.2.0.v20090507, Location: update&#64;plugins/org.eclipse.core.filesystem_1.2.0.v20090507.jar Id: org.eclipse.core.filesystem.win32.x86, Version: 1.1.0.v20080604-1400, Location: update&#64;plugins/org.eclipse.core.filesystem.win32.x86_1.1.0.v20080604-1400.jar Id: org.eclipse.core.jobs, Version: 3.4.100.v20090429-1800, Location: update&#64;plugins/org.eclipse.core.jobs_3.4.100.v20090429-1800.jar Id: org.eclipse.core.net, Version: 1.2.0.I20090522-1010, Location: update&#64;plugins/org.eclipse.core.net_1.2.0.I20090522-1010.jar Id: org.eclipse.core.net.win32.x86, Version: 1.0.0.I20080909, Location: update&#64;plugins/org.eclipse.core.net.win32.x86_1.0.0.I20080909.jar Id: org.eclipse.core.resources, Version: 3.5.0.v20090512, Location: update&#64;plugins/org.eclipse.core.resources_3.5.0.v20090512.jar Id: org.eclipse.core.resources.compatibility, Version: 3.4.0.v20090505, Location: update&#64;plugins/org.eclipse.core.resources.compatibility_3.4.0.v20090505.jar Id: org.eclipse.core.resources.win32.x86, Version: 3.5.0.v20081020, Location: update&#64;plugins/org.eclipse.core.resources.win32.x86_3.5.0.v20081020.jar Id: org.eclipse.core.runtime, Version: 3.5.0.v20090525, Location: initial&#64;reference:file:plugins/org.eclipse.core.runtime_3.5.0.v20090525.jar/ Id: org.eclipse.core.runtime.compatibility.auth, Version: 3.2.100.v20090413, Location: update&#64;plugins/org.eclipse.core.runtime.compatibility.auth_3.2.100.v20090413.jar Id: org.eclipse.core.runtime.compatibility.registry, Version: 3.2.200.v20090429-1800, Location: update&#64;plugins/org.eclipse.core.runtime.compatibility.registry_3.2.200.v20090429-1800/ Id: org.eclipse.core.variables, Version: 3.2.200.v20090521, Location: update&#64;plugins/org.eclipse.core.variables_3.2.200.v20090521.jar Id: org.eclipse.ecf, Version: 3.0.0.v20090604-1131, Location: update&#64;plugins/org.eclipse.ecf_3.0.0.v20090604-1131.jar Id: org.eclipse.ecf.filetransfer, Version: 3.0.0.v20090604-1131, Location: update&#64;plugins/org.eclipse.ecf.filetransfer_3.0.0.v20090604-1131.jar Id: org.eclipse.ecf.identity, Version: 3.0.0.v20090604-1131, Location: update&#64;plugins/org.eclipse.ecf.identity_3.0.0.v20090604-1131.jar Id: org.eclipse.ecf.ssl, Version: 1.0.0.v20090604-1131, Location: update&#64;plugins/org.eclipse.ecf.ssl_1.0.0.v20090604-1131.jar Id: org.eclipse.emf.common, Version: 2.5.0.v200906080927, Location: update&#64;plugins/org.eclipse.emf.common_2.5.0.v200906080927.jar Id: org.eclipse.emf.ecore, Version: 2.5.0.v200906080927, Location: update&#64;plugins/org.eclipse.emf.ecore_2.5.0.v200906080927.jar Id: org.eclipse.emf.ecore.xmi, Version: 2.5.0.v200906080927, Location: update&#64;plugins/org.eclipse.emf.ecore.xmi_2.5.0.v200906080927.jar Id: org.eclipse.equinox.app, Version: 1.2.0.v20090520-1800, Location: update&#64;plugins/org.eclipse.equinox.app_1.2.0.v20090520-1800.jar Id: org.eclipse.equinox.common, Version: 3.5.0.v20090520-1800, Location: initial&#64;reference:file:plugins/org.eclipse.equinox.common_3.5.0.v20090520-1800.jar/ Id: org.eclipse.equinox.concurrent, Version: 1.0.0.v20090520-1800, Location: update&#64;plugins/org.eclipse.equinox.concurrent_1.0.0.v20090520-1800.jar Id: org.eclipse.equinox.http.jetty, Version: 2.0.0.v20090520-1800, Location: update&#64;plugins/org.eclipse.equinox.http.jetty_2.0.0.v20090520-1800.jar Id: org.eclipse.equinox.http.registry, Version: 1.0.200.v20090520-1800, Location: update&#64;plugins/org.eclipse.equinox.http.registry_1.0.200.v20090520-1800.jar Id: org.eclipse.equinox.http.servlet, Version: 1.0.200.v20090520-1800, Location: update&#64;plugins/org.eclipse.equinox.http.servlet_1.0.200.v20090520-1800.jar Id: org.eclipse.equinox.jsp.jasper, Version: 1.0.200.v20090520-1800, Location: update&#64;plugins/org.eclipse.equinox.jsp.jasper_1.0.200.v20090520-1800.jar Id: org.eclipse.equinox.jsp.jasper.registry, Version: 1.0.100.v20090520-1800, Location: update&#64;plugins/org.eclipse.equinox.jsp.jasper.registry_1.0.100.v20090520-1800.jar Id: org.eclipse.equinox.launcher, Version: 1.0.200.v20090520, Location: update&#64;plugins/org.eclipse.equinox.launcher_1.0.200.v20090520.jar Id: org.eclipse.equinox.launcher.win32.win32.x86, Version: 1.0.200.v20090519, Location: update&#64;plugins/org.eclipse.equinox.launcher.win32.win32.x86_1.0.200.v20090519/ Id: org.eclipse.equinox.p2.artifact.repository, Version: 1.0.100.v20090527-1812, Location: update&#64;plugins/org.eclipse.equinox.p2.artifact.repository_1.0.100.v20090527-1812.jar Id: org.eclipse.equinox.p2.core, Version: 1.0.100.v20090520-1905, Location: update&#64;plugins/org.eclipse.equinox.p2.core_1.0.100.v20090520-1905.jar Id: org.eclipse.equinox.p2.engine, Version: 1.0.100.v20090525, Location: update&#64;plugins/org.eclipse.equinox.p2.engine_1.0.100.v20090525.jar Id: org.eclipse.equinox.p2.jarprocessor, Version: 1.0.100.v20090520-1905, Location: update&#64;plugins/org.eclipse.equinox.p2.jarprocessor_1.0.100.v20090520-1905.jar Id: org.eclipse.equinox.p2.metadata, Version: 1.0.100.v20090525, Location: update&#64;plugins/org.eclipse.equinox.p2.metadata_1.0.100.v20090525.jar Id: org.eclipse.equinox.p2.metadata.repository, Version: 1.0.100.v20090525, Location: update&#64;plugins/org.eclipse.equinox.p2.metadata.repository_1.0.100.v20090525.jar Id: org.eclipse.equinox.p2.repository, Version: 1.0.0.v20090601-1921, Location: update&#64;plugins/org.eclipse.equinox.p2.repository_1.0.0.v20090601-1921.jar Id: org.eclipse.equinox.preferences, Version: 3.2.300.v20090520-1800, Location: update&#64;plugins/org.eclipse.equinox.preferences_3.2.300.v20090520-1800.jar Id: org.eclipse.equinox.registry, Version: 3.4.100.v20090520-1800, Location: update&#64;plugins/org.eclipse.equinox.registry_3.4.100.v20090520-1800.jar Id: org.eclipse.equinox.security, Version: 1.0.100.v20090520-1800, Location: update&#64;plugins/org.eclipse.equinox.security_1.0.100.v20090520-1800.jar Id: org.eclipse.equinox.security.win32.x86, Version: 1.0.100.v20090520-1800, Location: update&#64;plugins/org.eclipse.equinox.security.win32.x86_1.0.100.v20090520-1800.jar Id: org.eclipse.help, Version: 3.4.0.v20090526, Location: update&#64;plugins/org.eclipse.help_3.4.0.v20090526.jar Id: org.eclipse.help.appserver, Version: 3.1.400.v20090429_1800, Location: update&#64;plugins/org.eclipse.help.appserver_3.1.400.v20090429_1800.jar Id: org.eclipse.help.base, Version: 3.4.0.v200906051444, Location: update&#64;plugins/org.eclipse.help.base_3.4.0.v200906051444.jar Id: org.eclipse.help.ui, Version: 3.4.0.v20090528, Location: update&#64;plugins/org.eclipse.help.ui_3.4.0.v20090528.jar Id: org.eclipse.help.webapp, Version: 3.4.0.v20090429_1800, Location: update&#64;plugins/org.eclipse.help.webapp_3.4.0.v20090429_1800.jar Id: org.eclipse.jface, Version: 3.5.0.I20090525-2000, Location: update&#64;plugins/org.eclipse.jface_3.5.0.I20090525-2000.jar Id: org.eclipse.jface.databinding, Version: 1.3.0.I20090525-2000, Location: update&#64;plugins/org.eclipse.jface.databinding_1.3.0.I20090525-2000.jar Id: org.eclipse.jface.text, Version: 3.5.0.v20090602, Location: update&#64;plugins/org.eclipse.jface.text_3.5.0.v20090602.jar Id: org.eclipse.mat.api, Version: 0.8.0.200906151352, Location: update&#64;plugins/org.eclipse.mat.api_0.8.0.200906151352.jar Id: org.eclipse.mat.chart, Version: 0.8.0.200906151352, Location: update&#64;plugins/org.eclipse.mat.chart_0.8.0.200906151352.jar Id: org.eclipse.mat.chart.ui, Version: 0.8.0.200906151352, Location: update&#64;plugins/org.eclipse.mat.chart.ui_0.8.0.200906151352.jar Id: org.eclipse.mat.dtfj, Version: 0.8.0.200906151352, Location: update&#64;plugins/org.eclipse.mat.dtfj_0.8.0.200906151352.jar Id: org.eclipse.mat.hprof, Version: 0.8.0.200906151352, Location: update&#64;plugins/org.eclipse.mat.hprof_0.8.0.200906151352.jar Id: org.eclipse.mat.jdt, Version: 0.8.0.200906151352, Location: update&#64;plugins/org.eclipse.mat.jdt_0.8.0.200906151352.jar Id: org.eclipse.mat.parser, Version: 0.8.0.200906151352, Location: update&#64;plugins/org.eclipse.mat.parser_0.8.0.200906151352.jar Id: org.eclipse.mat.report, Version: 0.8.0.200906151352, Location: update&#64;plugins/org.eclipse.mat.report_0.8.0.200906151352.jar Id: org.eclipse.mat.ui, Version: 0.8.0.200906151352, Location: update&#64;plugins/org.eclipse.mat.ui_0.8.0.200906151352.jar Id: org.eclipse.mat.ui.help, Version: 0.8.0.200906151352, Location: update&#64;plugins/org.eclipse.mat.ui.help_0.8.0.200906151352.jar Id: org.eclipse.mat.ui.rcp, Version: 0.8.0.200906151352, Location: update&#64;plugins/org.eclipse.mat.ui.rcp_0.8.0.200906151352.jar Id: org.eclipse.osgi, Version: 3.5.0.v20090520, Location: System Bundle Id: org.eclipse.osgi.services, Version: 3.2.0.v20090520-1800, Location: update&#64;plugins/org.eclipse.osgi.services_3.2.0.v20090520-1800.jar Id: org.eclipse.platform, Version: 3.3.200.v200906051444, Location: update&#64;plugins/org.eclipse.platform_3.3.200.v200906051444/ Id: org.eclipse.swt, Version: 3.5.0.v3550a, Location: update&#64;plugins/org.eclipse.swt_3.5.0.v3550a.jar Id: org.eclipse.swt.win32.win32.x86, Version: 3.5.0.v3550a, Location: update&#64;plugins/org.eclipse.swt.win32.win32.x86_3.5.0.v3550a.jar Id: org.eclipse.text, Version: 3.5.0.v20090513-2000, Location: update&#64;plugins/org.eclipse.text_3.5.0.v20090513-2000.jar Id: org.eclipse.ui, Version: 3.5.0.I20090604-2000, Location: update&#64;plugins/org.eclipse.ui_3.5.0.I20090604-2000.jar Id: org.eclipse.ui.cheatsheets, Version: 3.3.200.v20090526, Location: update&#64;plugins/org.eclipse.ui.cheatsheets_3.3.200.v20090526.jar Id: org.eclipse.ui.console, Version: 3.4.0.v20090513, Location: update&#64;plugins/org.eclipse.ui.console_3.4.0.v20090513.jar Id: org.eclipse.ui.editors, Version: 3.5.0.v20090527-2000, Location: update&#64;plugins/org.eclipse.ui.editors_3.5.0.v20090527-2000.jar Id: org.eclipse.ui.forms, Version: 3.4.0.v20090526, Location: update&#64;plugins/org.eclipse.ui.forms_3.4.0.v20090526.jar Id: org.eclipse.ui.ide, Version: 3.5.0.I20090525-2000, Location: update&#64;plugins/org.eclipse.ui.ide_3.5.0.I20090525-2000.jar Id: org.eclipse.ui.ide.application, Version: 1.0.100.I20090525-2000, Location: update&#64;plugins/org.eclipse.ui.ide.application_1.0.100.I20090525-2000.jar Id: org.eclipse.ui.intro, Version: 3.3.0.v20090526, Location: update&#64;plugins/org.eclipse.ui.intro_3.3.0.v20090526.jar Id: org.eclipse.ui.intro.universal, Version: 3.2.300.v20090526, Location: update&#64;plugins/org.eclipse.ui.intro.universal_3.2.300.v20090526/ Id: org.eclipse.ui.navigator, Version: 3.4.0.I20090525-2000, Location: update&#64;plugins/org.eclipse.ui.navigator_3.4.0.I20090525-2000.jar Id: org.eclipse.ui.navigator.resources, Version: 3.4.0.I20090525-2000, Location: update&#64;plugins/org.eclipse.ui.navigator.resources_3.4.0.I20090525-2000.jar Id: org.eclipse.ui.net, Version: 1.2.0.I20090430-0408, Location: update&#64;plugins/org.eclipse.ui.net_1.2.0.I20090430-0408.jar Id: org.eclipse.ui.views, Version: 3.4.0.I20090525-2000, Location: update&#64;plugins/org.eclipse.ui.views_3.4.0.I20090525-2000.jar Id: org.eclipse.ui.views.log, Version: 1.0.100.v20090527, Location: update&#64;plugins/org.eclipse.ui.views.log_1.0.100.v20090527.jar Id: org.eclipse.ui.views.properties.tabbed, Version: 3.5.0.I20090429-1800, Location: update&#64;plugins/org.eclipse.ui.views.properties.tabbed_3.5.0.I20090429-1800.jar Id: org.eclipse.ui.win32, Version: 3.2.100.v20090429-1800, Location: update&#64;plugins/org.eclipse.ui.win32_3.2.100.v20090429-1800.jar Id: org.eclipse.ui.workbench, Version: 3.5.0.I20090603-2000, Location: update&#64;plugins/org.eclipse.ui.workbench_3.5.0.I20090603-2000.jar Id: org.eclipse.ui.workbench.texteditor, Version: 3.5.0.v20090603, Location: update&#64;plugins/org.eclipse.ui.workbench.texteditor_3.5.0.v20090603.jar Id: org.eclipse.update.configurator, Version: 3.3.0.v20090312, Location: initial&#64;reference:file:plugins/org.eclipse.update.configurator_3.3.0.v20090312.jar/ Id: org.eclipse.update.core, Version: 3.2.300.v20090525, Location: update&#64;plugins/org.eclipse.update.core_3.2.300.v20090525.jar Id: org.eclipse.update.core.win32, Version: 3.2.100.v20080107, Location: update&#64;plugins/org.eclipse.update.core.win32_3.2.100.v20080107.jar Id: org.eclipse.update.ui, Version: 3.2.200.v20090213, Location: update&#64;plugins/org.eclipse.update.ui_3.2.200.v20090213.jar Id: org.hamcrest.core, Version: 1.1.0.v20090501071000, Location: update&#64;plugins/org.hamcrest.core_1.1.0.v20090501071000.jar Id: org.junit4, Version: 4.5.0.v20090423, Location: update&#64;plugins/org.junit4_4.5.0.v20090423/ Id: org.mortbay.jetty.server, Version: 6.1.15.v200905151201, Location: update&#64;plugins/org.mortbay.jetty.server_6.1.15.v200905151201.jar Id: org.mortbay.jetty.util, Version: 6.1.15.v200905182336, Location: update&#64;plugins/org.mortbay.jetty.util_6.1.15.v200905182336.jar Id: org.mozilla.rhino, Version: 1.7.1.v20090608, Location: update&#64;plugins/org.mozilla.rhino_1.7.1.v20090608/  Okay, I was able to reproduce this (we are one step closer):  * Download latest MAT from eclipse * Download DTFJ updatesite from the link in the New &amp; Noteworthy section of the help pages * Choose Help -&gt; Software Updates -&gt; Find and Install... * Choose Search for new features to install * Choose New archived Site... and select ZIP file downloaded from Alphaworks * Select DTFJ 1.3, accept license, install and restart * Open a PHD dump   resolution=optional could be the problem - if it means that the import is only evaluated once and not after an installation of another bundle. I'll look into that together with Erwin. Resolution optional seems not work in an expected way. I also tried using Import-Package only - no luck with resolution optional.  This snippet works (adding &quot;DynamicImport-Package&quot;) - but it feels ugly. I can't assess the side effects.  Index: MANIFEST.MF =================================================================== --- MANIFEST.MF    (revision 359) +++ MANIFEST.MF    (working copy) &#64;&#64; -12,3 +12,4 &#64;&#64;  Bundle-Activator: org.eclipse.mat.dtfj.InitDTFJ  Bundle-ActivationPolicy: lazy  Eclipse-LazyStart: true +DynamicImport-Package: com.ibm.dtfj.* When installing MAT into the IDE, the resolution optional works as expected. It seems to be a problem with the &quot;Classic Installer&quot; which we still use in the RCP. We tried to switch to P2 some time ago, but it increased the download size of the ZIP significantly - therefore we stayed with the classic installer. Now we have hard facts to move. I'll add it to the list.  For now, I have checked in the Dynamic-Import directive. change list submitted	
281311	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1245784080000	1256263260000		Merged Paths from GC roots calculation may slow down the Leak Suspects report	This problem was reported in the MAT dev mailing list from  Daniel Le Berre. I add to the bugzilla message his first mail and my first reply, which should explain the problem in detail.   -----Original Message----- From: mat-dev-bounces&#64;eclipse.org [mailto:mat-dev-bounces&#64;eclipse.org] On Behalf Of Daniel Le Berre Sent: Sonntag, 21. Juni 2009 23:12 To: mat-dev&#64;eclipse.org Subject: [mat-dev] Test case for leak detection algorithm  Dear MAT developers,  I gave a try to MAT on SAT4J under heavy duty  Memory Analyzer (Incubation)    0.8.0.200906082011  I generated a dump as suggested in Ian Bull blog: <a href="http://eclipsesource.com/blogs/2009/06/20/eclipse-galileo-feature-top-10">http://eclipsesource.com/blogs/2009/06/20/eclipse-galileo-feature-top-10</a> -list-number-5/  The dump is available here: <a href="http://www.sat4j.org/heap.bin.gz">http://www.sat4j.org/heap.bin.gz</a>  If I try to detect memory leaks on that dump, the leak detection algorithm cannot complete its task in reasonable time (it ran during at least 15mn on my PIV 3GHz). I have to quit eclipse to stop the process (pushing the cancel button has no effect).  The dump is unusual I guess because there is a very high number of one single kind of objects (the constraints).  I am wondering if there is a hope to be able to use MAT on such kind of dumps at some point or if those cases cannot be analyzed efficiently under current knowledge (i.e. limitation due to the complexity of the algorithms used).  Cheers,      Daniel     -----Original Message----- From: mat-dev-bounces&#64;eclipse.org [mailto:mat-dev-bounces&#64;eclipse.org] On Behalf Of Tsvetkov, Krum Sent: Montag, 22. Juni 2009 15:32 To: Memory Analyzer Dev list Subject: RE: [mat-dev] Test case for leak detection algorithm  Hello Daniel,  I have some better explanation for the problem, however, no really good solution for the moment.  In your heapdump, the leak suspect is not a single object, but a group of over 160.000 objects from the same class. Once we find the suspect, we attempt to provide in the report some information about the paths to the suspect. As there are many objects in the suspect, what the tool does is calculate only the shortest path from the GC roots to each of them and then try to merge the paths in order to show the common part. This could be a rather costly operation, therefore the tool takes randomly only 10.000 out of the 160.000 objects, and calculates the paths to them. This usually works pretty well. We also try to cache the already found paths and reuse them during the computation.  However, in your heap dump there are over hundred thousand different reference chains to every of the objects of interest, which happen to be processed before we find the cached path. And thus, the calculation of each path takes between 0.3 and 0.5 seconds on a relatively good PC. Doing this for 10.000 objects will take time.  The optimal solution (which I don't have :-) ... yet ...) will be to find a better algorithm for the heavy computation I am doing. This may need some time, and at the end I'm not sure I could make it at all. At least I have a very good example now.  A not so optimal solution, but something you can use as a workaround for now, will be to use the &quot;Find Leaks&quot; query instead of running the &quot;Leak Suspects&quot; report - see attachment. There you can specify the maximum number of paths to be calculated (the parameter &quot;-max_paths&quot;). Reducing the value there can help get a result for your heap dump faster.  Thanks again for giving the feedback and the sample dump. I hope I could give you a reasonable workaround for now. And I also hope we'll be able to find some reasonable general solution for this.  Regards, Krum I have reimplemented the way the paths to multiple objects are calculated (revision #372 in SVN). For the provided heap dump which was the trigger for this bugzilla entry, now the report is generated in seconds (instead of running over 20 min).  The previous implementation was doing a breadth first search (BFS) from every single object of interest back (using the inbound references) to the first encountered GC root.  Now I implemented it in such a way, that only one BFS is done. It starts from the GC roots, and using the outbound refereces continues until all objects of interest are reached.  Unfortunatelly I can't say that the fix has only positive effects. In some cases it may take longer than before to calculate the paths. Namely, if you search the paths to just a few objects in a huge heap dump, it may take longer to reach them starting from the GC roots. In the worst cases almost the whole graph has to be traversed. But still the approach is much more predictable than the previous implementation.   I tried to summarize the pros and cons below, and I hope to get your comments on it:  ---------- Pros: ---------- - on smaller heap dumps (about 1Gb) the new algorithm is in general faster: for large number of objects the paths are found much faster, for a small amount of objects it may be slower, but the slownes is less than a second  - both on small (about 1Gb) and large dumps (over 3Gb) the new algorithm is much more predictable. It will take at most the time to traverse the graph once, which should be even on the huge dumps within a minute. With the old algorithm there were scenarios that took unpredictibly long (half an hour), or ran into an OutOfMemoryError  - it will allow us to inclrease the limit for number of paths in the leak report. Right now it is 10 000, and this was already too much with the provided sample heap dump. With the new algorithm the paths to all 160.000 objects are calculated within seconds  - the new algorithm gives me the possibility to better show the maximum remaining time in a progress bar  - the information which is gathered during the BFS can be persisted and reused for faster calculation of paths to other objects. I haven't done this, but it is possible.  - shorter and (hopefully) clearer code  --------- Cons: --------- - on some large heap dumps (over 3Gb), if one calculates the paths to a few objects only, then the new algorithm may be slower. In some of the tests I did, the old one took like 8 sec and the new one 40 sec. Still, the time to finish the whole calculation is predictable, and if the action is done manual the progress bar shows adequate maximum time. ---------  I will be happy if some of the people on the list can comment.  I have already submitted the changes and if you take the latest nightly build you can try them out.  I thought about keeping the old and new algorithm and continue to use the old one for a small amount of objects, but then it is difficult to define this &quot;small amount&quot;. With the provided sample dump the calculation for 100 objects were already slow enough. Additionally it will be harder to maintain the both pieces of code. Therefore I trew the old one for the moment away.  Looking forward to your replies. cool! Feedback so far was positive. Also our own experience was better than with the previous implementation. I think we can close this issue.	
281622	normal	FIXED	Dummy Inbox	markus.kohler	1245959640000	1267345920000		The unreachable_objects view is broken	Steps done:  open the Sample heap dump from the help. click on &quot;Unreachable objects histogram&quot; link at the top of the Overview page.  The View shows up but right clicking only opens a menu with one entry &quot;Edit filter&quot;. Forget to mention. Used eclipse 3.5 and then installed MAT using the update site unfortunately it is not possible to proceed analysis with unreachable objects histogram - there is no object graph benind it(see <a href="http://wiki.eclipse.org/MemoryAnalyzer/FAQ#How_to_analyse_unreachable_objects">http://wiki.eclipse.org/MemoryAnalyzer/FAQ#How_to_analyse_unreachable_objects</a>) You can use a flag to keep those objects while parsing, they will appear then in normal class histogram, but currently there is no query to extract the unreachable objects from a histogram. (In reply to <a href="show_bug.cgi?id=281622#c2">comment #2</a>) <span class="quote">&gt; unfortunately it is not possible to proceed analysis with unreachable objects &gt; histogram - there is no object graph benind it(see &gt; <a href="http://wiki.eclipse.org/MemoryAnalyzer/FAQ#How_to_analyse_unreachable_objects">http://wiki.eclipse.org/MemoryAnalyzer/FAQ#How_to_analyse_unreachable_objects</a>) &gt; You can use a flag to keep those objects while parsing, they will appear then &gt; in normal class histogram, but currently there is no query to extract the &gt; unreachable objects from a histogram. &gt; </span >  OK, I understand.  But then I think it's at least a usability problem. It looks like a normal histogramm and I would at least expect that I can inspect single instances.  Having a different icon or some other indicator that this is only a class statistics, like the one that you also can get from the JVM without a heap dump, would make sense to me.  The icon for the unreachable objects histogram page is actually the 'Execute Query' icon of a disk with a dot, not a histogram icon.  The classes have the normal class icon.  It might be nice if the selecting a class in the unreachable objects view actually brought up the class in the inspector (assuming it hadn't itself been thrown away). That's an enhancement though. Another enhancement would be for the -keep_unreachable_objects to mark the objects with a new GC type - e.g. 'Unreachable'.  You could then parse the dump with -keep_unreachable_objects, do show GC roots, select 'Unreachable' then do show retained set.  Ideally there would be a way of specifying options such as -keep_unreachable_objects from the GUI.  I propose that this bug is converted into an enhancement. I think it would make sense to include such changes in 1.0. What do you think? We could save the class address in the histogram record, then using the snapshot convert that to an object id if the class still exists in the dump.  This means the object inspector will show the class if it still exists in the dump.  Presumably we should return null from getContext for a class that does not exist. The context menu will then just say 'Edit filter'.  If the class exists, should we return an IContextObject (for just the class, selecting a query operates on the class object), or a IContextObjectSet with no objects, so selecting the class and a query produces no results?  Old histograms will get 0 for the class address when deserialized, but that won't be an unreachable object as 0 is only used for the bootstrap loader. I've made the change so that keep_unreachable_objects marks objects as 'Unreachable'.  I wonder if this is the right term.  PHD files have no root information. The DTFJ parser marks objects without inbound references as GCRootInfo.Type.UNKNOWN.  markUnreachbleAsGCUnknown() marks objects without inbound references and enough of the remaining unreachable objects as GCRootInfo.Type.UNREACHABLE to make all objects reachable.  Should PHD files always use the markUnreachbleAsGCUnknown() method as there is no knowledge of roots? If so, is the term 'Unreachable' correct as a root type name? Perhaps the way forward for PHD files is for the DTFJ parser to indicate to the GarbageCleaner that all objects need to be made reachable.  One way would be to use the properties from the getSnapshotInfo. E.g. in the parser do:              index.getSnapshotInfo().setProperty(&quot;keep_unreachable_objects&quot;, GCRootInfo.Type.UNKNOWN); //$NON-NLS-1$   and retrieve the value in GarbageCleaner. This will be serialized with the snapshot, which at least keeps a record of what has been done.  The -keep_unreachable_objects command line option could then set              idx.getSnapshotInfo().setProperty(&quot;keep_unreachable_objects&quot;, GCRootInfo.Type.UNREACHABLE); //$NON-NLS-1$   Perhaps this should be done before calling the parser so the parser knows what is happening, and can override the value if required. There's no way of clearing a property, so perhaps 0 or null should be defined to mean 'not set'.  We could do with a list of command line options and snapshot properties.  $heapFormat org.eclipse.mat.snapshot.UnreachableObjectsHistogram  etc. I've put in the changes where keep_unreachable_objects is an Integer property with the GCRootType used to mark the unreachable objects.  If you have a dump built with -keep_unreachable_objects in batch mode then the retained set from Unreachable GCRoots shows you a full histogram.  Is this now good enough?	
282300	normal	FIXED	Erwin Margewitsch	andrew_johnson	1246504860000	1251424560000		NotesView changes	NotesView imports interface org.eclipse.ui.texteditor.IUpdate which is uses for NotesViewAction.  MAT runs when this IUpdate reference is removed. What is it really needed for?  If it can be removed then we don't need plug-in org.eclipse.ui.editors which saves about 500kB.  Do we need to import plug-ins  org.eclipse.mat.ui org.eclipse.ui.console org.eclipse.ui.workbench  Another problem: the line             if (text != null &amp;&amp; text.trim() != &quot;&quot;) looks suspicious as reference comparison is not good for strings. This might be intended             if (text != null &amp;&amp; !text.trim().equals(&quot;&quot;)) but what is the intention for an existing note file if the user deletes all the characters. Should it leave the existing notes untouched on a save (strange), overwrite the file with no data or delete the file? Presumably it should not create a file if no text is supplied. <span class="quote">&gt;Another problem: the line &gt;            if (text != null &amp;&amp; text.trim() != &quot;&quot;) &gt;looks suspicious as reference comparison is not good for strings.</span >  You are right, the second check is not necessary at all.  IUpdate is implemented to enable/disable context menu actions in NotesView in sync with the user's activities. Currently I check whether there are other ways to get the same functionality. Since org.eclipse.ui.console was removed from the dependency list of org.eclipse.mat.ui I'm removing it also from the dependencies feature which holds all the necessary plugins for the MAT RCP. After removing org.eclipse.ui.console will Memory Analyzer still start with -console (for the OSGi console?) Yes, it will still start with the (OSGI-)console. The package org.eclipse.ui.console is related to the ConsoleView (from Javadoc: &quot;The Eclipse platform UI console plug-in provides a set of classes and interfaces to facilitate the creation and display of consoles in the ConsoleView&quot;). I just wondered why there is still a dependency to org.eclipse.ui.editors. As far as I can see there is no need for it anymore. Everything compiles and the Notes view is still usable. Benjamin, agreed. There is no compile time dependency left, the only reference is an extension point &quot;org.eclipse.ui.editors&quot; which lives in another plug-in. Erwin is on vacation this week. He'll look into it. dependency to org.eclipse.ui.editors successfully removed with changeset 405.	
291481	normal	FIXED	Erwin Margewitsch	xu.xiang	1254794700000	1255471980000		Unable to install MAT via update site	User-Agent:       Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; InfoPath.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729) Build Identifier: M20090917-0800  !SESSION 2009-10-02 18:09:55.890 ----------------------------------------------- eclipse.buildId=M20090917-0800 java.version=1.6.0_13 java.vendor=Sun Microsystems Inc. BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=de_DE Framework arguments:  -product org.eclipse.epp.package.jee.product Command-line arguments:  -os win32 -ws win32 -arch x86 -product org.eclipse.epp.package.jee.product -data C:\IDE_000\workspace   !ENTRY org.eclipse.equinox.p2.engine 4 4 2009-10-06 08:28:49.140 !MESSAGE An error occurred while collecting items to be installed !SUBENTRY 1 org.eclipse.equinox.p2.engine 4 0 2009-10-06 08:28:49.140 !MESSAGE session context was:(profile=epp.package.jee, phase=org.eclipse.equinox.internal.provisional.p2.engine.phases.Collect, operand=, action=). !SUBENTRY 1 org.eclipse.equinox.p2.artifact.repository 4 0 2009-10-06 08:28:49.140 !MESSAGE Problems downloading artifact: org.eclipse.update.feature,org.eclipse.mat.chart.feature,0.8.0.200907281127. !SUBENTRY 2 org.eclipse.equinox.p2.artifact.repository 4 0 2009-10-06 08:28:49.140 !MESSAGE MD5 hash is not as expected. Expected: 41d7db32e0aa53b3f1e9b41384aa8f1a and found 4a714112f410a54787ca264c127a08d1. !SUBENTRY 1 org.eclipse.equinox.p2.artifact.repository 4 0 2009-10-06 08:28:49.140 !MESSAGE Problems downloading artifact: org.eclipse.update.feature,org.eclipse.mat.feature,0.8.0.200907281127. !SUBENTRY 2 org.eclipse.equinox.p2.artifact.repository 4 0 2009-10-06 08:28:49.140 !MESSAGE MD5 hash is not as expected. Expected: a7c554cf3face5ce1560e680818a4c3d and found d6a37c2423b731ed6b50f6cfecff303c.   Reproducible: Always  Steps to Reproduce: 1.add MAT update site: <a href="http://download.eclipse.org/technology/mat/latest/update-site/">http://download.eclipse.org/technology/mat/latest/update-site/</a> 2.try to install MAT plugins I checked the update site and realized that I created the p2 update site first and only later signed the jars...  I uploaded a corrected version of the update site.	
294311	normal	FIXED	Krum Tsvetkov	zombi	1257378660000	1276630260000		Internal error during opening a hprof file	User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.0.14) Gecko/2009090217 Ubuntu/9.04 (jaunty) Firefox/3.0.14 Build Identifier: 0.8.0.200906170940  I've tried to open a big (1.1 Gb) hprof dump file, which I've collected from sun-1.6.0.16 JVM, but after minutes of parsing, it stops with an internal error:  java.lang.ArrayIndexOutOfBoundsException: 10735825 at org.eclipse.mat.parser.internal.DominatorTree$Calculator.dfs(DominatorTree.java:267) at org.eclipse.mat.parser.internal.DominatorTree$Calculator.compute(DominatorTree.java:108) at org.eclipse.mat.parser.internal.DominatorTree.calculate(DominatorTree.java:35) at org.eclipse.mat.parser.internal.SnapshotImpl.calculateDominatorTree(SnapshotImpl.java:1186) at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:194) at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:102) at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:114) at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:94) at org.eclipse.mat.ui.snapshot.ParseHeapDumpJob.run(ParseHeapDumpJob.java:54) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)  After closing the tab, and reopening a file it reports that dominator tree is not available, so most of the reports are not working. Re-indexing not helps.    Reproducible: Always  Steps to Reproduce: 1. Open a big heap dump 2. wait some minutes 3. Internal error Does this happen also with smaller dumps? I'm asking as it would be very helpful to have a heap dump which triggers the problem and look at it. Or could you provide us this dump (I guess zipped it will be about 100 - 150Mb). May be you can upload it somewhere?  I had a look at the coding, and I think without the concrete dump it will be very difficult to find the problem. This code we haven't changed for a long time and it's the first time I see the error.  I will also give it a try with some 1.6_16 VM dumps to see if I can get this reproduced. (In reply to <a href="show_bug.cgi?id=294311#c1">comment #1</a>) <span class="quote">&gt; Does this happen also with smaller dumps? I'm asking as it would be very &gt; helpful to have a heap dump which triggers the problem and look at it. Or could &gt; you provide us this dump (I guess zipped it will be about 100 - 150Mb). May be &gt; you can upload it somewhere? &gt;  &gt; I had a look at the coding, and I think without the concrete dump it will be &gt; very difficult to find the problem. This code we haven't changed for a long &gt; time and it's the first time I see the error. &gt;  &gt; I will also give it a try with some 1.6_16 VM dumps to see if I can get this &gt; reproduced.</span >  I too am seeing this with my dump, in this case a 44 meg PHD file generated from both Linux and Windows; somewhere in &quot;calculating dominator tree&quot;. I'm looking at PHD files on a Window 2003 server; they we generated on a Linux redhat box and a separate 2003 server.  I might be able to get you this file(PHD) if you think it helpful; I'd have to ask around, sometimes IBM is picky about these things.  I can certainly run tests for you.   Directory of I:\dumps  11/09/2009  04:21 PM    &lt;DIR&gt;          . 11/09/2009  04:21 PM    &lt;DIR&gt;          .. 11/09/2009  04:21 PM         6,169,204 heapdump.20091109.161738.2008.0001.a2s.in dex 11/09/2009  04:21 PM        23,724,473 heapdump.20091109.161738.2008.0001.idx.in dex 11/09/2009  04:21 PM        36,216,168 heapdump.20091109.161738.2008.0001.inboun d.index 11/09/2009  04:21 PM         4,820,628 heapdump.20091109.161738.2008.0001.index 11/09/2009  04:21 PM         9,301,574 heapdump.20091109.161738.2008.0001.o2c.in dex 11/09/2009  04:21 PM        36,091,168 heapdump.20091109.161738.2008.0001.outbou nd.index 11/09/2009  04:17 PM        44,057,804 heapdump.20091109.161738.2008.0001.phd 11/09/2009  04:20 PM                 0 heapdump.20091109.161738.2008.0001.thread s                8 File(s)    160,381,019 bytes                2 Dir(s)  952,665,055,232 bytes free  java.lang.ArrayIndexOutOfBoundsException org.eclipse.mat.parser.internal.DominatorTree$Calculator.dfs(DominatorTree.java:267) org.eclipse.mat.parser.internal.DominatorTree$Calculator.compute(DominatorTree.java:108) org.eclipse.mat.parser.internal.DominatorTree.calculate(DominatorTree.java:35) org.eclipse.mat.parser.internal.SnapshotImpl.calculateDominatorTree(SnapshotImpl.java:1186) org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:194) org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:102) org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:114) org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:94) org.eclipse.mat.ui.snapshot.ParseHeapDumpJob.run(ParseHeapDumpJob.java:54) org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)  eclipse.buildId=unknown java.fullversion=JRE 1.6.0 IBM J9 2.4 Windows Server 2003 x86-32 jvmwi3260sr6-20090923_42924 (JIT enabled, AOT enabled)  Using the standalone version I installed today Eclipse Memory Analyzer Version 0.8 (c) Copyright Eclipse Contributors 2009.  All rights Reserved.  Thanks! Created <span class=""><a href="attachment.cgi?id=151798&amp;action=diff" name="attach_151798" title="Patch to dump the sizes of some important internal structures">attachment 151798</a> <a href="attachment.cgi?id=151798&amp;action=edit" title="Patch to dump the sizes of some important internal structures">[details]</a></span> Patch to dump the sizes of some important internal structures Created <span class=""><a href="attachment.cgi?id=151799" name="attach_151799" title="mylyn/context/zip">attachment 151799</a> <a href="attachment.cgi?id=151799&amp;action=edit" title="mylyn/context/zip">[details]</a></span> mylyn/context/zip Created <span class=""><a href="attachment.cgi?id=151800" name="attach_151800" title="built bundle containing a patch to dump the sizes of some internal structures">attachment 151800</a> <a href="attachment.cgi?id=151800&amp;action=edit" title="built bundle containing a patch to dump the sizes of some internal structures">[details]</a></span> built bundle containing a patch to dump the sizes of some internal structures I would very much appreciate if one of you can let me download a problematic heap dump. I had meanwhile a more detailed look at the coding. It seems that we either we wrongly calculate the number of objects in the heap (provided later by the SnapshotInfo object), or that while cleaning some unreachable objects we have &quot;forgotten&quot; an ID of such an object somewhere. These IDs are used later as indexes to access some arrays, and therefore could be the cause of the problem.  If providing the dump to us is difficult, I would be thankful if you can execute the same steps again with the attached patch. I have also build the plugin, so that you can temporarily replace your old one. The patch will not solve the problem. It will just print the sizes of some important structures, so that I know if the problem is wrongly calculated size, or wring content. This can give me some further hints.  These are the steps you could follow: - move the org.eclipse.mat.parser_*.jar out of the &lt;mat&gt;/plugins/ directory, and replace it with the attached one - delete the old log file &lt;MAT&gt;/workspace/.metadata/.log - delete the indexes of the heap dump - start MAT and open the heap dump - send me back the newly generated &lt;MAT&gt;/workspace/.metadata/.log file  I will probably not be able to solve the problem directly after this step, but I hope to get closer to it.  Thanks for your time and feedback! Created <span class=""><a href="attachment.cgi?id=151814" name="attach_151814" title="The .log with the debug patch.">attachment 151814</a> <a href="attachment.cgi?id=151814&amp;action=edit" title="The .log with the debug patch.">[details]</a></span> The .log with the debug patch.  Cleaned the indexes, ran... same results as expected.  I can see the stack trace has different line numbers, so it look like you patch did get picked up. Thanks for running the test! The problem seems to be that I am getting wrong value from snapshot.getSnapshotInfo().getNumberOfObjects() - one object less than the values in the indexes. In the log file:  ... !MESSAGE snapshot.getSnapshotInfo().getNumberOfObjects() = 3382369 ... !MESSAGE snapshot.getIndexManager().idx.size() = 3382370 ...  I will look now in more detail how we calculated this and what could go wrong there.  Can you try to zip and send me the &lt;heapdump&gt;.index and &lt;heapdump&gt;.o2c.index files? I hope this is not a problem (except the size), as they contain no sensitive data. The first one contains the serialized SnapshotInfo object, and serialized data for every class from the heap dump. The second contains a mapping objectId to class ID. This could help me, but I would understand if you can't (or are not allowed) to send them.  I hope next time I'll be able to send you a patch which fixes the problem. Created <span class=""><a href="attachment.cgi?id=151843" name="attach_151843" title="The &lt;heapdump&gt;.index  and .log file">attachment 151843</a> <a href="attachment.cgi?id=151843&amp;action=edit" title="The &lt;heapdump&gt;.index  and .log file">[details]</a></span> The &lt;heapdump&gt;.index  and .log file  I also added the .log, since I needed to rerun the test; so it should all match up.  I think I'll be able to provide a dmp, but from our released product; I'll check into that in a few minutes.  I'll send the other file in separate attachment, as it's too large to combine for bugzilla.  Have you got an address I can upload a large file too? Created <span class=""><a href="attachment.cgi?id=151844" name="attach_151844" title="The &lt;heapdump&gt;.o2c.index file">attachment 151844</a> <a href="attachment.cgi?id=151844&amp;action=edit" title="The &lt;heapdump&gt;.o2c.index file">[details]</a></span> The &lt;heapdump&gt;.o2c.index file  Off by one error!!; happens to me all the time :) I have a heap dump I can send you, 45 megs compressed.  If you can let me know a server, I'll upload it for you.  I don't have an easy way for you too pull it from here.  Thanks! Thanks for the logs and indexes! I have created a container for you, where you can upload the .phd file per HTTP. It is possible to upload just one file there. If something goes wrong, I'll open another one. <a href="https://sapmats-de.sap-ag.de/upload/index.cgi?id=LWDJXGLDD2F5BKB649AU04AWSVGFBAZ9U15S3JR8870TUCRC1U">https://sapmats-de.sap-ag.de/upload/index.cgi?id=LWDJXGLDD2F5BKB649AU04AWSVGFBAZ9U15S3JR8870TUCRC1U</a> Ok!  Sent, let me know if you didn't get it, and we can try again.  The browser (chrome) seemed to think things went well. I got the file. Surprizing for me I was able to parse it without problems.  I guess we may have different versions of the DTFJ implementation. Can you list the contents of the &lt;mat&gt;/plugins folder and send me the names of all com.ibm.dtfj.* ?  I will try meanwhile to use the indexes you provided to analyze the root cause. Here you go! Latest I could find...  09/29/2009  01:56 PM            17,494 com.ibm.dtfj.api_1.3.2.200909291456.jar 09/29/2009  01:56 PM           743,251 com.ibm.dtfj.j9_1.3.2.200909291456.jar 09/29/2009  01:56 PM           126,756 com.ibm.dtfj.phd_1.3.2.200909291456.jar 09/29/2009  01:56 PM           901,681 com.ibm.dtfj.sov_1.3.2.200909291456.jar I was thinking it might be my system,... so I installed it all on a fresh VM of w2k3, with a late version JRE, and using the same PHD, I had the same exception occur.  Don't know why you don't see it... maybe you could send your jars to see if that's it?  I really need that output!  Thanks,    Andrew  E:\mat\mat&gt;java -version java version &quot;1.6.0&quot; Java(TM) SE Runtime Environment (build pwi3260sr6-20090925_01(SR6)) IBM J9 VM (build 2.4, JRE 1.6.0 IBM J9 2.4 Windows Server 2003 x86-32 jvmwi3260s r6-20090923_42924 (JIT enabled, AOT enabled) J9VM - 20090923_042924 JIT  - r9_20090902_1330ifx1 GC   - 20090817_AA) JCL  - 20090924_01 I had a buddy with these versions of the files, and they seem to work. So the bug was introduced post these guys.   S:\mat\mat\plugins&gt;xcopy d:\downloads\com.ibm.dtfj.* . D:\downloads\com.ibm.dtfj.api_1.3.0.200902101205.jar D:\downloads\com.ibm.dtfj.j9.impl_1.3.0.200902101205.jar D:\downloads\com.ibm.dtfj.phd_1.3.0.200902101205.jar D:\downloads\com.ibm.dtfj.sov.impl_1.3.0.200902101205.jar 4 File(s) copied It turned out that Andrew has already made some changes so that with the latest DTFJ the problem doesn't appear. But these changes weren't included in the last version published on our download page.  I have also made some changes to get the correct number of objects in case of mismatch. This should prevent the error in the Dominator tree  calculation, and hopefully also solve the originally reported problem (which was with an .hprof heap dump).  On our download page now there is a new version available, which contains both changes. You can try our if it solves the problem with the .phd dump, but also the originally reported problem with the hprof dump.  I'll be happy to get some confirmation if this helped. Is this now fixed? I think this is fixed now. Closing the bug.	
294350	normal	FIXED	Andrew Johnson	andrew_johnson	1257394980000	1258493280000		StackOverflowError in ArrayUtils.hybridsort	For one particular dump I saw a stack overflow error.  java.lang.StackOverflowError     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:243)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247) ...     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.hybridsort(ArrayUtils.java:247)     at org.eclipse.mat.collect.ArrayUtils.sort(ArrayUtils.java:32)     at org.eclipse.mat.parser.index.IndexWriter$InboundWriter.processSegment(IndexWriter.java:830)     at org.eclipse.mat.parser.index.IndexWriter$InboundWriter.flush(IndexWriter.java:786)     at org.eclipse.mat.parser.internal.GarbageCleaner.clean(GarbageCleaner.java:348)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:188)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:102)     at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:114)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.parse(ParseSnapshotApp.java:106)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.start(ParseSnapshotApp.java:95)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:368)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:618)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)     at org.eclipse.equinox.launcher.Main.run(Main.java:1311)     at org.eclipse.equinox.launcher.Main.main(Main.java:1287)  The bug is reproducable with this particular dump.  Found 28,660,490 identifiers, 28,637,372 objects, 23,118 classes  I put some println statements into the Quicksort method and got data such as this:  Median - shows indexes and values split - shows comparison, left, right indexes &amp; values split - shows start and end of comparison equal range and size  The array is not partitioning nicely. I don't know why we are so unlucky.    Median 0:2 29792348:3 14896174:886 split 29792348:3 left:0 right:29792348 size:29792349 split 46440 73546 27106 Median 73547:4718 29792348:4717 14932947:3392 split 29792348:4717 left:73547 right:29792348 size:29718802 split 27573948 27573969 21 Median 73547:4715 27573947:4691 13823747:3394 split 27573947:4691 left:73547 right:27573947 size:27500401 split 27573829 27573837 8 Median 73547:4688 27573828:4670 13823687:3394 split 27573828:4670 left:73547 right:27573828 size:27500282 split 27546093 27546137 44 Median 73547:2225 27546092:2066 13809819:143 split 27546092:2066 left:73547 right:27546092 size:27472546 split 17713344 17713357 13 Median 73547:1947 17713343:886 8893445:103 split 17713343:886 left:73547 right:17713343 size:17639797 split 12541192 17426557 4885365 Median 73547:653 12541191:649 6307369:241 split 12541191:649 left:73547 right:12541191 size:12467645 split 12508269 12508272 3 Median 73547:638 12508268:402 6290907:241 split 12508268:402 left:73547 right:12508268 size:12434722 split 12477686 12478971 1285 Median 73547:241 12477685:118 6275616:241 split 73547:241 left:73547 right:12477685 size:12404139 split 7449515 12403993 4954478 Median 73547:118 7449514:107 3761530:143 split 73547:118 left:73547 right:7449514 size:7375968 split 1955308 2040906 85598 Median 2040907:143 7449514:143 4745210:143 split 2040907:143 left:2040907 right:7449514 size:5408608 split 2379169 7417115 5037946 Median 17713358:3394 27546092:2225 22629725:3392 split 22629725:3392 left:17713358 right:27546092 size:9832735 split 17758804 22638692 4879888 Median 0:16561368 10217941:17002946 5108970:16996934 split 5108970:16996934 left:0 right:10217941 size:10217942 split 5331943 10211829 4879886 Median 0:16996932 5331942:16996927 2665971:16633105 split 5331942:16996927 left:0 right:5331942 size:5331943 split 5331936 5331936 0 Median 0:16996922 5331935:16996917 2665967:16994378 split 5331935:16996917 left:0 right:5331935 size:5331936 split 5331926 5331926 0 Median 0:16996912 5331925:16996907 2665962:16994378 split 5331925:16996907 left:0 right:5331925 size:5331926 split 5331916 5331916 0 Median 0:16996902 5331915:16996897 2665957:16994378 split 5331915:16996897 left:0 right:5331915 size:5331916 split 5331906 5331906 0 Median 0:16996892 5331905:16996887 2665952:16994378 split 5331905:16996887 left:0 right:5331905 size:5331906 split 5331896 5331896 0 Median 0:16996863 5331895:16996858 2665947:16994378 split 5331895:16996858 left:0 right:5331895 size:5331896 split 5331859 5331859 0 Median 0:16996839 5331858:16996834 2665929:16633058 split 5331858:16996834 left:0 right:5331858 size:5331859 split 5331835 5331835 0 Median 0:16996829 5331834:16996824 2665917:16633046 split 5331834:16996824 left:0 right:5331834 size:5331835 split 5331825 5331825 0 Median 0:16996819 5331824:16996814 2665912:16633041 split 5331824:16996814 left:0 right:5331824 size:5331825 split 5331815 5331815 0 Median 0:16996809 5331814:16996804 2665907:16633074 split 5331814:16996804 left:0 right:5331814 size:5331815 split 5331805 5331805 0 Median 0:16996799 5331804:16996794 2665902:16578372 split 5331804:16996794 left:0 right:5331804 size:5331805 split 5331795 5331795 0 Median 0:16996789 5331794:16996784 2665897:16633031 split 5331794:16996784 left:0 right:5331794 size:5331795 split 5331785 5331785 0 Median 0:16996779 5331784:16996774 2665892:16633026 split 5331784:16996774 left:0 right:5331784 size:5331785 split 5331775 5331775 0 Median 0:16996769 5331774:16996764 2665887:16633021 split 5331774:16996764 left:0 right:5331774 size:5331775 split 5331765 5331765 0 Median 0:16996759 5331764:16996754 2665882:16633016 split 5331764:16996754 left:0 right:5331764 size:5331765 split 5331755 5331755 0 Median 0:16996749 5331754:16996744 2665877:16633011 split 5331754:16996744 left:0 right:5331754 size:5331755 split 5331745 5331745 0 Median 0:16996739 5331744:16996734 2665872:16633006 split 5331744:16996734 left:0 right:5331744 size:5331745 split 5331735 5331735 0 Median 0:16996729 5331734:16996724 2665867:16633001 split 5331734:16996724 left:0 right:5331734 size:5331735 split 5331725 5331725 0 Median 0:16996719 5331724:16996714 2665862:16632996 split 5331724:16996714 left:0 right:5331724 size:5331725 split 5331715 5331715 0 Median 0:16996709 5331714:16996704 2665857:16632991 split 5331714:16996704 left:0 right:5331714 size:5331715 split 5331705 5331705 0 Median 0:16996699 5331704:16996694 2665852:16632986 split 5331704:16996694 left:0 right:5331704 size:5331705 split 5331695 5331695 0 Median 0:16996689 5331694:16996684 2665847:16632981 split 5331694:16996684 left:0 right:5331694 size:5331695 split 5331685 5331685 0 Median 0:16996674 5331684:16996640 2665842:16632976 split 5331684:16996640 left:0 right:5331684 size:5331685 split 5331626 5331626 0 Median 0:16996635 5331625:16996630 2665812:16994378 split 5331625:16996630 left:0 right:5331625 size:5331626 split 5331616 5331616 0 Median 0:16996625 5331615:16996620 2665807:16994378 split 5331615:16996620 left:0 right:5331615 size:5331616 split 5331606 5331606 0 I've solved the problem by recursing on the smaller part first, then looping instead of recursing for the bigger part.  This could give order n-squared performance (though it actually runs okay with this dump) if really unlucky, but won't cause stack overflow.  We need a simple test case though. An example of a bad sequence is 8 6 4 2 1 3 5 7 9  Median of left, right, middle 8,9,1 =&gt; 8  Partition 6 4 2 1 3 5 7 8 9  sort element 0..6  Media of left, right middle 6, 1, 7 =&gt; 6  Partition 4 2 1 3 5 6 7 8 9  etc. Fix and test case SortTest.java checked in.  SortTest isn't in the full test suite as I'm not sure if it will use too much heap. The radix sort routine now can cope with negative numbers, so the sort routine is safe for all numbers.	
295603	minor	FIXED	Dummy Inbox	andrew_johnson	1258596540000	1277773380000		Some slow operations should cancel quicker	Some slow operations put up a progress bar, but to cancel it takes a while.  E.g.  Waste in character arrays Retained set - calculating retained size   Perhaps some queries should just return a truncated result rather than giving up when canceled. +1  Agree. We already changed some of the queries to do this (return partial results), for example group by value, empty collections, etc...  We should go through all the queries and decide for which of them it makes sense to return partial result, and for which not Reduce the interval to 256 or 100 or less. I have one concern only - we should double-check the impact on performance. In the past we had some queries taking terribly long just because of too frequent updates of the progress listener /millions of updates/. I think it was relatively cheap to check if the Cancel was hit, but reporting work was  expansive (when done millions of times). I think we should * modify the queries in question to check more frequently if the work is cancelled * report work on the monitor rarely * do some quick checks on the performance impact when the queries are executed with millions of objects to process  Shall we propose first a list of queries where: * cancellation should be checked more frequently * partial results should be returned ? I tested quickly your changes in the DominatorTree. On a 12 million objects dump there was no visible delay. I ran several times with and without the changes, and sometimes even the changed version was faster :) So if there is a delay, it seems to be minimal and not visible when all other interactions with the systems are taken into account. I haven't tested with bigger heap dumps yet, but I think we can leave the changes as you did them. The Equinox bundle explorer could do with more checks. I'll make the change. Are there some further concrete changes expected here? If not I think we can close the bug. At the moment there are no concrete places known which should be fixed. I close the bug.	
299252	normal	FIXED	Dummy Inbox	krum.tsvetkov	1263156780000	1276631100000		Graduate MAT (version 1.0)	We would like to graduate MAT to a mature project.  Let us use this message as a place to discuss what we would like to put into the 1.0 release, and also to track all the related activities.   I have added all related bugzilla entries as blockers to this one. We should also add new related entries there. The project already graduated, so I'm closing this one. I removed all the &quot;depends on&quot; bugs which still have some todos.	
299253	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1263157200000	1271966580000		Create docuware for the 1.0 release	One of the things we have to do for the graduating of the project is to prepare the necessary slides as described here <a href="http://wiki.eclipse.org/Development_Resources/HOWTO/Graduation_Reviews#.282.29_Preparing_the_Docuware">http://wiki.eclipse.org/Development_Resources/HOWTO/Graduation_Reviews#.282.29_Preparing_the_Docuware</a> Created <span class=""><a href="attachment.cgi?id=165711" name="attach_165711" title="The approved IP log for the graduation/move/release review">attachment 165711</a> <a href="attachment.cgi?id=165711&amp;action=edit" title="The approved IP log for the graduation/move/release review">[details]</a></span> The approved IP log for the graduation/move/release review Created <span class="bz_obsolete"><a href="attachment.cgi?id=165725" name="attach_165725" title="Docuware for Graduatio/Move/Release review of MAT">attachment 165725</a> <a href="attachment.cgi?id=165725&amp;action=edit" title="Docuware for Graduatio/Move/Release review of MAT">[details]</a></span> Docuware for Graduatio/Move/Release review of MAT I have attached to the <span class="bz_closed"><a href="show_bug.cgi?id=1" title="CLOSED FIXED - Usability issue with external editors (1GE6IRL)">bug  1</a></span>) the approved IP log 2) the required slides for the review  Please feel free to comment on 2) Created <span class=""><a href="attachment.cgi?id=165751" name="attach_165751" title="Docuware for the graduation/move/release review">attachment 165751</a> <a href="attachment.cgi?id=165751&amp;action=edit" title="Docuware for the graduation/move/release review">[details]</a></span> Docuware for the graduation/move/release review  Incorporated comments from Andrew Johnson The EMO has scheduled a review using the docuware attached here. I close the ticket now.	
299371	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1263260400000	1274211120000		MAT API changes for 1.0	The 1.0 release which we are planning is a good point to look again at the APIs provided by MAT and reconsider if some modifications are necessary.   Let us use this message to discuss and track what changes need to be/are done to MAT API for the 1.0 release.  As a basis I have  collected some info about the currently exported packages and the public classes/methods inside. I have attached it as a CSV file.  The summary of it is: Bundle        /    Exposed Method Count org.eclipse.mat.report        476 org.eclipse.mat.api        400 org.eclipse.mat.parser    275 org.eclipse.mat.hprof        2 org.eclipse.mat.chart    0 org.eclipse.mat.chart.ui    0 org.eclipse.mat.dtfj    0 org.eclipse.mat.jdt    0 org.eclipse.mat.tests    0 org.eclipse.mat.ui    0 org.eclipse.mat.ui.help    0 org.eclipse.mat.ui.rcp    0 Created <span class=""><a href="attachment.cgi?id=155860" name="attach_155860" title="Methods exposed as API in MAT 8.0">attachment 155860</a> <a href="attachment.cgi?id=155860&amp;action=edit" title="Methods exposed as API in MAT 8.0">[details]</a></span> Methods exposed as API in MAT 8.0 Some time ago Andrew has suggested that it will be useful to have a method in the ISnapshot for getting the reachable set of an object. Shall we add this to the API? Should IStackFrame.getLocalObjectsIds() return null or an empty array?  Is there a meaningful difference between those? An empty array might be easier for users. Currently the IStackFrame.getLocalObjectsIds() will return a null if there are no local objects. The implementation is in ThreadStackHelper.buildFrames(). I think I left it null to avoid creating the empty arrays. However, you are right that using the API will be easier if an empty array is returned (one if statement less). In any case we have to describe the return values in javadoc. I just created another message to track this - <span class="bz_closed"><a href="show_bug.cgi?id=301664" title="RESOLVED FIXED - Add javadoc to IStackFrame and IThreadStack">Bug 301664</a></span>. ObjectReference has a field     private transient ISnapshot snapshot;  which will never be initialized after deserialization. Is this a problem? The reachable set could be used for WeakHashMap problems - finding if referent is also strongly reachable from the map or key.  The reachable set could be done from a set of objects, not just a single object. The API therefore should be like the retained set query, with the exclusions.  It would also be good to have a general paths computer, from one set of objectIds to another. This also should have exclusions.  Way of specifying exclusions: Retained set: field names (for any object?) - quite general, possibly slow as fields need to be retrieved for every object in path  Retained set: ExcludedReferencesDescriptor[] has list of objectIds and field names to exclude - could filter on objectIds quickly, overridden field names can't be separated.  GCRoots computer Map&lt;IClass, Set&lt;String&gt;&gt; - quick to find objects to exclude as just a small set of classes - so go from object to class to see if class extends excluded class. Can overridden field names be separated? I.E. is the field name in the specified class? This doesn't allow a subset of instances of a class to be excluded. (In reply to <a href="show_bug.cgi?id=299371#c6">comment #6</a>) <span class="quote">&gt; The reachable set could be used for WeakHashMap problems - finding if referent &gt; is also strongly reachable from the map or key. &gt;  &gt; The reachable set could be done from a set of objects, not just a single &gt; object. The API therefore should be like the retained set query, with the &gt; exclusions. &gt;  &gt; It would also be good to have a general paths computer, from one set of &gt; objectIds to another. This also should have exclusions. &gt; </span > It can also be useful to have inclusions, not exclusions. E.g. for a linked list, the reachable set of type of node gives you all of the nodes. ISnapshot.getHeapSize() should be able to handle very large arrays. Whats the reason for the  FieldDescriptor.setName() FieldDescriptor.setType()  methods? Should FieldDescriptor be unmodifiable? The only reason for  Field.setValue  seems to be so that the ObjectReference from a deserialized static field can be replaced by one with a reference to the current snapshot. Is that the cleanest way? I haven't found any usages of  FieldDescriptor.setName() FieldDescriptor.setType() I guess we can either remove them or make them protected and just check if our tests are still running.  For Field.setValue() I think we can also remove. In the only place where it is used we can simply create a new instance and replace the old one, instead of setting the value.  Let us just mention the changes to FieldDescriptor and Field in a separate message. It is easier to get an overview of the changes later, just looking at the message titles. I've changed ArrayInt long firstElement() to int firstElement() long lastElement() to int lastElement()  There are no uses in the product, and the return type of long must be a bug. Is there a reason that   DominatorQuery.java MultiplePath2GCRootsQuery.java Path2GCRootsQuery.java ShowInDominatorQuery.java  are in the package org.eclipse.mat.snapshot.inspections, and not in a package org.eclipse.mat.inspections.snapshot or similar?  If those queries were in the org.eclipse.mat.inspections subpackage then all the queries would be in the same part of the tree (and it might be easier to separate them into a separate plug-in). (In reply to <a href="show_bug.cgi?id=299371#c12">comment #12</a>) <span class="quote">&gt; are in the package org.eclipse.mat.snapshot.inspections, and not in a package &gt; org.eclipse.mat.inspections.snapshot or similar?</span >  I think I moved some time ago, because the whole inspection package was not public at all. And below snapshot it was public.  So: no good reason -&gt; go ahead and move it to a better place. These 4 queries are directly used in the UI (org.eclipse.mat.ui plugin) - there are some specific panes for them. I would like to make their package accessible to mat.ui only. The rest of the queries we should be fully hidden. I reduced the visibility of the package to the UI only (see <span class="bz_closed"><a href="show_bug.cgi?id=309766" title="RESOLVED FIXED - Hide exposed snapshot inspections">bug 309766</a></span>).  There is still a way to execute a query - the SnapshotQuery class. It has methods to lookup a query, set it's parameters and execute it. Initially I was thinking to hide this class also. Currently I think that instead of hiding it I will enrich it with a method to get the list of query arguments. Then the class will have all the neccesary methods: look up a query, get the description of the arguments, set arguments and execute it. To do this I'll move ArgumentDescriptor to a public package.  I have to describe then that the names/arguments of the queries are not part of the API and can change, and that SnapshotQuery should be used with care.   Do you think this is fine, or shall I rather hide the class. Fully hiding it  will leave no way to interact with our queries from queries outside the api plugin. This may be sometimes needed. Any comments? I did the changes from my last comment. I documented them in more detail in <span class="bz_closed"><a href="show_bug.cgi?id=309818" title="RESOLVED FIXED - Improve the API for looking up a query">bug 309818</a></span> Currently IClass extends IObject, whereas IClassLoader extends IInstance.  IObject   IArray     IObjectArray     IPrimitiveArray   IInstance     IClassLoader   IClass   Now IBM Java 6 dumps do have Java objects associated with each Java class, of type java.lang.Class and so classes are more like instance objects (rather than arrays or their own non-instance type).  Both HotSpot and IBM dumps appear to have instance fields on java.lang.Class.  Should it be possible to see these fields with IClass.getField() ?  examples of per-instance fields of java.lang.Class, with some example value for a class:  Type|  Name            |   Value  ----------------------------------------------------------------------- long| vmRef            | 1458304  ref | classLoader      | com.ibm.oti.vm.BootstrapClassLoader &#64; 0xc889f0  ref | protectionDomain | null  ref | classNameString  | null  -----------------------------------------------------------------------   Should IClass extend IInstance instead of IObject? If not, should ClassImpl implement IInstance or extend InstanceImpl? I've changed AnnotatedObjectDescriptor.addParamter-&gt;addParameter There are many instances of   &#64;Argument(flag = &quot;none&quot;)  Should the &quot;none&quot; be a constant? (In reply to <a href="show_bug.cgi?id=299371#c19">comment #19</a>) <span class="quote">&gt; There are many instances of  &gt; &#64;Argument(flag = &quot;none&quot;) &gt; Should the &quot;none&quot; be a constant?</span >  Yes, I think it would be better to add a constant somewhere. (In reply to <a href="show_bug.cgi?id=299371#c20">comment #20</a>) <span class="quote">&gt; (In reply to <a href="show_bug.cgi?id=299371#c19">comment #19</a>) &gt; &gt; There are many instances of  &gt; &gt; &#64;Argument(flag = &quot;none&quot;) &gt; &gt; Should the &quot;none&quot; be a constant? &gt;  &gt; Yes, I think it would be better to add a constant somewhere.</span > I've added a constant Argument.UNFLAGGED used as follows:      &#64;Argument(flag = Argument.UNFLAGGED)  If this is acceptable as a name then I can go through and make minor changes to queries to use this instead of      &#64;Argument(flag = &quot;none&quot;) and also QueryRegistry.fromAnnotation() (In reply to <a href="show_bug.cgi?id=299371#c21">comment #21</a>) <span class="quote">&gt; If this is acceptable as a name then I can go through and make minor changes to &gt; queries to use this instead of  &gt;     &#64;Argument(flag = &quot;none&quot;) &gt; and also QueryRegistry.fromAnnotation()</span >  I think the name is fine. Just go on and to the related changes. Thanks! The 1.0 release is now published. I close this ticket.	
299497	normal	FIXED	Dummy Inbox	andrew_johnson	1263349200000	1263758940000		DTFJ Adapter retains memory	Reported problem: the DTFJ Adapter can retain memory even when all dumps and Memory Analyzer windows are closed.  Reason: DTFJ Images are expensive to open as they can require the unzipping of dumps or complex PHD processing. The images are retained via a soft reference cache. If the heap got full then the cache entries would be freed, but if the user switches to another program then the heap will not be shrunk. Solution: Keep a count of DTFJ images in use - then 30 seconds after the use count gets to zero clear the cache. This allows the user to reopen a dump shortly after closing it, but keeps memory usage down. The DTFJ images are released 30 seconds after the last DTFJ image is closed. This timer is cleared if a dump is opened within the 30 seconds.	
300676	normal	FIXED	Dummy Inbox	andrew_johnson	1264381800000	1265148900000		Improve information about available queries	I have had a request from a user who wanted to understand what all those options (queries) are, including those sub menu items.  There are several aspects to this.  The query browser doesn't list all the queries, and the UI isn't ideal - there's no way to select with a mouse without invoking the query, it's hard to select all of one category etc..  The query browser isn't available from context menu.  Some queries don't have help.  The HTML help doesn't have a queries reference. I've got some code to improve the query browser. Good points.  I personally also like the Ctrl-Q functionality. It shows a popup where you can filter queries just by typing. We can improve here too, because on Mac OS X that currently maps to Cmd-Q which, of course, quits the application. I've put in some initial changes. Once a filter is given then all the queries are displayed (with scroll bars if necessary). The 'All queries' button allows all queries to be browsed. The query browser now allows categories to be selected. Double-click is required to run a query (because single click is needed to move to a query in a long list). Command line usage is now displayed in the help (so that copying a query also finds in the list). The enum alternatives are displayed in this help. The query browser now can show all the queries, and appears with the context menu. I've updated individual query help text. The query argument wizard now shows the category in the title.  I'll raise concerns about the accelerator (Ctrl-Q) as a separate defect.	
301543	minor	FIXED	Dummy Inbox	andrew_johnson	1265078520000	1265153760000		No objects shown in top of stack	The thread stack query doesn't show any objects in the top stack frame. Minor fix - the stack parsing code was expecting the line to be &gt; 0, but the top stack frame has line=0:  Thread 0x323903f0   at java.io.FileInputStream.readBytes([BII)I (Native Method)   at java.io.FileInputStream.read([BII)I (FileInputStream.java:199)   at java.io.BufferedInputStream.fill()V (BufferedInputStream.java:218)   at java.io.BufferedInputStream.read()I (BufferedInputStream.java:237)   at org.eclipse.mat.tests.CreateSampleDump.main([Ljava/lang/String;)V (CreateSampleDump.java:27)    locals:     objecId=0x32391a88, line=0     objecId=0x32391a88, line=0     objecId=0x323932b8, line=1     objecId=0x323932c8, line=1     objecId=0x32392048, line=2     objecId=0x323932c8, line=2     objecId=0x32392048, line=3     objecId=0x32390338, line=4     objecId=0x32390348, line=4     objecId=0x32390318, line=4  This is a good opportunity to add some unit tests. Changed line number test to &gt;= 0.	
301664	minor	FIXED	Krum Tsvetkov	krum.tsvetkov	1265138400000	1265247660000		Add javadoc to IStackFrame and IThreadStack	Let's decide if the IStackFrame.getLocalObjects and IThreadStack.getStackFrames() should return null or empty arrays, and write javadoc for these interfaces. The implementation of IClass.getObjectIds() returns an int[0] if there are no objects. To stay consistent I have changed the implementation of IStackFrame.getLocalObjectsIds() to do the same (instead of returning null).  I added javadoc to the IStackFrame describing this. Added javadoc also to IThreadStack.	
301970	normal	FIXED	Dummy Inbox	andrew_johnson	1265337480000	1267564020000		DTFJParser retries opening bad dumps	If the DTFJ parser is given a bad dump it can attempt to open it 3 or more times.  This is because after trying to open a dump with and without a metadata file, it has a final go at opening the dump without a metadata file.  Also, a parser is added to the parser list for each file extension that matches. DTFJ-J9 has .dmp.zip and .zip as file extensions, so abc.dmp.zip gets the DTFJ-J9 parser twice. This is unnecessary. Fix DTFJIndexBuilder to build a list of files to try (without duplicates) and ParserRegistry to only add a parser once. Now fixed as described.	
303444	minor	FIXED	Dummy Inbox	andrew_johnson	1266739440000	1266812340000		Run Report fails with spaces in report xml directory names	Error message:  No unflagged arguments available  org.eclipse.mat.ui.actions.RunRegisteredReportAction.run() needs to protect the filename ready for parsing.  Perhaps the error message should be better. We could use Converters.convertAndEscape to protect the special characters.  convertAndEscape needs enhancing to cope with backslashes.  E.g. Query history doesn't work with find_strings looking for one backslash.  Also, it doesn't cope with other whitespace characters.  Single backslashes don't need escaping, but two do, or \&quot;  E.g. \\machine\resource\file.xml  needs converting to  \\\machine\resource\file.xml  as the tokenize will convert \\\ to \\  We could convert it to   \\\\machine\\resource\\file.xml  but that might be more confusing to users?  C:\Documents and Settings\Administrator\My Documents\report.xml to &quot;C:\Documents and Settings\Administrator\My Documents\report.xml&quot;  rather than &quot;C:\\Documents and Settings\\Administrator\\My Documents\\report.xml&quot; I've updated Converters.convertAndEscape  I've also changed the command line messages for bad queries slightly:  No unflagged parameters available for argument 'abc'  Query 'Unreachable Objects Histogram' has no argument 'abc'  Missing value for argument 'pattern' ( -pattern )   find_strings with a pattern of \\ gets stored in the history as  find_strings -pattern \\\  so that the tokenizer removes one backslash, passing the remaining two to the regular expression parser.	
303596	minor	FIXED	Dummy Inbox	andrew_johnson	1266871440000	1267564080000		Avoid CorruptDataException when opening truncated javacore	A truncated javacore file can be parsed, but not opened as finding the address space from the JavaRuntime fails.  The fix is to return the ImageAddressSpace, ImageProcess and JavaRuntime together when opening a dump. Simplify the DTFJ adapter to return all three DTFJ objects on opening a dump. Now fixed as described.	
305150	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1268096520000	1268790720000		Improvements for the Compare Basket View	The initial version of the Compare Basket View has to be improved. Here the comments from <a href="show_bug.cgi?id=298078" title="ASSIGNED - Comparison Features in MAT">bug 298078</a>:  The Compare basket works quite well and is similar to, but more flexible than previous histogram comparison.  - it would be nice to delete a selection from the compare basket - should 'compare' only compare the selected items (if more than one selected)? - should the menu items be left justified? - the results items should also indicate the dump they are from - there isn't yet a context menu I submitted the improvements. Comments inlined below:  <span class="quote">&gt;&gt; - it would be nice to delete a selection from the compare basket</span > added delete of one or several selected results  <span class="quote">&gt;&gt; - should 'compare' only compare the selected items (if more than one selected)?</span > I'd prefer comparing everything in the basket. Now one has the possibility to delete unnecessary stuff.  <span class="quote">&gt;&gt; - should the menu items be left justified?</span > Now I added icons to the menu items, and the menu doesn't look so odd. It's the standard view toolbar on the left side.  <span class="quote">&gt;&gt; - the results items should also indicate the dump they are from</span > added a second column showing the heap dump  <span class="quote">&gt;&gt; - there isn't yet a context menu</span > added context menu with the context sensitive actions -&gt; move up/down, remove	
306803	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1269295920000	1269298140000		Not possible to traverse the Overview Pane with the TAB key	It is not possible to traverse the OverviewPane using the tab key. After &quot;Biggest Objects Retained By size&quot; the TAB key doesn't work any longer. Neither the arrow keys do. Going back is also not possible. I added a TraverseListener to the canvas which was used (svn revision 597). Now using the TAB key one can go through the whole Overview page.  I'm not quite sure that going through the chart and the text below it makes much sense, but this is what I achieved at my first go. My second attempt gave better results. Now the TAB navigation inside the overview page works as I have expected it to be. Closing the bug as it was fixed with svn revision 598	
307176	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1269566340000	1269566700000		Using Enter in the Snapshot History View has doesn't open the snapshot	Using Enter in the Snapshot History View has doesn't open the snapshot. It is still possible to open the snapshot via the context menu, but this is inconvenient. Should be possible to open the snapshots with pressing Enter. I submitted some changes which enable opening the heap dump with Enter.	
307396	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1269829560000	1270070760000		It is not possible to set the sorting column of trees and tables in MAT using keyboard	Changing the sorting column and direction for the table and tree results in MAT is essential for the effective troubleshooting. Currently this is not possible to be performed via a keyboard. As I wasn't sure if there is a standard way to do this I asked in the SWT forum: <a href="http://www.eclipse.org/forums/index.php?t=msg&amp;th=165230&amp;start=0">http://www.eclipse.org/forums/index.php?t=msg&amp;th=165230&amp;start=0</a>&amp;  The answer is that there is no standard way. We should add this possibility to the context menus on the displayed results. I moved all the columns related context menus under a common node &quot;Columns...&quot; and added there &quot;Sort by&quot;. The latter gives the possibility to change the sorting column. Selecting the already selected sorting column will change the sort direction.	
308047	normal	FIXED	Dummy Inbox	andrew_johnson	1270362360000	1277194560000		Top Components report is misleading for PHD files	Portable Heap Dump files do not have field names, primitive field values or primitive array values.  The component report from a PHD file has a lot of missing information or misleading information. E.g. Duplicate strings - many false positives as char arrays have no contents. Found 24 occurrences of char[] with at least 10 instances having identical content. Total size is 122,160 bytes.  Top elements include:  10 x \u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u... (8,579 bytes) 147 x \u0000\u0000\u0000\u0000\u0000\u0000 (32 bytes) 24 x \u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u... (192 bytes) 67 x \u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u... (40 bytes) 64 x \u0000\u0000\u0000\u0000\u0000 (32 bytes)  This section is worthless for PHD files, so should be omitted.   Empty Collections All the collections are marked as size 0, as no size field is available.   Empty Collections Comment No excessive usage of empty collections found.   Details  java.util.TreeMap Length # Objects Shallow Heap Retained Heap  0 2 96 &gt;= 1,296    java.util.IdentityHashMap Length # Objects Shallow Heap Retained Heap  0 2 80 &gt;= 776    java.util.Vector Length # Objects Shallow Heap Retained Heap  0 22 704 &gt;= 2,656    Collection Fill Ratios No sensible information is given as all collections are marked as size 0, so with fill ratio 1.0   Collection Fill Ratios Comment No serious amount of collections with low fill ratios found.   Details  java.util.IdentityHashMap Fill Ratio # Objects Shallow Heap Retained Heap  &lt;= 1.00 2 80 &gt;= 776    java.util.Vector Fill Ratio # Objects Shallow Heap Retained Heap  &lt;= 1.00 22 704 &gt;= 2,656   Map Collision Ratios No sensible information is given as all collections are marked as size 0, so with collision ratio 0.0   Map Collision Ratios Comment No maps found with collision ratios greater than 80%.   Details  java.util.LinkedHashMap Collision Ratio # Objects Shallow Heap Retained Heap  &lt;= 0.00 2 112 &gt;= 432 It is possible to get useful data for collections from PHD files.  Some Java 5 PHD files don't have superclass information or object array length data.  CommonNameResolver - needs to return null, not &quot;null&quot; for primitive wrapper classes for PHDs.  WasteInCharArraysQuery - disable for PHDs  Collection size - using CollectionUtil.getSize():  Vector, ArrayList Find the backing array by choosing the only object array ref from the collection object. If the field name has dots i.e. is found by resolving several fields then search for plain object refs first, then find an object array ref. Then count non-null entries in the array.  Consider an optimization - reading object array elements is slow for PHDs, so consider using outbound refs. These exclude duplicates, but if there is only one outbound ref (the type of the array) or len+1 (all entries are filled with unique values) then we need not go to the elements.  HashMap, HashSet, Hashtable etc. Find the backing array as for ArrayList. non-null entries are the nodes, count the nodes, also count chained nodes via references to objects of same type. Known superclasses of HashMap, Hashtable etc. need to be mentioned in CollectionUtil for Java 5 PHD files without superclass data.  LinkedHashSet etc. As for HashMap etc., but the nodes are also chained via a doubly-linked list, so follow all chained nodes, using a list to handle multiple outbound refs, use a visited bitfield to exclude already visited nodes. Also exclude the base node referred to from the collection class.  LinkedList As for LinkedHashSet etc. but find the header node from the collection, then follow the links from there.  CollectionFillRatioQuery Some older Java 5 PHDs have no array length data, so the length is inaccurately reported as just the number of non-null entries. This gives fill ratios &gt; 1.0 (as some nodes are chained.) Fill ratios &gt; 1.0 are possible for real too, so this query should accumulate ratios up to say 5.0 before going to Double.MAX_VALUE.  CollectionsBySizeQuery - works when CollectionUtil getSize works  ExtractListValuesQuery Extract the head of the list as for CollectionUtil.getSize The list is doubly linked, so just whichever of the links from a node is not a backwards link to the previous node, until the start is reached. Extract the values objects as referenced object which is not a node.  HashEntriesQuery This should be disabled for PHDs as the key and value links from the Map.Entry can't be distinguished.  HashSetValueQuery As for LinkedHashSet size - the value from a node is an outbound reference, not to its class or another node.  MapCollisionRatio Uses size and non-null entries in the backing array  PrimitiveArraysWithAConstantValue - disable for PHDs I'll make the changes as described.  I do have a concern that this will make the TopComponents report too slow for PHD files as calculating the size of a collection now involves a lot of work. Is the TopComponents report currently useful just for Top Consumers/Retained Set/Soft References/Weak References ? The finalizer query is missing information too - IBM dumps have GCRoot type UNFINALIZED for objects in use which will need to be finalized, and FINALIZABLE for ones ready to have their finalizers run. I'll add a -aggressive option to the ComponentReport and TopComponents queries which for PHD files will force Empty Collections, Collection Fill Ratios and Map Collision Ratios analyses, even though these will take a long time. All fixes done.	
308310	normal	FIXED	Dummy Inbox	andrew_johnson	1270591500000	1273216320000		ISnapshot API doesn't handle very large arrays	It is possible for some array objects to be bigger than Integer.MAX_VALUE. E.g. long big[Integer.MAX_VALUE]; could be approximately 0x400000008L bytes in length.  int ISnapshot.getHeapSize()  limits the size to Integer.MAX_VALUE, and the array size index file stores ints.  We need to consider how to deal with these very large objects, preferably maintaining some compatibility with previous versions. Changing ISnapshot.getHeapSize to return a long also means changing long IObject.getUsedHeapSize() long AbstractObjectImpl.getUsedHeapSize() long ClassImpl.getUsedHeapSize() ClassImpl.addInstance(long usedHeapSize) ClassImpl.removeInstance(long usedHeapSize) long InstanceImpl.getUsedHeapSize() long ObjectArray.getUsedHeapSize() long PrimitiveArray.getUsedHeapSize()  should ClassImpl.setHeapSizePerInstance() and ClassImpl.getHeapSizePerInstance()  be changed? These are only valid for non-array objects, so won't ever overflow an int.  These changes then cause some minor changes elsewhere:  e.g. ArrayBySizeQuery ThreadInfoImpl DominatorQuery MultiplePaths2GCRootsQuery Path2GCRootsQuery GarbageCleaner SnapshotImpl Changing the return type of a method is not a binary compatible change, so any user plug-ins using getUsedHeapSize would need to be recompiled.  Is this acceptable? Should we add a getShallowHeapSize (or similar name, suggestions welcome) and deprecate getUsedHeapSize? Should we ignore just the problem and limit the sizes to Integer.MAX_VALUE? I think that as there are real cases where using int is a limitation, we need to change, and we shouldn't ignore the problem. I though what would be the most acceptable way to change, and I think we should follow your suggestion to deprecate the old method and offer a new one:  long getShallowHeapSize(int objectId) throws SnapshotException;  This way we won't break external queries that used this method. And we will have the time to adapt MAT own queries to use the new one.  One thing which I am curious about - what would be the impact on performance / memory consumption? I suggest that we do some measurements before/after of building histograms - this is a very common operation, part of most queries. The parser interface needs to be changed slightly to accumulate sizes as longs.  IOne2SizeIndex extends IOne2OneIndex but adds a long getSize(int index) method.  SizeIndexCollectorUncompressed instead of IntIndexCollectorUncompressed allows array sizes of longs to be accumulated in an int array.  In the writeTo method a SizeIndexReader then wraps the IntIndexReader returned from the IntIndexStreamer.  This SizeIndexReader can uncompress a size using the getSize() method.  The IndexManager needs to use the SizeIndexReader for array sizes.  Uses of array2Size.get() need to be changed to getSize() I've changed  ClassImpl.setHeapSizePerInstance() ClassImpl.setUsedHeapSize() and IClass.getHeapSizePerInstance() to use longs too. There isn't an immediate need, but it makes the parser code cleaner, and it's better to change the APIs in one go. The API is now fixed for large arrays. Methods of encoding a large size will need to be done later.	
309766	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1271706120000	1271706480000		Hide exposed snapshot inspections	Several snapshot inspections/queries are exposed as public API. They are however not prepared to be used as public API. This holds still for all the queries which come with MAT. Therefore we should hide the package. org.eclipse.mat.internal.snapshot.inspections I  added &quot;internal&quot; to the package name, and opened it only to the UI plugin.  in MANIFEST.MF: org.eclipse.mat.internal.snapshot.inspections;x-friends:=&quot;org.eclipse.mat.ui&quot;,	
309818	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1271730660000	1271731080000		Improve the API for looking up a query	The Queries in MAT are not part of the public API. This should stay like this for now. However, it may be useful to have a way to lookup a query (and there is a way), set its parameters and execute it. The org.eclipse.mat.snapshot.query.SnapshotQuery class provides such API. It however doesn't expose methods for inspecting the annotations of the query and the annotated parameters.   1) the SnapshotQuery class has to be enriched with methods giving meta data about the parameters a query expect, as well as getting the annotations for the query like Help, Icon, etc... 2) It should be made clear in the Javadoc that the MAT queries are not part of the API and their names, classes and parameters may change I have committed some changes which: 1) expose as API two read only descriptors for annotated parameters and annotated objects (with Help, Icon, etc...). These are in the report plugin,  org.eclipse.mat.query.annotations.descriptors  2) added the following methods to the SnapshotQuery class in the .api plugin     public List&lt;? extends IArgumentDescriptor&gt; getArguments()     public IAnnotatedObjectDescriptor getDescriptor()  3) deprecated the SnapshotQuery.set() method and added an equivalent SnapshotQuery.setArgument() just to have consistent naming	
310236	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1271966520000	1273516800000		Annotate new API methods with @since	After the review we should be able to change the versions to 1.0. Once we do this we should to annotate new API methods with &#64;since. I intentionally want to keep this to the last moment, do all changes at once and post a summary of all changes. Created <span class=""><a href="attachment.cgi?id=167866" name="attach_167866" title="Errors reported by the API tooling">attachment 167866</a> <a href="attachment.cgi?id=167866&amp;action=edit" title="Errors reported by the API tooling">[details]</a></span> Errors reported by the API tooling I annotated all new API which was added after the formal 0.8 release (our Galileo relelase) with &#64;since 1.0  The attached text file contains the errors reported from the API tooling before I made the changes. From the errors one can see all new API  methods, fields and classes which were added, as well as all the ones which were removed.	
310439	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1272240900000	1273516920000		Update documentation for 1.0	Before making the next release we need to review the documentation and make adjustments where necessary.  I am looking into this topic and will use this message to track the changes made. I have gone through the basic tutorial, concepts, and tasks sections of the documentation and made the following changes: - typo in the basic tutorial - modify heap dumps explanation not to be HPROF specific - small changes to shallow size definition - small changes to the dominator tree page (wording) - Enhanced the description how to get heap dumps - added sections for IBM dumps and also for the Acquire functionality within MAT - correction in &quot;analyzing classloaders&quot; to make VM agnostic. - updated screenshot and typo fixes in &quot;analyzing finalizers&quot; - enhanced the &quot;analyze threads&quot; section - added description for the thread stacks - updated screenshots and description on the &quot;export data&quot; page - provided more description what the immediate dominators is useful for in &quot;findresponsibleobjects.html&quot;  There is still the &quot;reference&quot; section to be reviewed. At first glance it seems to that this part needs much more rework than the others. I'll see how far I can get with this one for 1.0.  I will also need to do some more work on the New &amp; Noteworthy document, as well as on the &quot;Running leak suspects&quot; document.  Andrew, can you look at the DTFJ specific description in the acquire heap dump document? I did update some of the documentation under /reference plus the /tasks/runleaksuspects.html. I think I'm done with the changes which were reasonable to do for 1.0.  I'll leave the bug open for now in case there is some feedback on the changes. I've updated the acquire heap dump section. I've updated some text and links in org.eclipse.mat.ui tutorials. I've fixed the context help for the acquire heap dump wizard. I added the (missing) required legal notice to the documentation. See <a href="http://eclipse.org/legal/guidetolegaldoc.php">http://eclipse.org/legal/guidetolegaldoc.php</a> , 4.5. Notices in documentation All changes to the documentation which were planned for the 1.0 release are already made. I close this ticket.	
312035	normal	FIXED	Dummy Inbox	krum.tsvetkov	1273184340000	1277427780000		Copyright meta-data in the HTML Documentatio pages generated by DITA is wrong	I figured out many of the copyright headers of the source files are outdated. I'll have a look and use the copyright tool [1] to fix any errors.  [1] <a href="http://wiki.eclipse.org/How_to_use_Eclipse_copyright_tool">http://wiki.eclipse.org/How_to_use_Eclipse_copyright_tool</a> I've updated the copyright statements for files in org.eclipse.mat.api that I know I've made changes to. The other files need the date changed. There might be a few that I've changed that I missed - I can add those later.  I've updated the copyright statements in org.eclipse.mat.dtfj + org.eclipse.mat.ibmdumps. I finished updating the copyright note to our source files.  I also added it to the .dita files in the help plugin.   One thing still bothers me - if I open the generated .html files I see inside the following metadata: &lt;meta name=&quot;copyright&quot; content=&quot;(C) Copyright 2005&quot;/&gt; &lt;meta name=&quot;DC.rights.owner&quot; content=&quot;(C) Copyright 2005&quot;/&gt;  I don't know currently how to replace the date with something meaningful. I 'll have to search for a way to do it. Hints are welcome. I change the description to reflect the current state I added the following fragment to all our .dita files. After this the generated HTML files contain proper meta-data. I think now also the generated HTML pages are OK, and I'm closing the bug      &lt;prolog&gt;         &lt;copyright&gt;             &lt;copyryear year=&quot;&quot;&gt;&lt;/copyryear&gt;             &lt;copyrholder&gt;                 Copyright (c) 2008, 2010 SAP AG and others.                 All rights reserved. This program and the accompanying materials                 are made available under the terms of the Eclipse Public License v1.0                 which accompanies this distribution, and is available at                 <a href="http://www.eclipse.org/legal/epl-v10.html">http://www.eclipse.org/legal/epl-v10.html</a>             &lt;/copyrholder&gt;         &lt;/copyright&gt;     &lt;/prolog&gt;	
312567	normal	FIXED	Dummy Inbox	krum.tsvetkov	1273614900000	1273775640000		Snapshots not released after using Search Queries context menu and closing them	I just noticed that if I work with a snapshot and use the context menu &quot;search queries&quot; , then after I close the snapshot editor the snapshot is still kept in memory. I'll attach some reference chains keeping the snapshots. Created <span class=""><a href="attachment.cgi?id=168108" name="attach_168108" title="Reference chain keeping the SnapshotImpl instance">attachment 168108</a> <a href="attachment.cgi?id=168108&amp;action=edit" title="Reference chain keeping the SnapshotImpl instance">[details]</a></span> Reference chain keeping the SnapshotImpl instance Created <span class=""><a href="attachment.cgi?id=168112" name="attach_168112" title="Path through QueryContextMenu$QueryAction">attachment 168112</a> <a href="attachment.cgi?id=168112&amp;action=edit" title="Path through QueryContextMenu$QueryAction">[details]</a></span> Path through QueryContextMenu$QueryAction  I noticed another similar effect - snapshotImpl being held, probably with a different cause. Still the context menu is involved, so I paste it to the same bug. We may need to close the QueryContextHelp and dispose the styled text and clear the fields. Here's the path I fixed with the QueryContextHelp change:  Class Name                                                                                 | Shallow Heap | Retained Heap  -------------------------------------------------------------------------------------------------------------------------- org.eclipse.mat.parser.internal.SnapshotImpl &#64; 0x1105370                                   |           72 |     5,879,992  '- org.eclipse.mat.internal.snapshot.SnapshotQueryContext &#64; 0x1abef80                      |           16 |     5,880,008     '- org.eclipse.mat.ui.internal.browser.QueryContextHelp &#64; 0x1adde70                     |          152 |     5,881,344        '- org.eclipse.jface.window.Window$FontChangeListener &#64; 0x1ade038                    |           16 |     5,881,360           '- [4] java.lang.Object[6] &#64; 0x1b00d30                                            |           40 |     5,884,104              '- org.eclipse.core.runtime.ListenerList &#64; 0xbf7730                            |           24 |     5,884,128                 '- org.eclipse.jface.resource.FontRegistry &#64; 0xbae400                       |           32 |     5,885,728                    |- class org.eclipse.jface.resource.JFaceResources &#64; 0xbaacb8            |           64 |           536                    |  '- org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader &#64; 0xb5f4f8|           96 |        26,616  -------------------------------------------------------------------------------------------------------------------------- I've also put a fix in QueryBrowserPopup to close the help.  <a href="http://www.eclipse.org/articles/swt-design-2/swt-design-2.html">http://www.eclipse.org/articles/swt-design-2/swt-design-2.html</a> Is this now fixed? I did some more tests and couldn't reproduce the problem any longer. Andrew, thanks for the very fast fixes!	
312594	normal	FIXED	Krum Tsvetkov	krum.tsvetkov	1273622400000	1277342100000		SnapshotImpl instance kept by ExecutionJob after closing the editor	I noticed that after closing the snapshot editor the SnapshotImpl instance is still kept in memory. Looking at the heap dump revealed that there is sometimes a QueryExecution$ExecutionJob still referenced by the eclipse ProgressManager.   I'll attach a screenshot with the paths to the SnapshotImpl and will look into this problem. Created <span class=""><a href="attachment.cgi?id=168125" name="attach_168125" title="Path keeping the SnapshotImpl alive">attachment 168125</a> <a href="attachment.cgi?id=168125&amp;action=edit" title="Path keeping the SnapshotImpl alive">[details]</a></span> Path keeping the SnapshotImpl alive  This is the path keeping the SnapshotImpl alive. I noticed that sometimes the job stays displayed in the &quot;Progress&quot; view. If this happens then our instance of ExecutionJob keeps the Editor and other resources. To be on the safe side I will &quot;cleanup&quot; the job after it is executed. By cleanup I mean setting the problematic fields to null I submitted the changes from <a href="show_bug.cgi?id=312594#c1">comment 1</a>. I'll keep the message open for a while to investigate why sometimes the jobs disappear and sometimes they are left in the list of the Process view. The ClassReferrersQuery kept a reference to the ProgressListener it initially received and reused it afterwards on every tree expansion (i.e. every time the IResultTree.getChildren() method is called). This is wrong, as the job for which the progress listener was created is already finished and the listener has reported &quot;done&quot;. I removed fully the usage of progress listener while expanding this tree. May be we should design our IResult subclasses like IResultTree to support progress information and pass a proper listener to them. However this will be an API change which I'm not sure we really need.  With this small change I think the reported bug is solved. I close the message now.	
312623	blocker	FIXED	Erwin Margewitsch	elkner	1273629060000	1281495720000		RCP Solaris x86_64	Please provide a RCP bundle for RCP Solaris x86[_64] (not only for sparc). Since Galileo Solaris x86 is officially supported, so it shouldn't be a problem.  BTW: Since SPARC is more or less obsolete for desktops, one should expect, that x86 is much more important than SPARC wrt. development... I added two new configurations for building RCPs: linux,gtk,ppc64 and solaris,gtk,x86. Theses RCPs should be available for download at the beginning of next week. The new RCPs are available at <a href="http://www.eclipse.org/mat/downloads.php">http://www.eclipse.org/mat/downloads.php</a>  The RCPs are for linux,gtk,ppc64 and solaris,gtk,x86.  Despite the title of this report &quot;RCP Solaris x86_64&quot; there is no support for solaris,gtk,x86_64, only for solarris,gtk,x86. The current bundle (<a href="http://www.eclipse.org/downloads/download.php?file=/mat/latest/rcp/MemoryAnalyzer-1.0.0.20100520-solaris.gtk.x86.zip">http://www.eclipse.org/downloads/download.php?file=/mat/latest/rcp/MemoryAnalyzer-1.0.0.20100520-solaris.gtk.x86.zip</a>) does not work out of the box:  To get it work, I copied eclipse-gtk-3.5/plugins/org.eclipse.swt.gtk.solaris.x86_3.5.2.v3557f.jar to mat/plugins/ and added the following sections to:  --- mat/features/org.eclipse.mat.dependencies.feature_1.0.0.201005201128/feature.xml.orig                                                                                                           Thu May 20 11:32:38 2010 +++ mat/features/org.eclipse.mat.dependencies.feature_1.0.0.201005201128/feature.xml                                                                                                                Tue Jun  1 15:52:03 2010 &#64;&#64; -191,6 +191,17 &#64;&#64;           unpack=&quot;false&quot;/&gt;      &lt;plugin +         id=&quot;org.eclipse.swt.gtk.solaris.x86&quot; +         os=&quot;solaris&quot; +         ws=&quot;gtk&quot; +         arch=&quot;x86&quot; +         download-size=&quot;0&quot; +         install-size=&quot;0&quot; +         version=&quot;3.5.2.v3557f&quot; +         fragment=&quot;true&quot; +         unpack=&quot;false&quot;/&gt; + +   &lt;plugin           id=&quot;org.eclipse.swt.gtk.linux.ppc&quot;           os=&quot;linux&quot;           ws=&quot;gtk&quot; &#64;&#64; -326,6 +337,16 &#64;&#64;           arch=&quot;sparc&quot;           download-size=&quot;0&quot;           install-size=&quot;0&quot; +         version=&quot;1.0.200.v20090519&quot; +         fragment=&quot;true&quot;/&gt; + +   &lt;plugin +         id=&quot;org.eclipse.equinox.launcher.gtk.solaris.x86&quot; +         os=&quot;solaris&quot; +         ws=&quot;gtk&quot; +         arch=&quot;x86&quot; +         download-size=&quot;0&quot; +         install-size=&quot;0&quot;           version=&quot;1.0.200.v20090519&quot;           fragment=&quot;true&quot;/&gt; Thanks for the feedback and the patch. I just wanted to give you a short update on this bug - we are currently working on a bugfix release (1.0.1). A working RCP for Solaris x86 should be one of the changes in it. However, we'll try to build the RCPs with 3.6 and I may need to modify the version numbers in the patch you proposed. 3.6 is fine - already upgraded our eclipse installations to 3.6. At least for me the version numbers in the patch do not matter - just used the ones from the  packages I found.  Thanx for your work, jel. At the end we went back to building the RCPs for 1.0.1 against a 3.5 Eclipse. I have added only one of the &lt;plugin&gt; fragments which you suggested, i.e. modified your patch to:  Index: feature.xml =================================================================== --- feature.xml    (revision 858) +++ feature.xml    (revision 876) &#64;&#64; -176,7 +176,18 &#64;&#64;           version=&quot;0.0.0&quot;           fragment=&quot;true&quot;           unpack=&quot;false&quot;/&gt; - +          +   &lt;plugin +         id=&quot;org.eclipse.swt.gtk.solaris.x86&quot; +         os=&quot;solaris&quot; +         ws=&quot;gtk&quot; +         arch=&quot;x86&quot; +         download-size=&quot;0&quot; +         install-size=&quot;0&quot; +         version=&quot;0.0.0&quot; +         fragment=&quot;true&quot; +         unpack=&quot;false&quot;/&gt; +           The generated RCP already contains the org.eclipse.equinox.launcher.gtk.solaris.x86 which your second &lt;plugin&gt; fragment was adding.  I set the IP log flag on the message to have your contribution recorded.  The changes to the xml I made in  /branches/1.0.x, revision 875 - this is where the service release for 1.0 will come from /trunk, revision 876  I have already the RCPs which I believe are the release ones, but haven't uploaded them yet. Will you be so nice to test the RCP for Solaris x86 in the next days before we publish the links on our web site. If you have the time for this, I'll give you the link once the content is there. (In reply to <a href="show_bug.cgi?id=312623#c6">comment #6</a>) <span class="quote">&gt; At the end we went back to building the RCPs for 1.0.1 against a 3.5 Eclipse. I &gt; have added only one of the &lt;plugin&gt; fragments which you suggested, i.e. &gt; modified your patch to:</span > ...  Whatever works is fine :)  <span class="quote">&gt; I have already the RCPs which I believe are the release ones, but haven't &gt; uploaded them yet. Will you be so nice to test the RCP for Solaris x86 in the &gt; next days before we publish the links on our web site. If you have the time for &gt; this, I'll give you the link once the content is there.</span >  Yes - I can do that on monday.  Regards, jel. I'm closing the as fixed. Seems that I can't get the marked entries in the IP log until they are open. I'll post more info afterwards. I've submitted the IP log and will wait for it before publishing the release. I put a release candidate RCP for Solaris x86 so that you can try it before we do the release.   <a href="http://download.eclipse.org/mat/latest/rcp/MemoryAnalyzer-1.0.1.RC1-solaris.gtk.x86.zip">http://download.eclipse.org/mat/latest/rcp/MemoryAnalyzer-1.0.1.RC1-solaris.gtk.x86.zip</a>   The org.eclipse.swt.gtk.solaris.x86_3.5.0.v3550b.jar plugin is now inside, so hopefully this time we built it correct. Feedback is appreciated. I managed to test this  - booted an Open Solaris from CD on my desctop PC - downloaded the zip from my last comment - unzipped it and started MAT without problem Now I safely leave the message closed. Meanwhile the IP log was approved, so we can relatively soon publish the RCPs on our download page.	
312876	minor	FIXED	Dummy Inbox	andrew_johnson	1273783620000	1273788480000		Improve batch mode error reporting	Currently if a bad file is passed to MAT in batch mode then the log is missing key data:  !ENTRY org.eclipse.osgi 4 0 2010-05-13 18:57:50.920 !MESSAGE Application error !STACK 1 org.eclipse.mat.SnapshotException: Error opening heap dump 'javacore.20100128.172536.454990.0001.txt'. Check the error log for further details.     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:239)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:114)     at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:143)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.parse(ParseSnapshotApp.java:106)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.start(ParseSnapshotApp.java:95)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:368)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)     at java.lang.reflect.Method.invoke(Method.java:618)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)     at org.eclipse.equinox.launcher.Main.run(Main.java:1311)     at org.eclipse.equinox.launcher.Main.main(Main.java:1287) Caused by: org.eclipse.core.runtime.CoreException: Error opening heap dump 'javacore.20100128.172536.454990.0001.txt'     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:237)     ... 17 more   The problem is that the individual parser errors are held in a CoreException MultiStatus which is lost.  In GUI mode the status is displayed. Error message is now:  Task: Processing DTFJ Image from file C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log [ !ENTRY org.eclipse.mat.parser 4 0 2010-05-14 09:36:56.984 !MESSAGE Error opening heap dump 'heapdump.20090614.204433.20785.0002.phd.inbound.index9.log' !SUBENTRY 1 org.eclipse.mat.parser 4 0 2010-05-14 09:36:56.984 !MESSAGE Unable to read dump C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log in DTFJ format DTFJ-J9 !STACK 0 java.io.IOException: Unable to read dump C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log in DTFJ format DTFJ-J9     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDynamicDTFJDump(DTFJIndexBuilder.java:7660)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getUncachedDump(DTFJIndexBuilder.java:7391)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDump(DTFJIndexBuilder.java:7289)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.fill(DTFJIndexBuilder.java:533)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:203)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:114)     at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:143)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.parse(ParseSnapshotApp.java:115)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.start(ParseSnapshotApp.java:101)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:169)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148) Caused by: java.io.FileNotFoundException: C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log.xml (The system cannot find the file specified.)     at java.io.FileInputStream.&lt;init&gt;(FileInputStream.java:112)     at com.ibm.dtfj.image.j9.ImageFactory.getImage(ImageFactory.java:79)     at com.ibm.dtfj.image.j9.ImageFactory.getImage(ImageFactory.java:65)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDynamicDTFJDump(DTFJIndexBuilder.java:7616)     ... 21 more !SUBENTRY 1 org.eclipse.mat.parser 4 0 2010-05-14 09:36:57.000 !MESSAGE Invalid HPROF file header. !STACK 0 java.io.IOException: Invalid HPROF file header.     at org.eclipse.mat.hprof.AbstractParser.readVersion(AbstractParser.java:135)     at org.eclipse.mat.hprof.Pass1Parser.read(Pass1Parser.java:69)     at org.eclipse.mat.hprof.HprofIndexBuilder.fill(HprofIndexBuilder.java:65)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:203)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:114)     at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:143)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.parse(ParseSnapshotApp.java:115)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.start(ParseSnapshotApp.java:101)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:169)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148) !SUBENTRY 1 org.eclipse.mat.parser 4 0 2010-05-14 09:36:57.000 !MESSAGE Unable to read dump C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log metafile null in DTFJ format DTFJ-PHD !STACK 0 java.io.IOException: Unable to read dump C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log metafile null in DTFJ format DTFJ-PHD     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDynamicDTFJDump(DTFJIndexBuilder.java:7642)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getUncachedDump(DTFJIndexBuilder.java:7391)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDump(DTFJIndexBuilder.java:7289)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.fill(DTFJIndexBuilder.java:533)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:203)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:114)     at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:143)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.parse(ParseSnapshotApp.java:115)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.start(ParseSnapshotApp.java:101)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:169)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148) Caused by: java.io.IOException: Problem opening dump C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log metafile null     at com.ibm.dtfj.phd.PHDImage.&lt;init&gt;(PHDImage.java:73)     at com.ibm.dtfj.phd.PHDImage.&lt;init&gt;(PHDImage.java:44)     at com.ibm.dtfj.phd.PHDImageFactory.getImage(PHDImageFactory.java:79)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDynamicDTFJDump(DTFJIndexBuilder.java:7616)     ... 21 more Caused by: java.lang.Error: bad header in 'C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log' :     ?&#64;gp#9h$g-??$z0OF HP         =)%#4At1SD     at com.ibm.jvm.ras.findroots.HeapdumpReader.&lt;init&gt;(HeapdumpReader.java:123)     at com.ibm.dtfj.phd.PHDImage.&lt;init&gt;(PHDImage.java:56)     ... 24 more !SUBENTRY 1 org.eclipse.mat.parser 4 0 2010-05-14 09:36:57.000 !MESSAGE Unable to read dump C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log metafile null in DTFJ format DTFJ-SDFF !STACK 0 java.io.IOException: Unable to read dump C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log metafile null in DTFJ format DTFJ-SDFF     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDynamicDTFJDump(DTFJIndexBuilder.java:7642)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getUncachedDump(DTFJIndexBuilder.java:7391)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDump(DTFJIndexBuilder.java:7289)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.fill(DTFJIndexBuilder.java:533)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:203)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:114)     at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:143)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.parse(ParseSnapshotApp.java:115)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.start(ParseSnapshotApp.java:101)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:169)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148) Caused by: java.io.IOException: Currently can only handle SDFF files, which _MUST have a suffix of &quot;.sdff&quot;_  or svcdumps     at com.ibm.dtfj.image.sov.ImageFactory.getImage(ImageFactory.java:101)     at com.ibm.dtfj.image.sov.ImageFactory.getImage(ImageFactory.java:137)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDynamicDTFJDump(DTFJIndexBuilder.java:7616)     ... 21 more Caused by: com.ibm.dtfj.sov.image.UnsupportedFormatException: C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log does not appear to be an svcdump     at com.ibm.dtfj.sov.svcReader.SvcImageImpl.&lt;init&gt;(SvcImageImpl.java:77)     at com.ibm.dtfj.image.sov.ImageFactory.getImage(ImageFactory.java:94)     ... 23 more Caused by: java.lang.Exception: bad magic: 09840e40     at com.ibm.jvm.svcdump.DumpReader.&lt;init&gt;(Dump.java:2684)     at com.ibm.jvm.svcdump.Dump.&lt;init&gt;(Dump.java:449)     at com.ibm.dtfj.sov.svcReader.SvcImageImpl.&lt;init&gt;(SvcImageImpl.java:74)     ... 24 more !SUBENTRY 1 org.eclipse.mat.parser 4 0 2010-05-14 09:36:57.015 !MESSAGE Unable to read dump C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log metafile null in DTFJ format DTFJ-Javacore !STACK 0 java.io.IOException: Unable to read dump C:\v_drive\dumps\core.20090614.204433.20785.0001.dmp\heapdump.20090614.204433.20785.0002.phd.inbound.index9.log metafile null in DTFJ format DTFJ-Javacore     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDynamicDTFJDump(DTFJIndexBuilder.java:7642)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getUncachedDump(DTFJIndexBuilder.java:7391)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDump(DTFJIndexBuilder.java:7289)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.fill(DTFJIndexBuilder.java:533)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:203)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:114)     at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:143)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.parse(ParseSnapshotApp.java:115)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.start(ParseSnapshotApp.java:101)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:169)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148) Caused by: java.io.IOException: Error parsing     at com.ibm.dtfj.javacore.parser.j9.JavaCoreReader.generateImage(JavaCoreReader.java:66)     at com.ibm.dtfj.image.javacore.JCImageFactory.getImage(JCImageFactory.java:38)     at org.eclipse.mat.dtfj.DTFJIndexBuilder.getDynamicDTFJDump(DTFJIndexBuilder.java:7616)     ... 21 more Caused by: com.ibm.dtfj.javacore.parser.framework.parser.ParserException: Not a javacore file. First line: ?&#64;gp'`#9h$-g-$z0B?OF HP?I         at com.ibm.dtfj.javacore.parser.j9.ParserController.parse(ParserController.java:127)     at com.ibm.dtfj.javacore.parser.j9.JavaCoreReader.generateImage(JavaCoreReader.java:64)     ... 23 more ]  !ENTRY org.eclipse.osgi 4 0 2010-05-14 09:36:57.015 !MESSAGE Application error !STACK 1 org.eclipse.mat.SnapshotException: Error opening heap dump 'heapdump.20090614.204433.20785.0002.phd.inbound.index9.log'. Check the error log for further details.     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:239)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:114)     at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:143)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.parse(ParseSnapshotApp.java:115)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.start(ParseSnapshotApp.java:101)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:169)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148) Caused by: org.eclipse.core.runtime.CoreException: Error opening heap dump 'heapdump.20090614.204433.20785.0002.phd.inbound.index9.log'     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:237)     ... 17 more The full list of reasons for a failure is now given. We now also log the IStatus.	
313475	normal	FIXED	Dummy Inbox	krum.tsvetkov	1274211780000	1277087340000		New GC root types make Paths from GC roots and Dominator tree less expressive	As discussed in the forum [1] there are certain GC root types which the Paths from GC roots query should ignore. An example of such root is UNFINALIZED. Having the query end the path at such object makes it difficult to see the &quot;real&quot; GC roots, e.g. the real reason for the object to be kept. We should define which GC root types can be ignored and try to change the implementation of the query.  [1] <a href="http://www.eclipse.org/forums/index.php?t=msg&amp;th=168323&amp;start=0">http://www.eclipse.org/forums/index.php?t=msg&amp;th=168323&amp;start=0</a>&amp; This issue is a major problem which has stopped me from using 1.0 entirely.   I've been trying to use MAT 1.0 for the majority of my memory work, but it is giving me problems in how, I assume, it is creating the dominator tree. In 1.0, MANY, MANY more things appear to be their own GC root. If I load up the same dump in 0.8, I get much more useful information. How has the creation of the dominator tree/GC roots determination changed from 0.8 to 1.0? I'm finding that 1.0 is almost useless because of this issue. I think both problems are related and we should have some discussion in this bug how to solve several problems - to get only the real GC roots as GC roots again - to attach some special semantic to certain objects (like the unfinalized...) - what are use cases where it is really necessary that the paths from GC roots go through the GC root nodes  I am changing the short description of the bug accordingly. DTFJ Roots of type UnfinalizedObject are not marked as roots because they are just weak roots.  However, there is some code that if finalizable objects (object on the finalizer queue) are not found via DTFJ then they are created as roots by looking for objects with a finalize method where the objects are unreferenced. Some extra code also marked referenced objects which could be finalized later as Unfinalized. This created the spurious GC roots.  The fix is to only mark those objects if the skipWeakRoots flag is false.  We can consider whether to tag unfinalized objects or other weak roots in some other way which doesn't break paths to GC roots.  Also having the boot loader as a source for the roots is confusing. (In reply to <a href="show_bug.cgi?id=313475#c2">comment #2</a>) <span class="quote">&gt; - what are use cases where it is really necessary that the paths from GC roots &gt; go through the GC root nodes</span >  Hi Krum,   I use the tool for two main use cases (and they are strongly related)  1) Our product has hit an OOME, and I need to figure out the cause. 2) Our product is using more memory then we think it should for a particular scenario, and I want to understand how to use less memory.  To me the most important function, is a way to understand what is keeping stuff in memory, so that I can make the right changes so that we use less memory. Any false hits, just make my task harder, and are a distraction. I've stopped UnfinalizedObjects being roots (unless skipWeakRoots flag is false.)  I've stopped the boot loader being a source for roots, except for system classes.  If we need to mark objects as weak roots (e.g. if they are tagged, but not treated as roots), then that can be handled with another enhancement.	
313636	normal	FIXED	Krum Tsvetkov	benjamin.muskalla	1274265780000	1276631400000		Cannot aquire heapdump	Using MAT 1.0.0.20100514  When I try to aquire a heapdump, MAT always fails in the last step of the wizard:   Heap dump file was not created. jmap exit code = 0 stdout: Dumping heap to /home/bmuskalla/Apps/mat-1.0/&quot;/home/bmuskalla/rapdumps/initial&quot; ... No such file or directory  /home/bmuskalla/Apps/mat-1.0/ is my MAT installation /home/bmuskalla/rapdumps/initial is the target path I entered in the wizard  According to the log, it seems it wants to execute jmap with the right path but the heapdump is not written. !ENTRY org.eclipse.mat.ui 1 0 2010-05-20 00:37:24.242 !MESSAGE Executing: /usr/lib/jvm/java-6-sun-1.6.0.16/bin/jmap -dump:format=b,file=&quot;/home/bmuskalla/rapdumps/initial&quot; 9260 I was able to reproduce this. When I first saw it I though we log one thing and execute another one. But this is not true, indeed what you see in the log is the line which is passed in the Runtime.exec().  For some reason it works fine if I paste it in a console, but when executed through Runtime.exec() it adds the tool root directory. I guess it has something to do with the quotes, which I have to admit I added in the last moment because otherwise paths with blank spaces didn't work on Win. Then I just tried in the console if quoting the path will work also on Linux... I'll look into this and try to fix it. I was able to fix this. Now both files with and without spaces work both on Win and Linux. As the problem will appear to anybody who tries to dump with MAT/jmap on a non-win system, I'll try to update our RCPs available for download in the next days already. Thanks for pointing to the problem! Thanks Krum for fixing this that fast. Just tried svn trunk and it works as expected. Thanks! Closing this one as fixed.	
313923	normal	FIXED	Dummy Inbox	chris.leon	1274411340000	1277932860000		Copy-paste on a large set takes an extremely long time	I had used OQL to select some 5000 items in a view, and then wanted to do some analysis in a spreadsheet (finding out what items take up 50%, 90%, 99% of memory, etc).  To do so, I can copy and paste over to the spreadsheet.  The copy operation takes several minutes to complete, which seems long.  It might be reasonable if it was recursing down in to the object referred to be the selections, but that's not the case.  It would be great if this could be about as fast as, say, selecting and copying 5000 rows in a 3 column spreadsheet, which is basically all I'm doing! I had a look at the copy and played with copying large amount of data. I couldn't reproduce the slow operation, but I ran quickly into an OutOfMemoryError (for copying ~20.000 rows with a String value, heap size and retained size columns). I also got into similar problems with fewer rows. May be in your case it was slow because of high memory usage?  I would suggest the following:  1) you can use the &quot;export&quot; functionality and export your data to a csv file. This worked fine and quickly for me and the 20.000 rows. Do not use export to TXT as it reuses the copy methods and you'll probably run into the same problems  2) I'll have a look at the copy implementation and see if I can improve something there.  Right now for example the copy will &quot;expand&quot; all columns automatically, meaning that if there is one very long string in the whole table it will fill spaces to all rows to keep the table-like formatting. This is OK and works fine for smaller pieces of data, however for large pieces of data it caused OOM error. May be we should at least show up a warning and hint the user to use the &quot;Export to ...&quot; for larger amounts of data.  3) We need a specific implementation for &quot;Export to TXT&quot; - when writing the data to a file we don't have to keep the whole buffer in memory.  Thanks for giving us feedback! I hope the workaround with &quot;Export to CSV&quot; will help you continue your analysis smoother. I submitted some changes, so that the data is streamed into a file when &quot;Export to TXT&quot; is executed, instead of building a full copy in memory first.  There are still some TODOs: - I figured out that in the OQL result long strings are not limited (e.g in the object reference tree the long strings are cut to something like 1000 characters, which is not true for the OQL results). - There are a lot of empty spaces added to achieve some nice formatting and this is OK. However, at least in the case of a left-aligned last column there is no need to add the spaces at the end of the line (but this is currently done) I submitted some more changes - now there will be no trailing white spaces added if there is just one column.  While trying to improve the Copy I found also another problem - the alignment for the columns is hardcoded - the first column is left justified, and all the rest right justified. This works fine with all &quot;standard&quot; views in MAT, but if I use OQL to select  the address of an object and its value (say for Strings) then the strings are right justified. This however would need a bit more thinking and therefore I opened a separate message for it - <span class="bz_closed"><a href="show_bug.cgi?id=318559" title="RESOLVED FIXED - Alignment of columns when doing copy/paste is hardcoded">Bug 318559</a></span>.  Some of the most frequently called method during the copy were using StringBuffers internally, although there is no synchronization needed. I changed them to StringBuilder and hope for a bit better performance.  With this we have: - &quot;Export to TXT&quot; doesn't copy all data into memory first - no OutOfMemoryError - in case of just one column the copy will not add unnecessary blank spaces - StringBuilder used instead of StringBuffer to increase performance - a separate message for the alignment problem is opened  Back to the initial reporter: Unfortunately I wasn't able to reproduce the long-running copy and assumed the whole time it was slow because of high memory usage and possible high GC activity. In general the copy / paste was intended to use on smaller amount of data and the &quot;Save to ...&quot; for exporting larger amounts of data.  I hope with this few changes the functionality improved and would close the message now. If you feel the fixes do not solve the problem in an acceptable way, please reopen the bug and give us your feedback. PS: the changes will be made available with our next service release, tentatively within the next month	
314552	normal	FIXED	Dummy Inbox	randallt	1274856120000	1277424240000		IndexOutOfBoundsException parsing IBM core dump	Using MAT for windows x86_64, 1.0, with IBM 6.0 64-bit JRE, with the IBM DTFJ 1.3 installed, I'm getting the following exception trying to open heap dumps:  java.lang.ArrayIndexOutOfBoundsException     at org.eclipse.mat.collect.SetInt.resize(SetInt.java:228)     at org.eclipse.mat.collect.SetInt.add(SetInt.java:57)     at org.eclipse.mat.parser.index.IndexWriter$InboundWriter.processObject(IndexWriter.java:950)     at org.eclipse.mat.parser.index.IndexWriter$InboundWriter.processSegment(IndexWriter.java:889)     at org.eclipse.mat.parser.index.IndexWriter$InboundWriter.flush(IndexWriter.java:825)     at org.eclipse.mat.parser.internal.GarbageCleaner.clean(GarbageCleaner.java:356)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:207)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:114)     at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:143)     at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:123)     at org.eclipse.mat.ui.snapshot.ParseHeapDumpJob.run(ParseHeapDumpJob.java:56)     at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)   This does not happen using version 0.8 with IBM DTFJ 1.3. I can upload the heap dump (about 275 MB) to a private area for debugging if provided with a link. I looked at the coding of the SetInt class where the error is coming from and it hasn't changed since two years. But the way it is used has probably changed.   I'd like to try and reproduce this behavior with your heap dump. You can upload it here if you are willing to provide it: <a href="https://sapmats-de.sap-ag.de/upload/index.cgi?id=GSKST44FTZHVONLNY9EYK0LWCZQ4XJVBU103GP1LF6KDSIVRHH">https://sapmats-de.sap-ag.de/upload/index.cgi?id=GSKST44FTZHVONLNY9EYK0LWCZQ4XJVBU103GP1LF6KDSIVRHH</a>  Alternatively I can send you a patched version of the SetInt class which will dump all internal fields on an ArrayIndexOutOfBoundsException. This can give us more info about the exception, but I won't be able to look what happens at other places in the code, where the collection is being used. Thanks for providing the heap dump. My first attempt was eunning a clean install of MAT 1.0, win64, DTFJ 1.3 and Sun 1.6 VM - it worked fine. Then I found some 32 bit IBM VM 6 for windows and run a x32 MAT 1.0 + DTFJ 1.3. With this one I could reproduce the problem.   Looking at the code I'm really puzzled how an OutOfIndex can happen at this place, but at least I'll have the possibility to debug it now.  The fact that it is VM specific makes it even more interesting :-) So I tried again a few more times with the exact same heap dumps. Cleared the index files, blew away the MAT workspace, and tried the exact sequence that I followed before. Couldn't reproduce it. It just so happened that I got this exception on the first 2 dumps I tried to open, so I thought something was fundamentally broken for IBM core dump support. I guess that is not the case and it is some timing-related issue. At least you have reproduced it somehow.  Strangely, the failure seems to be on the second line here. Why did the failure not occur on the first line?                  used[hash] = true;                 keys[hash] = key; // &lt;= ArrayIndexOutOfBoundsException I've reproduced the problem with some IBM VMs: E.g. eclipse.buildId=unknown java.fullversion=JRE 1.6.0 IBM J9 2.4 AIX ppc64-64 jvmap6460sr6-20090923_42924 (JIT enabled, AOT enabled) J9VM - 20090923_042924 JIT  - r9_20090902_1330ifx1 GC   - 20090817_AA BootLoader constants: OS=aix, ARCH=ppc64, WS=motif, NL=en_US Framework arguments:  -application org.eclipse.mat.api.parse /tmp/aetmpdir/t0624.011437.755.d/aex_out.d/heapdump.20100622.161005.967.0006.phd -Report1 org.eclipse.mat.api:suspects -Report2 org.eclipse.mat.api:top_components Command-line arguments:  -consoleLog -application org.eclipse.mat.api.parse /tmp/aetmpdir/t0624.011437.755.d/aex_out.d/heapdump.20100622.161005.967.0006.phd -Report1 org.eclipse.mat.api:suspects -Report2 org.eclipse.mat.api:top_components  !ENTRY org.eclipse.osgi 4 0 2010-06-24 01:28:05.148 !MESSAGE Application error !STACK 1 java.lang.ArrayIndexOutOfBoundsException     at org.eclipse.mat.collect.SetInt.resize(SetInt.java:228)     at org.eclipse.mat.collect.SetInt.add(SetInt.java:57)     at org.eclipse.mat.parser.index.IndexWriter$InboundWriter.processObject(IndexWriter.java:986)     at org.eclipse.mat.parser.index.IndexWriter$InboundWriter.processSegment(IndexWriter.java:925)     at org.eclipse.mat.parser.index.IndexWriter$InboundWriter.flush(IndexWriter.java:861)     at org.eclipse.mat.parser.internal.GarbageCleaner.clean(GarbageCleaner.java:356)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.parse(SnapshotFactoryImpl.java:207)     at org.eclipse.mat.parser.internal.SnapshotFactoryImpl.openSnapshot(SnapshotFactoryImpl.java:114)     at org.eclipse.mat.snapshot.SnapshotFactory.openSnapshot(SnapshotFactory.java:143)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.parse(ParseSnapshotApp.java:114)     at org.eclipse.mat.internal.apps.ParseSnapshotApp.start(ParseSnapshotApp.java:100)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:368)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)     at org.eclipse.equinox.launcher.Main.run(Main.java:1311)     at org.eclipse.equinox.launcher.Main.main(Main.java:1287)  and from   java version &quot;1.6.0&quot; Java(TM) SE Runtime Environment (build pap6460sr6-20090925_01(SR6)) IBM J9 VM (build 2.4, JRE 1.6.0 IBM J9 2.4 AIX ppc64-64 jvmap6460sr6-20090923_42924 (JIT enabled, AOT enabled) J9VM - 20090923_042924 JIT  - r9_20090902_1330ifx1 GC   - 20090817_AA) JCL  - 20090924_01  java version &quot;1.6.0&quot; Java(TM) SE Runtime Environment (build pap6460sr6ifix-20091015_01(SR6+152211+155 930+156106)) IBM J9 VM (build 2.4, JRE 1.6.0 IBM J9 2.4 AIX ppc64-64 jvmap6460sr6-20091001_43 491 (JIT enabled, AOT enabled) J9VM - 20091001_043491 JIT  - r9_20090902_1330ifx1 GC   - 20090817_AA) JCL  - 20091006_01  java version &quot;1.6.0&quot; Java(TM) SE Runtime Environment (build pap6460sr2-20080818_01(SR2)) IBM J9 VM (build 2.4, J2RE 1.6.0 IBM J9 2.4 AIX ppc64-64 jvmap6460-20080816_2209 3 (JIT enabled, AOT enabled) J9VM - 20080816_022093_BHdSMr JIT  - r9_20080721_1330ifx2 GC   - 20080724_AA) JCL  - 20080808_02  It works with   java version &quot;1.5.0&quot; Java(TM) 2 Runtime Environment, Standard Edition (build pap64dev-20091106a (SR11 )) IBM J9 VM (build 2.3, J2RE 1.5.0 IBM J9 2.3 AIX ppc64-64 j9vmap6423-20091104 (JIT enabled) J9VM - 20091103_45935_BHdSMr JIT  - 20091016_1845_r8 GC   - 20091026_AA) JCL  - 20091106 I've written some tests SetIntTest and SetLongTest which fail with   java version &quot;1.6.0&quot; Java(TM) SE Runtime Environment (build pwi3260sr7-20091217_01(SR7)) IBM J9 VM (build 2.4, JRE 1.6.0 IBM J9 2.4 Windows XP x86-32 jvmwi3260sr7-20091214_49398 (JIT enabled, AOT enabled) J9VM - 20091214_049398 JIT  - r9_20091123_13891 GC   - 20091111_AA) JCL  - 20091202_01  AllTests (1) org.eclipse.mat.tests.AllTests org.eclipse.mat.tests.collect.SetIntTest testSetInt1(org.eclipse.mat.tests.collect.SetIntTest) java.lang.AssertionError: every key should be contained     at org.junit.Assert.fail(Assert.java:71)     at org.junit.Assert.assertTrue(Assert.java:34)     at org.eclipse.mat.tests.collect.SetIntTest.testOneSetInt(SetIntTest.java:62)     at org.eclipse.mat.tests.collect.SetIntTest.testSetInt1(SetIntTest.java:56)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.junit.internal.runners.TestMethodRunner.executeMethodBody(TestMethodRunner.java:99)     at org.junit.internal.runners.TestMethodRunner.runUnprotected(TestMethodRunner.java:81)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestMethodRunner.runMethod(TestMethodRunner.java:75)     at org.junit.internal.runners.TestMethodRunner.run(TestMethodRunner.java:45)     at org.junit.internal.runners.TestClassMethodsRunner.invokeTestMethod(TestClassMethodsRunner.java:66)     at org.junit.internal.runners.TestClassMethodsRunner.run(TestClassMethodsRunner.java:35)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.junit.internal.runners.CompositeRunner.run(CompositeRunner.java:29)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:38)     at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)     at org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:58)     at org.eclipse.pde.internal.junit.runtime.CoreTestApplication.run(CoreTestApplication.java:24)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethod(EclipseAppContainer.java:572)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:171)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148)  testSetInt2(org.eclipse.mat.tests.collect.SetIntTest) java.lang.AssertionError: contained items should equals the size expected:&lt;1892&gt; but was:&lt;1891&gt;     at org.junit.Assert.fail(Assert.java:71)     at org.junit.Assert.failNotEquals(Assert.java:451)     at org.junit.Assert.assertEquals(Assert.java:99)     at org.eclipse.mat.tests.collect.SetIntTest.testTwoSetInt(SetIntTest.java:93)     at org.eclipse.mat.tests.collect.SetIntTest.testSetInt2(SetIntTest.java:79)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.junit.internal.runners.TestMethodRunner.executeMethodBody(TestMethodRunner.java:99)     at org.junit.internal.runners.TestMethodRunner.runUnprotected(TestMethodRunner.java:81)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestMethodRunner.runMethod(TestMethodRunner.java:75)     at org.junit.internal.runners.TestMethodRunner.run(TestMethodRunner.java:45)     at org.junit.internal.runners.TestClassMethodsRunner.invokeTestMethod(TestClassMethodsRunner.java:66)     at org.junit.internal.runners.TestClassMethodsRunner.run(TestClassMethodsRunner.java:35)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.junit.internal.runners.CompositeRunner.run(CompositeRunner.java:29)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:38)     at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)     at org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:58)     at org.eclipse.pde.internal.junit.runtime.CoreTestApplication.run(CoreTestApplication.java:24)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethod(EclipseAppContainer.java:572)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:171)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148)  testSetInt3(org.eclipse.mat.tests.collect.SetIntTest) java.lang.AssertionError: after a remove the key should not be contained     at org.junit.Assert.fail(Assert.java:71)     at org.junit.Assert.assertTrue(Assert.java:34)     at org.junit.Assert.assertFalse(Assert.java:53)     at org.eclipse.mat.tests.collect.SetIntTest.testThreeSetInt(SetIntTest.java:111)     at org.eclipse.mat.tests.collect.SetIntTest.testSetInt3(SetIntTest.java:105)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.junit.internal.runners.TestMethodRunner.executeMethodBody(TestMethodRunner.java:99)     at org.junit.internal.runners.TestMethodRunner.runUnprotected(TestMethodRunner.java:81)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestMethodRunner.runMethod(TestMethodRunner.java:75)     at org.junit.internal.runners.TestMethodRunner.run(TestMethodRunner.java:45)     at org.junit.internal.runners.TestClassMethodsRunner.invokeTestMethod(TestClassMethodsRunner.java:66)     at org.junit.internal.runners.TestClassMethodsRunner.run(TestClassMethodsRunner.java:35)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.junit.internal.runners.CompositeRunner.run(CompositeRunner.java:29)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:38)     at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)     at org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:58)     at org.eclipse.pde.internal.junit.runtime.CoreTestApplication.run(CoreTestApplication.java:24)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethod(EclipseAppContainer.java:572)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:171)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148)  org.eclipse.mat.tests.collect.SetLongTest testSetLong1(org.eclipse.mat.tests.collect.SetLongTest) java.lang.AssertionError: every key should be contained     at org.junit.Assert.fail(Assert.java:71)     at org.junit.Assert.assertTrue(Assert.java:34)     at org.eclipse.mat.tests.collect.SetLongTest.testOneSetLong(SetLongTest.java:62)     at org.eclipse.mat.tests.collect.SetLongTest.testSetLong1(SetLongTest.java:56)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.junit.internal.runners.TestMethodRunner.executeMethodBody(TestMethodRunner.java:99)     at org.junit.internal.runners.TestMethodRunner.runUnprotected(TestMethodRunner.java:81)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestMethodRunner.runMethod(TestMethodRunner.java:75)     at org.junit.internal.runners.TestMethodRunner.run(TestMethodRunner.java:45)     at org.junit.internal.runners.TestClassMethodsRunner.invokeTestMethod(TestClassMethodsRunner.java:66)     at org.junit.internal.runners.TestClassMethodsRunner.run(TestClassMethodsRunner.java:35)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.junit.internal.runners.CompositeRunner.run(CompositeRunner.java:29)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:38)     at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)     at org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:58)     at org.eclipse.pde.internal.junit.runtime.CoreTestApplication.run(CoreTestApplication.java:24)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethod(EclipseAppContainer.java:572)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:171)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148)  testSetLong2(org.eclipse.mat.tests.collect.SetLongTest) java.lang.AssertionError: contained items should equals the size expected:&lt;1875&gt; but was:&lt;1872&gt;     at org.junit.Assert.fail(Assert.java:71)     at org.junit.Assert.failNotEquals(Assert.java:451)     at org.junit.Assert.assertEquals(Assert.java:99)     at org.eclipse.mat.tests.collect.SetLongTest.testTwoSetLong(SetLongTest.java:93)     at org.eclipse.mat.tests.collect.SetLongTest.testSetLong2(SetLongTest.java:79)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.junit.internal.runners.TestMethodRunner.executeMethodBody(TestMethodRunner.java:99)     at org.junit.internal.runners.TestMethodRunner.runUnprotected(TestMethodRunner.java:81)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestMethodRunner.runMethod(TestMethodRunner.java:75)     at org.junit.internal.runners.TestMethodRunner.run(TestMethodRunner.java:45)     at org.junit.internal.runners.TestClassMethodsRunner.invokeTestMethod(TestClassMethodsRunner.java:66)     at org.junit.internal.runners.TestClassMethodsRunner.run(TestClassMethodsRunner.java:35)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.junit.internal.runners.CompositeRunner.run(CompositeRunner.java:29)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:38)     at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)     at org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:58)     at org.eclipse.pde.internal.junit.runtime.CoreTestApplication.run(CoreTestApplication.java:24)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethod(EclipseAppContainer.java:572)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:171)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148)  testSetLong3(org.eclipse.mat.tests.collect.SetLongTest) java.lang.AssertionError: after a remove the key should not be contained     at org.junit.Assert.fail(Assert.java:71)     at org.junit.Assert.assertTrue(Assert.java:34)     at org.junit.Assert.assertFalse(Assert.java:53)     at org.eclipse.mat.tests.collect.SetLongTest.testThreeSetLong(SetLongTest.java:111)     at org.eclipse.mat.tests.collect.SetLongTest.testSetLong3(SetLongTest.java:105)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.junit.internal.runners.TestMethodRunner.executeMethodBody(TestMethodRunner.java:99)     at org.junit.internal.runners.TestMethodRunner.runUnprotected(TestMethodRunner.java:81)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestMethodRunner.runMethod(TestMethodRunner.java:75)     at org.junit.internal.runners.TestMethodRunner.run(TestMethodRunner.java:45)     at org.junit.internal.runners.TestClassMethodsRunner.invokeTestMethod(TestClassMethodsRunner.java:66)     at org.junit.internal.runners.TestClassMethodsRunner.run(TestClassMethodsRunner.java:35)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.junit.internal.runners.CompositeRunner.run(CompositeRunner.java:29)     at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42)     at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34)     at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52)     at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:38)     at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)     at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)     at org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:58)     at org.eclipse.pde.internal.junit.runtime.CoreTestApplication.run(CoreTestApplication.java:24)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethod(EclipseAppContainer.java:572)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:171)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)     at org.eclipse.equinox.launcher.Main.run(Main.java:1173)     at org.eclipse.equinox.launcher.Main.main(Main.java:1148) I've coded two small modifications to SetInt and SetLong which seem to resolve this problem on IBM Java 6 VMs. Thanks Andrew! I had about 0% chance to find the problem and work around it.	
315488	minor	FIXED	Dummy Inbox	andrew_johnson	1275467040000	1275881040000		NullPointerException with invalid numeric filter	To reproduce, bring up a histogram then in the &lt;Numeric&gt; space type some letters or &gt;ABC  java.lang.NullPointerException at org.eclipse.mat.query.refined.Filter$NumericFilter.number(Filter.java:225) at org.eclipse.mat.query.refined.Filter$NumericFilter.setCriteria(Filter.java:200) at org.eclipse.mat.ui.internal.viewer.RefinedResultViewer$18.updateCriteria(RefinedResultViewer.java:1014) at org.eclipse.mat.ui.internal.viewer.RefinedResultViewer$18.handleEvent(RefinedResultViewer.java:1000) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:938) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:962) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:947) at org.eclipse.swt.widgets.Control.traverse(Control.java:3385) at org.eclipse.swt.widgets.Control.translateTraversal(Control.java:3367) at org.eclipse.swt.widgets.Display.translateTraversal(Display.java:4204) at org.eclipse.swt.widgets.Display.filterMessage(Display.java:1155) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3289) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2389) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2353) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2219) at org.eclipse.ui.internal.Workbench$4.run(Workbench.java:466) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:289) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:461) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.mat.ui.rcp.Application.start(Application.java:26) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:169) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) at java.lang.reflect.Method.invoke(Method.java:600) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447) at org.eclipse.equinox.launcher.Main.run(Main.java:1173) at org.eclipse.equinox.launcher.Main.main(Main.java:1148) The fix is trivial - in Filter.java the parse method can return null, so the success should be checked before converting to a double. Fix is to parse the Number, check the parse was successful, and only convert the Number (not null) to a double if successful.	
315580	minor	FIXED	Dummy Inbox	andrew_johnson	1275527580000	1275880980000		Unable to select entries in Heap Dump Details	Only the first entry in each row can be selected. This might cause problems  for screen readers. Adding SWT.FULL_SELECTION to the TreeViewer would mean that the whole line was selected. Is that good enough? Added SWT.FULL_SELECTION so whole row is read by screen reader.	
315940	minor	FIXED	Dummy Inbox	dominik.stadler	1275857400000	1277331360000		Remember custom JDK that is set for Acquire Heap Dump	Build Identifier: Eclipse Memory Analyzer Version 1.0.0  Currently the jdkhome property is always reset, this means users that need to use a different JDK for heap dump retrieval need to always enter the different one, it would be more user friendly to have the last custom jdk remembered for this field as you typically do a number of memory dumps of the same application during memory analysis.  I typically have to set a different JDK when my &quot;system under analysis&quot; is running with 32-bit, whereas MAT is executed with 64-bit (necessary to have more memory available than 2G).  Reproducible: Always  Steps to Reproduce: 1. Acquire a heap dump where you set the jdkhome to a different value 2. Acquire another heap dump, the jdkhome property is reset to the default value instead of the value you just entered before I checked in some changes which solve the problem. Previously only the user setting for the JDK used to get the list of JVMs was saved and this was reused for calling jmap. It was possible to choose another VM for jmap but this specific setting wasn't saved. Now both of them are saved as separate properties.  The change will be included in the next bugfix release, which I (tentatively) see in about a month. Until then as a workaround for your problem you can use the &quot;Configure&quot; button on the first page and set there the jdkHome used to get the list of VMs to the x32 one. As I said this one is used then to call jmap.	
317177	minor	FIXED	Dummy Inbox	andrew_johnson	1276740000000	1276740240000		Keyword section in leak report should start on a new line	The keywords section sometimes continues on from the previous text, which is messy and loses the usefulness of a separate section.  E.g. One instance of &quot;java.lang.StringBuilder&quot; loaded by &quot;&lt;system class loader&gt;&quot; occupies 3,932,200 (47.33%) bytes. The memory is accumulated in one instance of &quot;char[]&quot; loaded by &quot;&lt;system class loader&gt;&quot;.Keywords java.lang.StringBuilder char[] See LeakHunterQuery.java Add extra &lt;br&gt;&lt;br&gt; before appendKeywords() in getLeakDescriptionSingleObject() to match getLeakDescriptionGroupOfObjects()	
317278	normal	FIXED	Dummy Inbox	krum.tsvetkov	1276807500000	1277933820000		org.eclipse.mat.ui.help contains empty src/org.eclipse.mat.ui folder	There is no source at all in this plugin (as expected) but there is still an empty folder under src. This causes complaints about missing execution environment for the bundle. I'll remove the empty folder. See <a href="show_bug.cgi?id=316714" title="NEW - Some BREEs missing for Helios common repo bundles">bug 316714</a> Should we also remove the javabuilder and apiAnalysisBuilder from the buildCommand and nature sections of the .project file? It was my misunderstanding. The complaint in <a href="show_bug.cgi?id=316714" title="NEW - Some BREEs missing for Helios common repo bundles">bug 316714</a> was that we DO HAVE execution environment specified in the help plugin, although there are no classes in it. I have removed it.  I also have removed the empty source folder.	
317446	minor	FIXED	Dummy Inbox	andrew_johnson	1277086260000	1277489220000		Handle huge array sizes	<span class="bz_closed"><a href="show_bug.cgi?id=308310" title="RESOLVED FIXED - ISnapshot API doesn't handle very large arrays">Bug 308310</a></span> allowed the Snapshot API to handle sizes of huge arrays.  The encoding of large arrays still needs to be done using SizeIndexCollectorUncompressed  e.g. using the technique here <a href="http://dev.eclipse.org/mhonarc/lists/mat-dev/msg00082.html">http://dev.eclipse.org/mhonarc/lists/mat-dev/msg00082.html</a> Use the technique given in the link. Fix applied.	
317550	minor	FIXED	Dummy Inbox	andrew_johnson	1277153040000	1277153160000		Improve Equinox bundle explorer	The Equinox bundle explorer needs some improvements to messages to give addresses no ids, better handling of nulls in arrays and an attempt to find extensions  via the registryObjects.cache.table I have check in the code for this.	
318263	normal	FIXED	Krum Tsvetkov	benjamin.muskalla	1277724720000	1284605760000		Remove o.e.platform branding bundle	Currently MAT ships with the org.eclipse.platform bundle which is essential the branding bundle for the Eclipse SDK. It contains many unneeded files for the MAT RCP version (SDK Intro, CVS cheatsheets, icons, splash screens, etc). Besides that this is unnecessary, it carries broken things if not part of the SDK (eg. the CVS cheatsheets do not work without CVS bundles). The only interesting thing in that bundle is the definition of the cheatsheet action set which should be transfered to the org.eclipse.mat.ui.rcp bundle. Thanks for the hint. I would unfortunately need some more explanation. I checked the dependencies of org.eclipse.mat.ui.rcp and see there the platform as you mentioned.   1st attempt) I tried then removing it - everything compiles, but the cheetsheets don't come up. 2nd attempt) I tried then to copy (just as it is) the following actionSets definition     &lt;extension          point=&quot;org.eclipse.ui.actionSets&quot;&gt;       &lt;actionSet             label=&quot;%cheatsheet.actionset&quot;             visible=&quot;true&quot;             id=&quot;org.eclipse.ui.cheatsheets.actionSet&quot;&gt;          &lt;action                label=&quot;%cheatsheet.item&quot;                class=&quot;org.eclipse.ui.cheatsheets.CheatSheetExtensionFactory:helpMenuAction&quot;                menubarPath=&quot;help/group.tutorials&quot;                id=&quot;org.eclipse.ui.cheatsheets.actions.CheatSheetHelpMenuAction&quot;&gt;          &lt;/action&gt;       &lt;/actionSet&gt;    &lt;/extension&gt;  This also didn't help: wneh I try to open a cheetsheet I get: &quot;No standby content part defined with id: org.eclipse.platform.cheatsheet.&quot;  3rd attempt) Wanted to also copy the following    &lt;extension point=&quot;org.eclipse.ui.intro.configExtension&quot;&gt;       &lt;standbyContentPart             id=&quot;org.eclipse.platform.cheatsheet&quot;             class=&quot;org.eclipse.platform.internal.CheatSheetStandbyContent&quot;             pluginId=&quot;org.eclipse.platform&quot;/&gt;             ... But it already points to some class within the platform bundle.   At this moment I'd prefer to ask for more hints, as I'm afraid I'm not doing the right thing and haven't really understood your suggestion. What did you mean by  <span class="quote">&gt;&gt; the definition of the cheatsheet action set which should be transfered to the org.eclipse.mat.ui.rcp bundle</span > Created <span class=""><a href="attachment.cgi?id=173215&amp;action=diff" name="attach_173215" title="patch">attachment 173215</a> <a href="attachment.cgi?id=173215&amp;action=edit" title="patch">[details]</a></span> patch  This patch includes the changes I suggested. When running MAT from the product file, everything looks fine to me (menu item is there, can open the MAT cheatsheets).  btw: I think the cheatsheets itself should be moved to the help bundle + the dependency to o.e.ui.cheatsheets The patch works as advertised, so I'll include it and the Tycho/Maven build should show a cheat sheets page without CVS. I now see the problem that Krum had. The cheat sheets work from Help -&gt; Cheat sheets but not from the welcome page, which fails with &quot;&quot;No standby content part defined with id: org.eclipse.platform.cheatsheet.&quot;  The CheatSheetStandbyContent class can be copied from org.eclipse.platform into o.e.mat.ui, then we can have our own standby content instead of needing o.e.platform bundle. The intro tutorial XML need to be modified to change url=&quot;<a href="http://org.eclipse.ui.intro/showStandby?partId=org.eclipse.platform.cheatsheet&amp;amp;input=org.eclipse.mat.tutorials.bestFeaturesTutorial">http://org.eclipse.ui.intro/showStandby?partId=org.eclipse.platform.cheatsheet&amp;amp;input=org.eclipse.mat.tutorials.bestFeaturesTutorial</a>&quot;&gt;   to point to our version of the standby partId. I've made the changes in the patch, created our own copy of CheatSheetStandbyContent and associated extension in org.eclipse.mat.ui, moved the cheat sheets to the org.eclipse.mat.ui.help plugin, adjusted the build properties to ensure they are still packaged.	
318288	minor	FIXED	Dummy Inbox	andrew_johnson	1277761380000	1278363360000		The ParseHeapDump script doesn't run on AIX	The ParseHeapDump doesn't run.  ksh: /tmp/memoryanalyzer/ParseHeapDump.sh:  not found.   The problem seems to be CR/LF not LF in the script. I've removed the CR/LF by changing the svn:mime-type to text/plain, then locally renaming the file to ParseHeapDump.sh.txt, then file-&gt;convert line delimiters-&gt;Unix, then renamed the file back to ParseHeapDump.sh I've created a ParseHeapDump2.sh script for AIX which will run with 32-bit and 64-bit Java. Does it make sense to have both files included in the RCP? I think it will be better to give to the user only one script which is working on the platform. Or did I interpret wrongly the build.properties file? The existing ParseHeapDump.sh script runs on AIX with 32-bit Java.  Is it better to use this script which will also use MemoryAnalyzer.ini for heap size, and other parameters the same as the GUI version etc. <a href="http://wiki.eclipse.org/index.php/MemoryAnalyzer/FAQ#Out_of_Memory_Error_while_Running_the_Memory_Analyzer">http://wiki.eclipse.org/index.php/MemoryAnalyzer/FAQ#Out_of_Memory_Error_while_Running_the_Memory_Analyzer</a>  or to always use the new ParseHeapDump2.sh script (renamed to ParseHeapDump.sh) on AIX? I would say either rename  ParseHeapDump2.sh to  ParseHeapDump.sh and use only it, or rename  ParseHeapDump2.sh to  ParseHeapDump64.sh and keep both. I just didn't like the 2 at the end, as it tells nothing about when to use this script. I've just put one script for AIX which should run with 32-bit and 64-bit Java.	
318479	minor	FIXED	Andrew Johnson	andrew_johnson	1277865720000	1296975840000		Missing icons for RCP and features	The product icons for Memory Analyzer in the top left of the window title bar and with alt-tab with Windows operating system and on the bottom of the screen are quite jagged. This is possibly because the icons in  org.eclipse.mat.rcp mat.product only declares a 16x16 icon.  A higher resolution icon would be useful.  It would also be nice to have platform icons for the executable.  The features need icons too - for the  org.eclipse.mat.chart.feature -&gt; org.eclipse.mat.chart as the branding plugin org.eclipse.mat.feature -&gt; org.eclipse.mat.api as the branding plugin org.eclipse.mat.rcp.feature -&gt; org.eclipse.mat.ui.rcp as the branding plugin  about.ini featureImage=xxxx I've made a 32x32 memory_analyzer_32.gif icon by stretching the 16x16 icon, then tidying it up.  I'll try that for the rcp. I've added that icon to rcp: via  about.ini  plugin.xml  mat.product api: via  about.ini chart: via  about.ini  also to the mat.product project used for Tycho/Maven I've done all I want to. I haven't added any platform specific icons.	
318559	normal	FIXED	Dummy Inbox	krum.tsvetkov	1277930100000	1284078660000		Alignment of columns when doing copy/paste is hardcoded	While trying to improve the Copy functionality I found some problem - the alignment for the columns is hardcoded - the first column is left justified, and all the rest right justified. This works fine with all &quot;standard&quot; views in MAT, but if I use OQL to select  the address of an object and its value (say for Strings) then the strings are right justified. This however would need a bit more thinking and therefore I opened a separate message for it.  How to reproduce: 1) open the OQL view 2) execute  SELECT s.&#64;objectAddress, toString(s) FROM java.lang.String s  3) copy some lines from the result content and paste to a text file  The functionality is implemented in org.eclipse.mat.ui.util.Copy I've got some code to fix this, and to follow reordering of columns in the GUI,  and to get the dashed line the right length if the alignment of columns is not  the default.  I'll add it shortly. I'll commit my changes.  Should the line separator be CR/LF or line.separator ?  Should export as CSV or HTML follow the reordering of table/tree columns? At the moment they do not.  Krum, please try this and see if it does what you want. Before:  s.&#64;objectAddress|                                              toString(s)  ---------------------------------------------------------------------------- 649,759,280     |                                           returnOpenType  649,759,128     | javax.management.openmbean.OpenMBeanOperationInfoSupport  649,757,024     | javax.management.openmbean.OpenMBeanParameterInfoSupport  649,712,528     |                                          Non-heap memory  649,712,472     |                                                 NON_HEAP  649,712,408     |                                              Heap memory  649,712,360     |                                                     HEAP  ----------------------------------------------------------------------------  With the fix:   s.&#64;objectAddress |toString(s) ---------------------------------------------------------------------------       649,759,280 |returnOpenType       649,759,128 |javax.management.openmbean.OpenMBeanOperationInfoSupport       649,757,024 |javax.management.openmbean.OpenMBeanParameterInfoSupport       649,712,528 |Non-heap memory       649,712,472 |NON_HEAP       649,712,408 |Heap memory ---------------------------------------------------------------------------	
318618	minor	FIXED	Dummy Inbox	benjamin.muskalla	1277952360000	1281589440000		Use URLImageDescriptor to load images	Just a minor thing I noticed: MemoryAnalyserPlugin loads images itself from a URL. You can use URLImageDescriptor to save some code and get rid of the error handling.  And btw: missing_image.gif is missing ;-) Created <span class=""><a href="attachment.cgi?id=173223&amp;action=diff" name="attach_173223" title="patch">attachment 173223</a> <a href="attachment.cgi?id=173223&amp;action=edit" title="patch">[details]</a></span> patch  Patch Good idea - thanks.  To follow the Eclipse Legal Process, please can you confirm that you (a) wrote 100% of the code;  (b) that you have the right to contribute the code to Eclipse;  and that it is contributed under the Eclipse Public License.  For part c, the file has already has license header, but I'll add your name as a contributor. (c) the file header contains the appropriate License header. a) yep b) yep c) thanks  But I don't think I need to answer all these things as committer. I think only non-committers need to do that. I've applied and committed the patch.  I think the committer status is on a project basis, so in the Eclipse legal process poster, figure 1 says &quot;Written 100% by Submitting Committer or Committer on same Project under the supervision of the PMC&quot;, figure 3 says &quot;Written 100% by Submitting Contributor (Non-Committer) and Submitted under the terms of the Project License (typically EPL)&quot;.	
318635	minor	FIXED	Dummy Inbox	andrew_johnson	1277957760000	1278288960000		NullPointerException in QueryContextImpl.convertToValue	If you open a dump with an UnreachableObjectsHistogram, run the Unreachable Objects Histogram query, then open a dump without the UnreachableObjectsHistogram, then bring up the query browser with control-Q then select the UnreachableObjectsHistogram from the history then a query dialog appears. Typing anything into the -histogram field gives   Event loop exception java.lang.NullPointerException     at org.eclipse.mat.query.registry.QueryContextImpl.convertToValue(QueryContextImpl.java:44)     at org.eclipse.mat.internal.snapshot.SnapshotQueryContext.convertToValue(SnapshotQueryContext.java:183)     at org.eclipse.mat.ui.internal.query.arguments.TextEditor.editingDone(TextEditor.java:154)     at org.eclipse.mat.ui.internal.query.arguments.TextEditor$2.modifyText(TextEditor.java:120)     at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:167)     at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)     at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1003) The main problem is that queries are shown in the history which are not valid and are not satisfiable by that dump. There is no converter available to convert a String from the user into the UnreachableObjectsHistogram.  The error message could be slightly better.  Main fix: Ensure the QueryHistoryProvider doesn't return unsuitable queries.  Also give a better error message if for some reason an unsuitable query is somehow selected. Fix has now been applied.  It is still possible to run the query on a dump without an Unreachable Objects Histogram by typing   control-Q unreachable_objects  This gives an error message in the dialog of   java.lang.IllegalArgumentException: org.eclipse.mat.snapshot.UnreachableObjectsHistogram  This is not very helpful.  Would this be better?   Impossible to convert any string to org.eclipse.mat.snapshot.UnreachableObjectsHistogram, query is not suitable for this snapshot Error message is now:   Impossible to convert any string to org.eclipse.mat.snapshot.UnreachableObjectsHistogram, query is not suitable for this snapshot	
318982	minor	FIXED	Dummy Inbox	andrew_johnson	1278364740000	1278364860000		Improve OQL documentation for properties accessors	<a href="http://www.eclipse.org/forums/index.php?t=msg&amp;th=171263&amp;start=0">http://www.eclipse.org/forums/index.php?t=msg&amp;th=171263&amp;start=0</a>&amp; The help system states that it's possible to call methods through reflection  Quote:  Calling Java methods  [ &lt;alias&gt; . ] &#64;&lt;method&gt;( [ &lt;expression&gt;, &lt;expression&gt; ] ) ...  Adding ( ) forces OQL to interpret this as a Java method call. The call is executed via reflection. Common Java methods.    But I can't get it working. For example, this is the result when trying to call getTime() from the java.util.Date  Quote:  Executed Query: SELECT d.&#64;getTime() FROM java.util.Date d  Problem reported: Method getTime not found in object java.util.Date [id=0x647cd5e8]    The same happens with all methods that don't belong to the java.lang.Object class.  Am I doing something wrong or is this feature not supported yet?  Thx!   shows a misunderstanding of properties accessors, which operate on the Memory Analyzer model objects, not the actual objects. The help needs to be improved, with links to the model API doc. I've updated propertiesaccessors.dita and propertiesaccessors.html	
319754	minor	FIXED	Dummy Inbox	andrew_johnson	1278994740000	1278995340000		NullPointerException with filter field and sorting	To reproduce, bring up a histogram, type 'x' into the filter field for class name then click on the class name column heading.  An internal error occurred during: &quot;Sorting...&quot;. java.lang.NullPointerException at java.util.Collections.sort(Unknown Source) at org.eclipse.mat.query.refined.RefinedStructuredResult.sort(RefinedStructuredResult.java:292) at org.eclipse.mat.ui.internal.viewer.RefinedResultViewer$SortingJob.doRun(RefinedResultViewer.java:1434) at org.eclipse.mat.ui.editor.AbstractPaneJob.run(AbstractPaneJob.java:34) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55) There's a simple fix in RefinedResultViewer.resort() Check for null children in resort()	
319757	minor	FIXED	Dummy Inbox	andrew_johnson	1278997800000	1281576900000		Widget is disposed message with filter and sorting dominator tree	To reproduce: Bring up the dominator tree Type 'x' into the filter column heading Click on the class name column heading to sort  The filter heading then has a top half with text, and a bottom half with &lt;Regex&gt;  Typing another 'x' gives  org.eclipse.swt.SWTException: Widget is disposed at org.eclipse.swt.SWT.error(SWT.java:3884) at org.eclipse.swt.SWT.error(SWT.java:3799) at org.eclipse.swt.SWT.error(SWT.java:3770) at org.eclipse.swt.widgets.Widget.error(Widget.java:463) at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:336) at org.eclipse.swt.widgets.TreeItem.getBounds(TreeItem.java:415) at org.eclipse.mat.ui.internal.viewer.RefinedTreeViewer$TreeAdapter.getBounds(RefinedTreeViewer.java:651) at org.eclipse.mat.ui.internal.viewer.RefinedResultViewer$18.handleEvent(RefinedResultViewer.java:987) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1003) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1027) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1012) at org.eclipse.swt.widgets.Text.verifyText(Text.java:2066) at org.eclipse.swt.widgets.Text.sendKeyEvent(Text.java:1517) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1036) at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1368) at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:4053) at org.eclipse.swt.widgets.Text.WM_CHAR(Text.java:2175) at org.eclipse.swt.widgets.Control.windowProc(Control.java:3946) at org.eclipse.swt.widgets.Text.windowProc(Text.java:2170) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4589) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2409) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3471) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2405) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2369) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2221) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:500) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:493) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.mat.ui.rcp.Application.start(Application.java:26) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:368) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514) at org.eclipse.equinox.launcher.Main.run(Main.java:1311)   Clicking on the error log then gives another error pop-up  Problems occurred when invoking code from plug-in: &quot;org.eclipse.ui.workbench&quot;.  org.eclipse.swt.SWTException: Widget is disposed at org.eclipse.swt.SWT.error(SWT.java:3884) at org.eclipse.swt.SWT.error(SWT.java:3799) at org.eclipse.swt.SWT.error(SWT.java:3770) at org.eclipse.swt.widgets.Widget.error(Widget.java:463) at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:336) at org.eclipse.swt.widgets.TreeItem.setImage(TreeItem.java:1713) at org.eclipse.mat.ui.internal.viewer.RefinedResultViewer.applyFilterData(RefinedResultViewer.java:420) at org.eclipse.mat.ui.internal.viewer.RefinedResultViewer$18.updateCriteria(RefinedResultViewer.java:1024) at org.eclipse.mat.ui.internal.viewer.RefinedResultViewer$18.handleEvent(RefinedResultViewer.java:982) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1003) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1027) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1008) at org.eclipse.swt.widgets.Control.sendFocusEvent(Control.java:2583) at org.eclipse.swt.widgets.Widget.wmKillFocus(Widget.java:1781) at org.eclipse.swt.widgets.Control.WM_KILLFOCUS(Control.java:4289) at org.eclipse.swt.widgets.Control.windowProc(Control.java:3979) at org.eclipse.swt.widgets.Text.windowProc(Text.java:2170) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4602) at org.eclipse.swt.internal.win32.OS.SetFocus(Native Method) at org.eclipse.swt.widgets.Control.forceFocus(Control.java:978) at org.eclipse.swt.widgets.Control.setFocus(Control.java:2965) at org.eclipse.ui.internal.views.log.LogView.setFocus(LogView.java:1080) at org.eclipse.ui.internal.PartPane.setFocus(PartPane.java:332) at org.eclipse.ui.internal.WorkbenchPage$3.run(WorkbenchPage.java:626) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.core.runtime.Platform.run(Platform.java:888) at org.eclipse.ui.internal.WorkbenchPage.activatePart(WorkbenchPage.java:621) at org.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:3527) at org.eclipse.ui.internal.WorkbenchPage.requestActivation(WorkbenchPage.java:3071) at org.eclipse.ui.internal.PartPane.requestActivation(PartPane.java:279) at org.eclipse.ui.internal.PartPane.handleEvent(PartPane.java:237) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1003) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1027) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1008) at org.eclipse.swt.widgets.Shell.setActiveControl(Shell.java:1404) at org.eclipse.swt.widgets.Shell.WM_MOUSEACTIVATE(Shell.java:2268) at org.eclipse.swt.widgets.Control.windowProc(Control.java:3989) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:342) at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1578) at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2010) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4602) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2404) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4036) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4602) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2404) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4036) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4602) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2404) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4036) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4602) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2404) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4036) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4602) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2404) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4036) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4602) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2404) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4036) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4602) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2404) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4036) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4602) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2404) at org.eclipse.swt.widgets.Tree.callWindowProc(Tree.java:1439) at org.eclipse.swt.widgets.Tree.windowProc(Tree.java:5722) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4602) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:2312) at org.eclipse.swt.widgets.Tree.callWindowProc(Tree.java:1530) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4036) at org.eclipse.swt.widgets.Tree.windowProc(Tree.java:5821) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4602) at org.eclipse.swt.internal.win32.OS.PeekMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.PeekMessage(OS.java:2974) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3468) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2405) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2369) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2221) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:500) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:493) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.mat.ui.rcp.Application.start(Application.java:26) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:368) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514) at org.eclipse.equinox.launcher.Main.run(Main.java:1311)  A similar problem occurs with the class histogram when grouped by superclass or classloader, or with an outgoing objects view. One solution would be to have a lot of if (!item.isDisposed()) etc code.  Would it be better to listen for the dispose of the table/tree item then dispose the composite used for the filter text? I've added a dispose listener for the Table/Tree Item which disposes the filter editor composite. I remove the listener if the composite is disposed another way. I have seen the following exception while using the filter with a dominator tree, by going to the shallow heap filter, entering '0000' then pressing 'enter' twice.   java.lang.NullPointerException     at org.eclipse.mat.ui.internal.viewer.RefinedResultViewer$3.handleEvent(RefinedResultViewer.java:330)     at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)     at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)     at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4066)     at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3657)     at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629)     at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593)     at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427)     at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670)     at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)     at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663)     at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)     at org.eclipse.mat.ui.rcp.Application.start(Application.java:26)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)     at org.eclipse.equinox.launcher.Main.run(Main.java:1407)     at org.eclipse.equinox.launcher.Main.main(Main.java:1383) Null pointer fix done.  Should we consider not disposing the filter TreeItem when refreshing the view? See <span class="bz_closed"><a href="show_bug.cgi?id=322508" title="RESOLVED FIXED - Allow easier keyboard navigation of filter and sorting columns">bug 322508</a></span>	
320366	minor	FIXED	Dummy Inbox	andrew_johnson	1279573920000	1279597140000		Top Components report fails due to unknown object	Ignoring result of 'Top Components' due to Object 0x2aaabf9e31a0 not found. org.eclipse.mat.SnapshotException: Object 0x2aaabf9e31a0 not found. at org.eclipse.mat.parser.internal.SnapshotImpl.mapAddressToId(SnapshotImpl.java:1451) at org.eclipse.mat.snapshot.model.ObjectReference.getObjectId(ObjectReference.java:56) at org.eclipse.mat.parser.model.AbstractObjectImpl.resolveValue(AbstractObjectImpl.java:237) at org.eclipse.mat.inspections.collections.CollectionUtil$Info.getSize(CollectionUtil.java:92) at org.eclipse.mat.inspections.collections.CollectionsBySizeQuery.execute(CollectionsBySizeQuery.java:104) at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129) at org.eclipse.mat.snapshot.query.SnapshotQuery.execute(SnapshotQuery.java:192) at org.eclipse.mat.snapshot.query.SnapshotQuery.refine(SnapshotQuery.java:202) at org.eclipse.mat.inspections.component.ComponentReportQuery.addEmptyCollections(ComponentReportQuery.java:434) at org.eclipse.mat.inspections.component.ComponentReportQuery.execute(ComponentReportQuery.java:108) at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129) at org.eclipse.mat.snapshot.query.SnapshotQuery.execute(SnapshotQuery.java:192) at org.eclipse.mat.inspections.component.TopComponentsReportQuery.execute(TopComponentsReportQuery.java:66) at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129) at org.eclipse.mat.query.registry.CommandLine.execute(CommandLine.java:93) at org.eclipse.mat.report.internal.QueryPart.execute(QueryPart.java:96) at org.eclipse.mat.report.TestSuite.execute(TestSuite.java:131) at org.eclipse.mat.report.internal.RunRegisterdReport.execute(RunRegisterdReport.java:50) at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129) at org.eclipse.mat.ui.QueryExecution$ExecutionJob.run(QueryExecution.java:174) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)  The problem occurs because a field contains an address of an unknown object. The way the DTFJ parser works is that all objects and classes are found initially and are given ids then the outbound references are built. Any unknown outbound refs are ignored, but they are visible as addresses, not ids when an object is inspected. A first step is to improve the error message. The ObjectReference.getObjectId() method throws an exception, and doesn't return &lt;0, so we need to catch the exception and rethrow.  Ignoring result of 'Top Components' due to Field 'map' of 'java.util.HashSet &#64; 0x2aaabf525450' contains an illegal object reference: 0x2aaabf9e31a0 Catching the exception in CollectionsBySizeQuery just leads to another exception later.  java.lang.ClassCastException: org.eclipse.mat.parser.model.PrimitiveArrayImpl incompatible with org.eclipse.mat.snapshot.model.IObjectArray     at org.eclipse.mat.inspections.collections.CollectionUtil$Info.getBackingArray(CollectionUtil.java:231)     at org.eclipse.mat.inspections.collections.CollectionFillRatioQuery.getFillRatio(CollectionFillRatioQuery.java:128)     at org.eclipse.mat.inspections.collections.CollectionFillRatioQuery.execute(CollectionFillRatioQuery.java:116)     at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129)     at org.eclipse.mat.snapshot.query.SnapshotQuery.execute(SnapshotQuery.java:192)     at org.eclipse.mat.snapshot.query.SnapshotQuery.refine(SnapshotQuery.java:202)     at org.eclipse.mat.inspections.component.ComponentReportQuery.addCollectionFillRatios(ComponentReportQuery.java:532)     at org.eclipse.mat.inspections.component.ComponentReportQuery.execute(ComponentReportQuery.java:115)     at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129)     at org.eclipse.mat.snapshot.query.SnapshotQuery.execute(SnapshotQuery.java:192)     at org.eclipse.mat.inspections.component.TopComponentsReportQuery.execute(TopComponentsReportQuery.java:66)     at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129)     at org.eclipse.mat.query.registry.CommandLine.execute(CommandLine.java:93)     at org.eclipse.mat.report.internal.QueryPart.execute(QueryPart.java:96)     at org.eclipse.mat.report.TestSuite.execute(TestSuite.java:131)     at org.eclipse.mat.report.internal.RunRegisterdReport.execute(RunRegisterdReport.java:50)     at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129)     at org.eclipse.mat.ui.QueryExecution$ExecutionJob.run(QueryExecution.java:174)     at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54) Here is another exception to be handled.  org.eclipse.mat.SnapshotException: Field table of java.util.HashMap &#64; 0x2aaaafee0370 contains int[20] &#64; 0x2aaaafee0988 instead of an array of objects as a backing array at org.eclipse.mat.SnapshotException.&lt;init&gt;(SnapshotException.java:46) at org.eclipse.mat.inspections.collections.CollectionUtil$Info.getBackingArray(CollectionUtil.java:232) at org.eclipse.mat.inspections.collections.MapCollisionRatioQuery.getCollisionRatio(MapCollisionRatioQuery.java:120) at org.eclipse.mat.inspections.collections.MapCollisionRatioQuery.execute(MapCollisionRatioQuery.java:105) at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129) at org.eclipse.mat.snapshot.query.SnapshotQuery.execute(SnapshotQuery.java:192) at org.eclipse.mat.snapshot.query.SnapshotQuery.refine(SnapshotQuery.java:202) at org.eclipse.mat.inspections.component.ComponentReportQuery.addHashMapsCollisionRatios(ComponentReportQuery.java:626) at org.eclipse.mat.inspections.component.ComponentReportQuery.execute(ComponentReportQuery.java:148) at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129) at org.eclipse.mat.snapshot.query.SnapshotQuery.execute(SnapshotQuery.java:192) at org.eclipse.mat.inspections.component.TopComponentsReportQuery.execute(TopComponentsReportQuery.java:66) at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129) at org.eclipse.mat.query.registry.CommandLine.execute(CommandLine.java:93) at org.eclipse.mat.report.internal.QueryPart.execute(QueryPart.java:96) at org.eclipse.mat.report.TestSuite.execute(TestSuite.java:131) at org.eclipse.mat.report.internal.RunRegisterdReport.execute(RunRegisterdReport.java:50) at org.eclipse.mat.query.registry.ArgumentSet.execute(ArgumentSet.java:129) at org.eclipse.mat.ui.QueryExecution$ExecutionJob.run(QueryExecution.java:174) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)	
320716	minor	FIXED	Dummy Inbox	andrew_johnson	1279847820000	1279848240000		Excessive messages with DTFJ dump	A DTFJ dump can produce loads of error messages, particularly with PHD and javacore as none of the stack frames can be scanned. We should suppress these multiple messages, and produce more descriptive stack frame messages if possible. The Java stack frame messages are now counted and suppressed after 20 errors At most 20 error messages such as  Problem reading Java stack frame number 2 at 0x0 estimated size 256 method  org/eclipse/core/internal/jobs/WorkerPool.sleep() for thread 0x32932e00 so conservative garbage collection roots may be missing  are now generated.	
320990	normal	FIXED	Dummy Inbox	krum.tsvetkov	1280183520000	1280192340000		Revert dependencies to 3.5 in 1.0.x branch	We tried building the RCPs for the 1.0.1 service release with 3.6 and at the same time change the build technology. The 1.0 RCPs on the download site are build agains 3.5.  All changes at once are too risky for a service release I think, and we have already seen some problems. Therefore in the dedicated maintenance branch 1.0.x I would like to revert the dependencies back to the 3.5 ones and use the &quot;old&quot; build we used to provide the download artifacts for the 1.0 release. With change 867 I was able to get our internal build produce again the working RCPs based on 3.5.	
321008	normal	FIXED	Dummy Inbox	krum.tsvetkov	1280192580000	1282156140000		Change bundle version numbers for the 1.0.1 release	For the upcoming service release we need to change the version numbers to:  - 1.0.1 in /branches/1.0.x - 1.0.100 in /trunk  Thus the versions in trunk will still be considered newer during the development process. See <a href="http://wiki.eclipse.org/Version_Numbering">http://wiki.eclipse.org/Version_Numbering</a> for version numbering recommendations. I changed in trunk 1.0.0 to 1.0.100. In branches/1.0.x the change was done earlier.  This task is done now.	
321013	minor	FIXED	Dummy Inbox	andrew_johnson	1280195280000	1280208300000		Acquire heap dump with JAVA dump type doesn't open a dump	If compress is selected the result is: java.lang.NullPointerException at org.eclipse.mat.ui.internal.acquire.AcquireSnapshotAction$1.performFinish(AcquireSnapshotAction.java:100) at org.eclipse.jface.wizard.WizardDialog.finishPressed(WizardDialog.java:752) at org.eclipse.jface.wizard.WizardDialog.buttonPressed(WizardDialog.java:373) at org.eclipse.jface.dialogs.Dialog$2.widgetSelected(Dialog.java:624) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:228) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1003) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3880) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3473) at org.eclipse.jface.window.Window.runEventLoop(Window.java:825) at org.eclipse.jface.window.Window.open(Window.java:801) at org.eclipse.mat.ui.internal.acquire.AcquireSnapshotAction.run(AcquireSnapshotAction.java:170) at org.eclipse.mat.ui.internal.acquire.AcquireSnapshotAction.run(AcquireSnapshotAction.java:186) at org.eclipse.ui.internal.PluginAction.runWithEvent(PluginAction.java:251) at org.eclipse.ui.internal.WWinPluginAction.runWithEvent(WWinPluginAction.java:229) at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:584) at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:501) at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:411) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1003) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3880) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3473) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2405) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2369) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2221) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:500) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:493) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.mat.ui.rcp.Application.start(Application.java:26) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:368) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) at java.lang.reflect.Method.invoke(Method.java:600) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514) at org.eclipse.equinox.launcher.Main.run(Main.java:1311)  If compress is not selected then the dump is just opened as a text file, or an error such as: org.eclipse.core.runtime.CoreException: Text editor does not have a document provider     at org.eclipse.ui.texteditor.AbstractTextEditor.doSetInput(AbstractTextEditor.java:4047)     at org.eclipse.ui.texteditor.StatusTextEditor.doSetInput(StatusTextEditor.java:217)     at org.eclipse.ui.texteditor.AbstractDecoratedTextEditor.doSetInput(AbstractDecoratedTextEditor.java:1444)     at org.eclipse.ui.editors.text.TextEditor.doSetInput(TextEditor.java:169)     at org.eclipse.ui.texteditor.AbstractTextEditor$19.run(AbstractTextEditor.java:3037)     at org.eclipse.jface.operation.ModalContext.runInCurrentThread(ModalContext.java:464)     at org.eclipse.jface.operation.ModalContext.run(ModalContext.java:372)     at org.eclipse.jface.window.ApplicationWindow$1.run(ApplicationWindow.java:759)     at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)     at org.eclipse.jface.window.ApplicationWindow.run(ApplicationWindow.java:756)     at org.eclipse.ui.internal.WorkbenchWindow.run(WorkbenchWindow.java:2600)     at org.eclipse.ui.texteditor.AbstractTextEditor.internalInit(AbstractTextEditor.java:3055)     at org.eclipse.ui.texteditor.AbstractTextEditor.init(AbstractTextEditor.java:3082)     at org.eclipse.ui.internal.EditorManager.createSite(EditorManager.java:798)     at org.eclipse.ui.internal.EditorReference.createPartHelper(EditorReference.java:647)     at org.eclipse.ui.internal.EditorReference.createPart(EditorReference.java:465)     at org.eclipse.ui.internal.WorkbenchPartReference.getPart(WorkbenchPartReference.java:595)     at org.eclipse.ui.internal.PartPane.setVisible(PartPane.java:313)     at org.eclipse.ui.internal.presentations.PresentablePart.setVisible(PresentablePart.java:180)     at org.eclipse.ui.internal.presentations.util.PresentablePartFolder.select(PresentablePartFolder.java:270)     at org.eclipse.ui.internal.presentations.util.LeftToRightTabOrder.select(LeftToRightTabOrder.java:65)     at org.eclipse.ui.internal.presentations.util.TabbedStackPresentation.selectPart(TabbedStackPresentation.java:473)     at org.eclipse.ui.internal.PartStack.refreshPresentationSelection(PartStack.java:1254)     at org.eclipse.ui.internal.PartStack.setSelection(PartStack.java:1207)     at org.eclipse.ui.internal.PartStack.showPart(PartStack.java:1606)     at org.eclipse.ui.internal.PartStack.add(PartStack.java:497)     at org.eclipse.ui.internal.EditorStack.add(EditorStack.java:103)     at org.eclipse.ui.internal.PartStack.add(PartStack.java:483)     at org.eclipse.ui.internal.EditorStack.add(EditorStack.java:112)     at org.eclipse.ui.internal.EditorSashContainer.addEditor(EditorSashContainer.java:63)     at org.eclipse.ui.internal.EditorAreaHelper.addToLayout(EditorAreaHelper.java:225)     at org.eclipse.ui.internal.EditorAreaHelper.addEditor(EditorAreaHelper.java:213)     at org.eclipse.ui.internal.EditorManager.createEditorTab(EditorManager.java:778)     at org.eclipse.ui.internal.EditorManager.openEditorFromDescriptor(EditorManager.java:677)     at org.eclipse.ui.internal.EditorManager.openEditor(EditorManager.java:638)     at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditorBatched(WorkbenchPage.java:2860)     at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor(WorkbenchPage.java:2768)     at org.eclipse.ui.internal.WorkbenchPage.access$11(WorkbenchPage.java:2760)     at org.eclipse.ui.internal.WorkbenchPage$10.run(WorkbenchPage.java:2711)     at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)     at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2707)     at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2691)     at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2682)     at org.eclipse.ui.ide.IDE.openEditor(IDE.java:582)     at org.eclipse.mat.ui.internal.acquire.AcquireSnapshotAction$1.performFinish(AcquireSnapshotAction.java:125)     at org.eclipse.jface.wizard.WizardDialog.finishPressed(WizardDialog.java:811)     at org.eclipse.jface.wizard.WizardDialog.buttonPressed(WizardDialog.java:430)     at org.eclipse.jface.dialogs.Dialog$2.widgetSelected(Dialog.java:624)     at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:234)     at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)     at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)     at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4066)     at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3657)     at org.eclipse.jface.window.Window.runEventLoop(Window.java:825)     at org.eclipse.jface.window.Window.open(Window.java:801)     at org.eclipse.mat.ui.internal.acquire.AcquireSnapshotAction.run(AcquireSnapshotAction.java:195)     at org.eclipse.mat.ui.internal.acquire.AcquireSnapshotAction.run(AcquireSnapshotAction.java:211)     at org.eclipse.ui.internal.PluginAction.runWithEvent(PluginAction.java:251)     at org.eclipse.ui.internal.WWinPluginAction.runWithEvent(WWinPluginAction.java:229)     at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:584)     at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:501)     at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:411)     at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)     at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)     at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4066)     at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3657)     at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629)     at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593)     at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427)     at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670)     at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)     at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663)     at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)     at org.eclipse.mat.ui.rcp.Application.start(Application.java:26)     at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)     at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)     at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)     at java.lang.reflect.Method.invoke(Method.java:600)     at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)     at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)     at org.eclipse.equinox.launcher.Main.run(Main.java:1407)     at org.eclipse.equinox.launcher.Main.main(Main.java:1383)  occurs Two problems - the file association doesn't work for javacore, so we need to use the content type to find the right editor.  Also for Javacore we should never compress the dump as the Javacore reader cannot read a gzipped file, and the PHD reader cannot understand it. Are these problems we should look into for our upcoming service release (1.0.1), or shall we leave them for the next one? Acquiring a javacore dump doesn't work automatically at all, so any user trying the JAVA option with IBM dumps will see this. I'll get the fix from head. Fixed in trunk and 1.0.x	
321325	normal	FIXED	Dummy Inbox	krum.tsvetkov	1280447340000	1281291300000		Remove "beta" from the name of the Bundle Registry Query	The Bundle Registry Query is available for quite some time now. So far we haven't got any complaints about it, and I think it doesn't deserve the &quot;beta&quot; in the name. I'll remove this. The affected file is /org.eclipse.mat.api/src/org/eclipse/mat/inspections/osgi/annotations.properties I changed a week ago in branches/1.0.x and trunk	
321435	minor	FIXED	Dummy Inbox	andrew_johnson	1280560980000	1280566620000		Table header fonts too big for queries	In the query wizard, some queries especially ones with an icon or file dialog button e.g. Customized Retained Set or Collection have column headers in a too large a font.  This was introduced by <span class="bz_closed"><a href="show_bug.cgi?id=270777" title="RESOLVED FIXED - The dialog font not apply to the ArgumentWizard">bug 270777</a></span> by enlarging the table font to make the table rows big enough for the icons/buttons. The fix is to use a listener on the table with SWT.MeasureItem instead of changing the font size. Fix applied to ArgumentTable (in both branch and trunk). Fixed as described - with a listener which uses the row height requested by the rows.	
321463	minor	FIXED	Dummy Inbox	andrew_johnson	1280637180000	1280701500000		Bad mat://object/ link goes to blank page	If there is a bad mat://object/ link in a report then a warning message  Unable to map address 0x985b8 to an object on the heap.  appears, but then it changes to a page saying:  The page cannot be displayed  The page you are looking for might have been removed or had its name changed.   --------------------------------------------------------------------------------  and the back button is needed to get back to the report.  Bad links shouldn't occur, but are possible with user written queries or by opening an report from an unrelated dump. The problem is that the error messages doesn't stop the jump to the new page. Clearing event.doit in QueryTextResultPane should fix it. I've changed QueryTextResultPane to set event.doit to false after the error.	
322121	minor	FIXED	Dummy Inbox	dominik.stadler	1281309360000	1281318060000		Default size of column in acquire dialog is too small	Build Identifier: 1.0.0  The column for PID is a bit too small, it only shows 4 digit PIDs fully, 5 digit ones are cut off.   This is annoying as I need to manually enlarge the column width every time I open the dialog as the adjusted size is also not saved between invocations of the dialog.  Reproducible: Always Thanks for the feedback! This one is easy to fix. I just gave it a try and doubled the width. Once I enlarged the field I figured out that it is left aligned, which doesn't look well for an integer field, so I change also the alignment.   Will submit the changes today. As this is a rather small change, I'll add it also to our 1.0.1 service release we're just building. I submitted my changes:  888 to fix it in /trunk 889 to fix this in /branches/1.0.x  The 1.0.1 service release should be published soon (next weeks).	
322206	minor	FIXED	Dummy Inbox	andrew_johnson	1281386760000	1281569100000		IllegalStateException from disposing of system color	Running the RAP version of MAT I got the following error:   This is because a system color SWT.COLOR_DARK_GRAY is obtained, but then disposed.  Presumably the fix is simple - don't dispose it.  java.lang.IllegalStateException: A factory-created resource cannot be disposed.     at org.eclipse.swt.graphics.Resource.dispose(Resource.java:81)     at org.eclipse.mat.ui.internal.views.NavigatorViewPage.dispose(NavigatorViewPage.java:548)     at org.eclipse.mat.ui.internal.views.NavigatorView.doDestroyPage(NavigatorView.java:53)     at org.eclipse.ui.part.PageBookView.removePage(PageBookView.java:844)     at org.eclipse.ui.part.PageBookView.partClosed(PageBookView.java:774)     at org.eclipse.ui.internal.PartListenerList$3.run(PartListenerList.java:102)     at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)     at org.eclipse.core.runtime.Platform.run(Platform.java:888)     at org.eclipse.ui.internal.PartListenerList.fireEvent(PartListenerList.java:57)     at org.eclipse.ui.internal.PartListenerList.firePartClosed(PartListenerList.java:100)     at org.eclipse.ui.internal.PartService.firePartClosed(PartService.java:188)     at org.eclipse.ui.internal.WorkbenchPagePartList.firePartClosed(WorkbenchPagePartList.java:38)     at org.eclipse.ui.internal.PartList.partClosed(PartList.java:255)     at org.eclipse.ui.internal.PartList.removePart(PartList.java:176)     at org.eclipse.ui.internal.WorkbenchPage.disposePart(WorkbenchPage.java:1585)     at org.eclipse.ui.internal.WorkbenchPage.handleDeferredEvents(WorkbenchPage.java:1344)     at org.eclipse.ui.internal.WorkbenchPage.deferUpdates(WorkbenchPage.java:1328)     at org.eclipse.ui.internal.WorkbenchPage.closeEditors(WorkbenchPage.java:1302)     at org.eclipse.ui.internal.WorkbenchPage.closeEditor(WorkbenchPage.java:1357)     at org.eclipse.ui.internal.EditorPane.doHide(EditorPane.java:61)     at org.eclipse.ui.internal.PartStack.close(PartStack.java:552)     at org.eclipse.ui.internal.EditorStack.close(EditorStack.java:212)     at org.eclipse.ui.internal.PartStack$1.close(PartStack.java:121)     at rg.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEventTabbedStackPresentation.java:82)     at org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:271)     at org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:280)     at org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.access$1(DefaultTabFolder.java:1)     at org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$1.closeButtonPressedDefaultTabFolder.java:73)     at org.eclipse.ui.internal.presentations.PaneFolder.notifyCloseListeners(PaneFolder.java:642)     at org.eclipse.ui.internal.presentations.PaneFolder$3.close(PaneFolder.java:209)     at org.eclipse.swt.custom.CTabFolderEvent.dispatchToObserver(CTabFolderEvent.java:97)     at org.eclipse.rwt.internal.events.Event.processEvent(Event.java:44)     at org.eclipse.swt.events.TypedEvent.processEvent(TypedEvent.java:161)     at org.eclipse.swt.internal.custom.ctabitemkit.CTabItemLCA$1.run(CTabItemLCA.java:71)     at org.eclipse.rwt.lifecycle.ProcessActionRunner.executeNext(ProcessActionRunner.java:57)     at org.eclipse.swt.widgets.Display.runPendingMessages(Display.java:1098)     at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1090)     at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2390)     at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2351)     at org.eclipse.ui.internal.Workbench.access$5(Workbench.java:2206)     at org.eclipse.ui.internal.Workbench$4.run(Workbench.java:424)     at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)     at org.eclipse.jface.internal.databinding.realmadapter.RealmAdapter.run(RealmAdapter.java:44)     at org.eclipse.rap.ui.internal.RealmAdapterHook.runWithDefault(RealmAdapterHook.java:48)     at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:427)     at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:157)     at org.eclipse.mat.ui.rcp.Application.start(Application.java:26)     at org.eclipse.rap.ui.internal.application.EntrypointApplicationWrapper.createUI(EntrypointApplicationWrapper.java:27)     at org.eclipse.rwt.internal.lifecycle.EntryPointManager.createUI(EntryPointManager.java:92)     at org.eclipse.rwt.internal.lifecycle.RWTLifeCycle.createUI(RWTLifeCycle.java:245)     at org.eclipse.rwt.internal.lifecycle.RWTLifeCycle$UIThreadController.run(RWTLifeCycle.java:114)     at java.lang.Thread.run(Thread.java:736)     at org.eclipse.rwt.internal.lifecycle.UIThread.run(UIThread.java:102) Fix applied Fix stops the problem when the navigation pane is closed under RAP.	
322810	minor	FIXED	Dummy Inbox	andrew_johnson	1281930900000	1281931140000		OQL statement with AS column name with spaces	If an OQL statement is typed in with a AS clauses with spaces (using double-quotes) then the statement cannot be reexecuted.  SELECT s.&#64;objectId AS &quot;a b&quot; FROM java.lang.Object s  is printed out as this  SELECT s.&#64;objectId AS a b FROM java.lang.Object s  which fails to execute  Executed Query: SELECT s.&#64;objectId AS a b FROM java.lang.Object s   Problem reported: Encountered &quot;b&quot; at line 1, column 25. Was expecting one of:      &quot;FROM&quot; The fix is simple - it just needs quotes if the column name has spaces (or is of zero length).  I've also written some tests.	
327406	minor	FIXED	Dummy Inbox	andrew_johnson	1286675100000	1294680060000		Can't select individual table and tree entries with keyboard	On Windows the usual way of selecting entries with the keyboard is with control-up arrow and down arrow then space.  For the tree and table viewers this doesn't work as the search-on-typing box comes up on typing space.  Also, ordinary tables and trees use a typed letter to jump to and entry with that letter. This isn't so important though. The simplest fix is to SearchOnTyping to ignore a space character when deciding to bring up the search box. Space is now used for selection, not to bring up search on typing.	
331686	normal	FIXED	Dummy Inbox	scott.marlow	1291258560000	1291605660000		ParseHeapDump.sh seems to need IBM classes (com.ibm.dtfj.image.CorruptDataException) not present in MAT	Build Identifier: 1.0.1  I tried to run ParseHeapDump.sh against a heapdump and get a java.lang.NoClassDefFoundError on com.ibm.dtfj.image.CorruptDataException  Full console output is here:  <a href="http://pastebin.com/aMYntUga">http://pastebin.com/aMYntUga</a>  Version info from MAT about box: Version: 1.0.1.201008091353 Build id: 1.0.1  Reproducible: Always  Steps to Reproduce: 1. run with openjdk or sunjdk on Linux x64 2. ./ParseHeapDump.sh somePath/someDump.hprof  3. Boom This message also appears with the Windows version when running ParseHeapDump without DTFJ installed.  I think it's harmless.  The problem is that the org.eclipse.mat.dtfj doesn't require the IBM DTFJ plugins as the idea is that it can use them later once they are installed. However,  when this plugin is stopped it calls some code which presumes the availability of the IBM DTFJ com.ibm.java.dtfj I have modified InitDTFJ so that does not call com.ibm.dtfj.image.CorruptDataException unless there is an com.ibm.dtfj.api.ImageFactory extension point.	
332141	normal	FIXED	Dummy Inbox	remysuen	1291776060000	1291946520000		NotesView adds dispose listener to one widget then removes it from another	In createPartControl(Composite), a DisposeListener is added to the provided parent composite.  In dispose(), the listener is then removed from the part site's shell.  The two controls are _not_ the same. There is no point in removing the listener from the shell because the shell didn't even have the listener in the first place. Also, the listeners are effectively destroyed/unreferenced when the widget is disposed so there really is no need for your code to even bother removing the listener. Thanks for the report. We could save the parent in the constructor, then check for !isDisposed() before doing the remove. It does appear that the parent composite has already been disposed, so it is too late to remove the dispose listener, so there isn't any point in doing the remove. I'll just remove it with a comment. I've removed the removeDisposeListener call. How did you spot the error? Have you seen other problems? (In reply to <a href="show_bug.cgi?id=332141#c2">comment #2</a>) <span class="quote">&gt; I've removed the removeDisposeListener call.</span >  Thank you for your speedy response, Andrew.  <span class="quote">&gt; How did you spot the error?</span >  I spotted the error while I was testing MAT on the Eclipse 4.1 SDK builds (see <a href="show_bug.cgi?id=332139" title="NEW - [Compatibility] Memory Analyzer needs to run on 4.x">bug 332139</a>). We don't have everything implemented yet so your getSite().getShell() call was actually causing an NPE (see <span class="bz_closed"><a href="show_bug.cgi?id=332140" title="VERIFIED FIXED - [Compatibility] Part site returns null for getShell() if called during part disposal">bug 332140</a></span>, that's a bug on our side that I will be fixing). I then looked at your code and noticed the strange pattern so I thought I'd raise it to your attention.  <span class="quote">&gt; Have you seen other problems?</span >  Not yet...but I don't really know how to use MAT so I'm pretty sure I'm not really exercising it fully on 4.1 I don't think. :P	
333169	normal	FIXED	Dummy Inbox	andrew_johnson	1293087180000	1293142080000		Junit tests leave temporary files around	After running the Junit tests a lot of junitNNNNNNNNN directories are left in the temporary files folder. This requires cleaning up regularly to avoid other problems when running out of disk space. Some of the problem could be snapshots not being closed. The pristine snapshots are not retrieved from the cache, but are stored back in the cache so could be given to another test, which might be wrong as pristine snapshots could be build with unusual options. These should be stored separately (or else the tests should clean them up).  Should Snapshots have a finalizer?  If a copying a dump fails due to lack of disk space then we need to close the file and delete it. The test case code is now fixed - I think the remaining files are kept because of DTFJ not cleaning up properly - see <a href="show_bug.cgi?id=333004" title="ASSIGNED - Clear up DTFJ image using close()">bug 333004</a>	
334505	minor	FIXED	Andrew Johnson	andrew_johnson	1295211540000	1296974160000		Widget is disposed when closing MAT with compare basket open	The problem occurs when closing MAT after adding a table to the compare basket. It occurs with the current Tycho/Maven builds  (e.g. 12 January 2011).  org.eclipse.swt.SWTException: Widget is disposed at org.eclipse.swt.SWT.error(SWT.java:4083) at org.eclipse.swt.SWT.error(SWT.java:3998) at org.eclipse.swt.SWT.error(SWT.java:3969) at org.eclipse.swt.widgets.Widget.error(Widget.java:468) at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:340) at org.eclipse.swt.widgets.Table.deselectAll(Table.java:1966) at org.eclipse.jface.viewers.TableViewer.doDeselectAll(TableViewer.java:277) at org.eclipse.jface.viewers.AbstractTableViewer.setSelectionToWidget(AbstractTableViewer.java:908) at org.eclipse.jface.viewers.StructuredViewer.setSelectionToWidget(StructuredViewer.java:1741) at org.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1429) at org.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1383) at org.eclipse.jface.viewers.StructuredViewer.refresh(StructuredViewer.java:1485) at org.eclipse.jface.viewers.ColumnViewer.refresh(ColumnViewer.java:537) at org.eclipse.jface.viewers.StructuredViewer.refresh(StructuredViewer.java:1444) at org.eclipse.mat.ui.compare.CompareBasketView$1.partClosed(CompareBasketView.java:193) at org.eclipse.ui.internal.PartListenerList2$3.run(PartListenerList2.java:100) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.core.runtime.Platform.run(Platform.java:888) at org.eclipse.ui.internal.PartListenerList2.fireEvent(PartListenerList2.java:55) at org.eclipse.ui.internal.PartListenerList2.firePartClosed(PartListenerList2.java:98) at org.eclipse.ui.internal.PartService.firePartClosed(PartService.java:227) at org.eclipse.ui.internal.WorkbenchPagePartList.firePartClosed(WorkbenchPagePartList.java:39) at org.eclipse.ui.internal.PartList.partClosed(PartList.java:274) at org.eclipse.ui.internal.PartList.removePart(PartList.java:186) at org.eclipse.ui.internal.WorkbenchPage.disposePart(WorkbenchPage.java:1720) at org.eclipse.ui.internal.WorkbenchPage.partRemoved(WorkbenchPage.java:1713) at org.eclipse.ui.internal.ViewFactory.releaseView(ViewFactory.java:257) at org.eclipse.ui.internal.Perspective.dispose(Perspective.java:292) at org.eclipse.ui.internal.WorkbenchPage.dispose(WorkbenchPage.java:1792) at org.eclipse.ui.internal.WorkbenchWindow.closeAllPages(WorkbenchWindow.java:861) at org.eclipse.ui.internal.WorkbenchWindow.hardClose(WorkbenchWindow.java:1696) at org.eclipse.ui.internal.WorkbenchWindow.busyClose(WorkbenchWindow.java:734) at org.eclipse.ui.internal.WorkbenchWindow.access$0(WorkbenchWindow.java:710) at org.eclipse.ui.internal.WorkbenchWindow$5.run(WorkbenchWindow.java:826) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.WorkbenchWindow.close(WorkbenchWindow.java:824) at org.eclipse.jface.window.WindowManager.close(WindowManager.java:109) at org.eclipse.ui.internal.Workbench$18.run(Workbench.java:1105) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.Workbench.busyClose(Workbench.java:1102) at org.eclipse.ui.internal.Workbench.access$15(Workbench.java:1031) at org.eclipse.ui.internal.Workbench$25.run(Workbench.java:1275) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.Workbench.close(Workbench.java:1273) at org.eclipse.ui.internal.Workbench.close(Workbench.java:1245) at org.eclipse.ui.internal.WorkbenchWindow.busyClose(WorkbenchWindow.java:731) at org.eclipse.ui.internal.WorkbenchWindow.access$0(WorkbenchWindow.java:710) at org.eclipse.ui.internal.WorkbenchWindow$5.run(WorkbenchWindow.java:826) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.WorkbenchWindow.close(WorkbenchWindow.java:824) at org.eclipse.jface.window.Window.handleShellCloseEvent(Window.java:741) at org.eclipse.jface.window.Window$3.shellClosed(Window.java:687) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:98) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062) at org.eclipse.swt.widgets.Decorations.closeWidget(Decorations.java:308) at org.eclipse.swt.widgets.Decorations.WM_CLOSE(Decorations.java:1665) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4162) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:341) at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1598) at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2038) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4873) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2454) at org.eclipse.swt.widgets.Shell.callWindowProc(Shell.java:497) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4251) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:341) at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1598) at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2038) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4873) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2454) at org.eclipse.swt.widgets.Shell.callWindowProc(Shell.java:497) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4251) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:341) at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1598) at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2038) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4873) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2459) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3655) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427) at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.mat.ui.rcp.Application.start(Application.java:51) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574) at org.eclipse.equinox.launcher.Main.run(Main.java:1407) at org.eclipse.equinox.launcher.Main.main(Main.java:1383) This error also occurs on closing the dump with the compare basket open. We can fix this by adding a simple !table.isDisposed() test. We can't do anything to the table when cleaning up at the point, so it seems safe enough. Simple fix applied to CompareBasketView.	
335047	minor	FIXED	Andrew Johnson	andrew_johnson	1295590260000	1296884820000		QueryBrowser misses the copy queries	The query browser doesn't list the copy queries.  These queries have IContextObject arguments.  The problem is to do with whether the query accept the given context (which has most of the arguments) and the whether the policy is suitable. The policy holds the selection and so the IContextObjects etc. and the selected heap objects.  I don't think queries that need a IContextObjectSet are properly filtered either  For a pop-up menu or search on selected row(s): only queries needing heap objects or context objects (rows) should be shown (i.e. the query should be affected by the selection of items) if the query requires IContextObjectSet then all the rows should be of that type  For a menu from the tool bar queries that require a context object should not appear queries that require heap objects can (the wizard can fill those in)  The solution is to use the policy everywhere, and have a default policy which doesn't provide any IContextObjects. The UISnapshotQueryContext needs to say it has an IContextObjectSet then the policy will determine if there is one. I've made the changes, and also added some test queries to check that the right queries appear when a IContextObject  IContextObject[]  IContextObjectSet  IContextObjectSet[]  are available. I've updated the command line for the query browser so that the IObjectContext is filled in for the context browser, but not for the pop up browser. The copy queries now appear in the context menus and the context query browser but not in the pop up menus.	
337462	minor	FIXED	Andrew Johnson	andrew_johnson	1297913400000	1297916940000		CompositeResult doesn't display a Spec or another CompositeResult	If a query returns a CompositeResult containing a Spec then the tab is blank apart from some text like  org.eclipse.mat.report.SectionSpec&#64;5ebb5ebb  If a query returns a CompositeResult containing another CompositeResult marked as asHtml then the sub result is still expanded rather than being shown as HTML. The fix is to change QueryExecution to expand those cases to HTML, rather as if they were the main result from a query. I have also added a test query. This isn't run a JUnit test as I don't know how.	
